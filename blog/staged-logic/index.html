<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">

		<meta property="og:title" content="Darius Foo">
		<meta property="og:type" content="article">
		<meta property="og:url" content="https://dariusf.github.io">
		<meta property="og:image" content="https://dariusf.github.io/avatar.png">

		<title>Verifying effectful higher-order programs with staged logic</title>
		<meta name="description" content="PhD student, programming languages and formal verification">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Darius Foo">


		

		

		

		

		
		
		<style>@media (prefers-color-scheme: light) { /**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
 }
@media (prefers-color-scheme: dark) { /**
 * prism.js tomorrow night eighties for JavaScript, CoffeeScript, CSS and HTML
 * Based on https://github.com/chriskempson/tomorrow-theme
 * @author Rose Pritchard
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #ccc;
	background: none;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;

}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #2d2d2d;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.block-comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #999;
}

.token.punctuation {
	color: #ccc;
}

.token.tag,
.token.attr-name,
.token.namespace,
.token.deleted {
	color: #e2777a;
}

.token.function-name {
	color: #6196cc;
}

.token.boolean,
.token.number,
.token.function {
	color: #f08d49;
}

.token.property,
.token.class-name,
.token.constant,
.token.symbol {
	color: #f8c555;
}

.token.selector,
.token.important,
.token.atrule,
.token.keyword,
.token.builtin {
	color: #cc99cd;
}

.token.string,
.token.char,
.token.attr-value,
.token.regex,
.token.variable {
	color: #7ec699;
}

.token.operator,
.token.entity,
.token.url {
	color: #67cdcc;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}

.token.inserted {
	color: green;
}
 }
/* This is an arbitrary CSS string added to the bundle */
:root {
	/* --font-family: -apple-system, system-ui, sans-serif; */
	/* --font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
	*/

    --font-family-monospace: Fira Code, Menlo, Consolas, Monaco, Liberation Mono, Lucida Console, monospace;


  /*    --text-font: Crimson Text, serif;*/
  /*    --text-font: Poppins, Verdana, sans-serif;*/
  /*    --heading-font: Quicksand, sans-serif;*/
  /*    --text-font: Open Sans, sans-serif;*/
  /*    --text-font-size: 16px;*/
  /*    --heading-font: Open Sans, sans-serif;*/
  /*    --text-font: Cabin, sans-serif;*/
  /*    --text-font-size: 16px;*/
  /*    --text-font: Roboto, sans-serif;*/

  /*    --heading-font: Roboto, sans-serif;*/
  /*    --heading-font: Cabin, sans-serif;*/
  /*    --heading-font: Dosis, sans-serif;*/

  /*    --heading-font: Work Sans, sans-serif;*/
  /*    --text-font: Open Sans, sans-serif;*/

      /* --heading-font: Nunito, sans-serif; */
      --heading-font: ui-rounded, 'Hiragino Maru Gothic ProN', Quicksand, Comfortaa, Manjari, 'Arial Rounded MT', 'Arial Rounded MT Bold', Calibri, source-sans-pro, sans-serif;
  /*    --text-font: PT Sans, sans-serif;*/

  /*    --heading-font: Varela Round, sans-serif;*/
  /*    --text-font: Noto Serif, serif;*/

  /*    --text-font: Lato, sans-serif;*/
      --text-font-size: 17px;

  /*    --text-font: Merriweather, sans-serif;*/
  /*    --text-font-size: 16px;*/

  /* https://css-tricks.com/snippets/css/system-font-stack/ */
  /* https://systemfontstack.com/ */

    /* system font on all platforms */
  /*    --heading-font: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu;*/
      /* --text-font: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu; */
      --text-font: -apple-system, system-ui, sans-serif;
			/* system-ui, sans-serif; */


/* Theme colors */

	/* --color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333; */

	--background-color: #fff;

	/* --text-color: var(--color-gray-90); */
	/* --text-color-link: #082840; */

	/* --text-color-link: #ff0000; */
	/* --text-color-link-active: #5f2b48; */
	/* --text-color-link-visited: #17050F; */


	/* --syntax-tab-size: 2; */

	--bright-text-color: #222;
	--link-color: #3273dc;
	/* --link-color: #ff5e6c; */
	--link-visited-color: #6e4bbe;
	--background-color: #fff;
	--text-color: #444;
	--faded-text-color: #777;
	--blockquote-text-color: var(--bright-text-color);
	--faint-color: #ccc;
}

@media (prefers-color-scheme: dark) {
	:root {
		/* --color-gray-20: #e0e0e0; */
		/* --color-gray-50: #C0C0C0; */
		/* --color-gray-90: #dad8d8; */

		/* --text-color is assigned to --color-gray-_ above */
		/* --text-color-link: #1493fb; */
		/* --text-color-link-active: #6969f7; */
		/* --text-color-link-visited: #a6a6f8; */

		--background-color: #15202b;

		--bright-text-color: #eee;
		--link-color: #8cc2dd;
		--link-visited-color: #b9a9e0;
		--background-color: #333;
		--text-color: #ddd;
		--faded-text-color: #aaa;
		--slightly-dimmer-text-color: #ccc;
		--blockquote-text-color: var(--slightly-dimmer-text-color);
		--faint-color: #666;

		color-scheme: dark; /* sets scrollbar colour */
	}

	.theme-affected {
		filter: invert(.8);
	}
}

body {
	box-sizing: border-box;

	/* https://github.com/sindresorhus/github-markdown-css */
	min-width: 200px;
	/* max from old blog */
	/* max-width: 40em; */
	/* tiny bit wider because prism adds some padding */
	max-width: 726px;

	margin: 0 auto;
	padding: 0 20px;

	/* enable ligatures */
	text-rendering: optimizeLegibility;

	font-family: var(--text-font);
	font-size: var(--text-font-size);
	color: var(--text-color);
	background-color: var(--background-color);

	/*
	text-align: left;
	word-wrap: break-word;
	overflow-wrap: break-word;
	*/
	/* line-height: 1.5; */
}

@media (max-width: 767px) {
	body {
		padding: 0px 1em;
	}
}

@view-transition {
	navigation: auto;
}

html {
	overflow-y: scroll;
}

/* https://github.com/Kimeiga/bahunya/blob/master/src/parts/_typography.css */
ul, ol {
  padding-left: 2em;
}

li {
	line-height: 1.5;
}

h1, h2, h3, h4, h5, h6 {
	font-family: var(--heading-font);
	color: var(--bright-text-color);
	font-weight: normal;
	line-height: 1.25;
}

footer {
	padding: 35px;
}

/* header {
	border-bottom: 1px dashed var(--color-gray-20);
} */


/* misc changes from here on */

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

p:has(img) {
	text-align: center;
}
/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
/* img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
} */
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

a[href] {
	color: var(--link-color);
	text-decoration: none;
}

/* a[href]:visited {
	color: var(--link-visited-color);
} */

/* a[href]:hover,
a[href]:active { */
	/* color: var(--text-color-link-active); */
	/* text-decoration: underline; */
	/* text-decoration-thickness: 2px; */
/* } */

/* main :first-child {
	margin-top: 0;
} */

/* .links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
} */

table {
	margin: 1em 0;
	border-collapse: collapse;
}
table td,
table th {
	padding-right: 1em;
}
/* table thead tr th {
  border-bottom: solid var(--text-color) 2px;
  border-top: solid var(--text-color) 2px;
} */

.table-lines td {
  border-bottom: solid var(--text-color) 1px;
  border-top: solid var(--text-color) 1px;
}

/* pre,
code {
	font-family: var(--font-family-monospace) !important;
	font-size: 14px !important;
} */

/* override prism */
/* https://github.com/orgs/PrismJS/discussions/2859 */
code[class*="language-"],
pre[class*="language-"] {
	font-family: var(--font-family-monospace);
	font-size: 14px;
}

pre[class*="language-"] {
	margin-top: 0;
	margin-bottom: 1em;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	/* -moz-tab-size: var(--syntax-tab-size); */
	/* -o-tab-size: var(--syntax-tab-size); */
	/* tab-size: var(--syntax-tab-size); */
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}

.scroll-when-overflowing, pre {
	overflow-x: scroll;
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}

.scroll-when-overflowing::-webkit-scrollbar, pre::-webkit-scrollbar {
  display: none;
}

/* mathjax v4, where display math is not centered */
mjx-container {
	margin: auto;
}
header {
			/* display: flex; */
			/* gap: 2em; */
			border-right: 10px;
			/* flex-wrap: wrap; */
			/* justify-content: space-between; */
			/* align-items: center; */
			align-items: end;
			padding-top: 1em;
			/* padding: 1em; */
		}
.nav-item {
				font-family: var(--heading-font);
				padding-right: 5px;
				display: inline-block;
			}
			
			.nav-item a[href][aria-current="page"] {
				text-decoration: underline;
				text-decoration-thickness: 2px;
			}</style>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		

		<header>

			
			
			
			<a href="/" style="padding-right: 10px; color: var(--text-color); font-family: var(--heading-font); font-size: 1.5em;">Darius Foo</a>
			
				
				
				
				
				
				
			
			
			<nav style="display: inline-block">
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul style="list-style: none; padding: 0; margin: 0;">
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/research/">Research</a></li>
					<li class="nav-item"><a href="/work/">Work</a></li>
					<li class="nav-item"><a href="/games/">Games</a></li>
				</ul>
			</nav>
		</header>

		<main id="skip">
			

<h1 style="margin-top: 1rem; margin-bottom: 0.2em" id="verifying-effectful-higher-order-programs-with-staged-logic">Verifying effectful higher-order programs with staged logic</h1>



<div class="post-metadata">
	
	<time style="font-size: 0.9em;" datetime="2024-08-16">16 Aug 2024</time>
	
	
</div>

<div class="blog-content">
<!-- (23 Aug 2024) -->
<!-- (13 Sep 2024) -->
<p><em>Text version of a talk given at the <a href="https://nus-plse.github.io/seminars.html">NUS PLSE Seminar</a> and <a href="https://www.fm24.polimi.it/?page_id=612">FM 2024</a> in Milan.</em></p>
<ul>
<li><a href="#effectful-higher-order-functions">Effectful higher-order functions</a></li>
<li><a href="#specifying-higher-order-functions-today">Specifying higher-order functions today</a>
<ul>
<li><a href="#example-1-mutating-the-list">Example 1: mutating the list</a></li>
<li><a href="#example-2-stronger-precondition">Example 2: stronger precondition</a></li>
<li><a href="#example-3-effects-outside-metalogic">Example 3: effects outside metalogic</a></li>
</ul>
</li>
<li><a href="#staged-logic">Staged logic</a>
<ul>
<li><a href="#effectful-placeholders">Effectful placeholders</a></li>
<li><a href="#recursion">Recursion</a></li>
<li><a href="#re-summarization">Re-summarization</a></li>
<li><a href="#compaction-via-biabduction">Compaction via biabduction</a></li>
</ul>
</li>
<li><a href="#solutions-to-problematic-examples">Solutions to problematic examples</a>
<ul>
<li><a href="#example-1">Example 1</a></li>
<li><a href="#example-2">Example 2</a></li>
<li><a href="#example-3">Example 3</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h1 id="effectful-higher-order-functions">Effectful higher-order functions</h1>
<p>Most programming languages in use today are higher-order, and allow programmers to perform <em>effects</em> (primitive state, exceptions, or algebraic effects) in any context.</p>
<p>This enables expressive programming patterns, e.g. using state in a closure to avoid traversing a list twice:</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token comment">(* sum a list, and also count the number of elements *)</span>
<span class="token keyword">let</span> count <span class="token operator">=</span> ref <span class="token number">0</span> <span class="token keyword">in</span>
foldr <span class="token punctuation">(</span><span class="token keyword">fun</span> c t <span class="token operator">-></span> incr count<span class="token punctuation">;</span> c<span class="token operator">+</span>t<span class="token punctuation">)</span> xs <span class="token number">0</span></code></pre>
<p>or using a continuation to return multiple solutions when backtracking, and allowing the continuation to throw an exception to end the search efficiently:</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> stop <span class="token operator">=</span> raise Stop
<span class="token keyword">let</span> <span class="token keyword">rec</span> search xs k <span class="token operator">=</span>
  <span class="token keyword">try</span>
    <span class="token keyword">if</span> found <span class="token keyword">then</span> k answer<span class="token punctuation">;</span>
    <span class="token comment">(* ... keep searching *)</span>
  <span class="token keyword">with</span> Stop <span class="token operator">-></span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">in</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> search xs <span class="token punctuation">(</span><span class="token keyword">fun</span> answer <span class="token operator">-></span> <span class="token keyword">if</span> good answer <span class="token keyword">then</span> stop <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>Using a <a href="https://github.com/ocaml-multicore/picos#motivation">modern I/O library</a> also makes algebraic effects pervasive.</p>
<p>Reasoning about effectful higher-order functions does not seem particularly difficult - we certainly do it informally every time we use them in programs!
However, support for such functions in automated verifiers varies greatly:</p>
<ul>
<li><em>Most automated verifiers require function arguments to be pure</em>. Examples include Dafny, Why3, and Cameleer. This is because they lift these functions into the underlying logic (usually the first-order logic of SMT) and are restricted by what can be expressed in it.</li>
<li><em>Other automated verifiers rely on type system guarantees</em>. Examples include Prusti and Creusot, which target Rust and can exploit the fact that closures can maintain invariants over their captured state via ownership. This makes the problem simpler, with the tradeoff that this approach does not work in languages with weaker type systems.</li>
<li><em>Most verifiers which do support such functions are interactive</em>. Examples include Iris, CFML, and Steel/Pulse (F*), which are built on proof assistants. In practice, this means that they support varying levels of automation, with the tradeoff being that they are more expressive.</li>
</ul>
<p>A second issue is that even when higher-order functions are supported, they tend to be specified <em>imprecisely</em>. We'll see an example of this shortly.</p>
<p>The question we're concerned with in this work is: is there a <em>precise</em> and <em>general</em> way to support effectful higher-order functions in <em>automated</em> program verifiers?</p>
<h1 id="specifying-higher-order-functions-today">Specifying higher-order functions today</h1>
<div style="display:none">
<p><mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\m}[1]{\mathit{#1}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\foldr}{\m{foldr}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\xs}{\m{xs}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\ys}{\m{ys}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\res}{\m{res}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\inv}{\m{Inv}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\islist}{\m{isList}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\list}{\m{List}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\emp}{\m{emp}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\req}[1]{\mathbf{req}\ #1}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\ens}[1]{\mathbf{ens}\ #1}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\s}[1]{\{ #1 \}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\sb}[1]{\textbf{\{}#1\textbf{\}}}"></g></g></svg></mjx-container></p>
</div>
<p>We'll use the classic <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-113-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-113-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-113-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-113-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-113-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-113-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-113-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-113-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-113-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-113-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> function as a running example.</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr f a l <span class="token operator">=</span>
  <span class="token keyword">match</span> l <span class="token keyword">with</span>
  <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=></span> a
  <span class="token operator">|</span> h <span class="token punctuation">::</span> t <span class="token operator">=></span>
    f h <span class="token punctuation">(</span>foldr f a t<span class="token punctuation">)</span></code></pre>
<p><mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-114-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-114-STX-I-1D453"></use></g></g></g></svg></mjx-container> is <em>effectful</em> - it may have state, exceptions, or algebraic effects.
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-115-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-115-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-115-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-115-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-115-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-115-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-115-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-115-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-115-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-115-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> is hence an <em>effectful higher-order function</em>.</p>
<p>We would like to specify <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-116-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-116-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-116-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-116-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-116-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-116-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-116-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-116-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-116-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-116-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> in a way that allows a wide range of clients to be verified, including the one we saw earlier, which calls <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-117-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-117-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-117-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-117-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-117-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-117-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-117-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-117-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-117-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-117-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> with a closure.</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> count <span class="token operator">=</span> ref <span class="token number">0</span> <span class="token keyword">in</span>
foldr <span class="token punctuation">(</span><span class="token keyword">fun</span> c t <span class="token operator">-></span> incr count<span class="token punctuation">;</span> c <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token number">0</span> xs</code></pre>
<p>Here is a specification one might write today in a modern program logic<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup>.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -5.451ex;" xmlns="http://www.w3.org/2000/svg" width="65.526ex" height="11.945ex" role="img" focusable="false" viewBox="0 -3110.9 31386.9 5721.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-118-STX-N-2200" d="M571 678L498 678L423 474L150 474L75 678L2 678L253 0L320 0M400 412L286 105L173 412Z"></path><path id="MJX-118-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-118-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-118-STX-MI-49" d="M260 0L266 30C185 30 176 40 193 127L275 525C290 603 300 627 389 627L395 657L118 657L112 627C203 627 203 603 186 525L104 131C86 43 74 30-7 30L-13 0Z"></path><path id="MJX-118-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-118-STX-MI-76" d="M160-8C295 76 417 218 417 385C417 424 403 479 353 479C329 479 308 465 308 435C308 388 358 385 358 324C358 232 279 126 185 50L183 50L185 85C181 210 171 349 156 477L132 477L1 461L1 430C14 432 23 433 33 433C66 433 74 421 79 374C96 244 105 143 111-8Z"></path><path id="MJX-118-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-118-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-118-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-118-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path><path id="MJX-118-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-118-STX-S7-7B" d="M45 238C153 229 179 180 179 54C179-214 119-536 119-746C119-929 185-1035 385-1043L385-997C255-987 216-904 216-766C216-570 271-237 271-23C271 181 214 232 133 266L133 274C214 308 271 359 271 563C271 777 216 1109 216 1305C216 1443 255 1526 385 1536L385 1582C185 1574 119 1468 119 1285C119 1075 179 754 179 486C179 360 153 311 45 302Z"></path><path id="MJX-118-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-118-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-118-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-118-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path><path id="MJX-118-STX-MI-79" d="M2-220C69-220 126-139 234 15C244 29 348 175 398 268C429 325 441 365 441 401C441 457 411 482 377 482C349 482 334 464 334 442C334 403 383 383 383 346C383 330 374 303 350 264L235 79L229 79L220 179L198 325C186 405 179 437 157 475L142 475L8 464L8 435C17 436 26 437 35 437C94 437 100 393 108 343L165-9C137-51 57-163 35-163C19-163 4-109-37-109C-59-109-76-124-76-152C-76-193-38-220 2-220Z"></path><path id="MJX-118-STX-N-A0" d=""></path><path id="MJX-118-STX-N-7B" d="M25 245C72 240 115 233 115 173C115 126 96 8 96-52C96-167 184-197 282-197L282-165C225-165 170-150 170-64C170-13 185 68 185 129C185 212 144 247 93 267L93 273C144 293 185 328 185 411C185 472 170 552 170 603C170 689 225 704 282 704L282 736C184 736 96 706 96 591C96 531 115 414 115 367C115 307 72 300 25 295Z"></path><path id="MJX-118-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-118-STX-N-7D" d="M302 295C255 300 212 307 212 367C212 414 231 531 231 591C231 706 143 736 45 736L45 704C102 704 157 689 157 603C157 552 142 472 142 411C142 328 183 293 234 273L234 267C183 247 142 212 142 129C142 68 157-13 157-64C157-150 102-165 45-165L45-197C143-197 231-167 231-52C231 8 212 126 212 173C212 233 255 240 302 245Z"></path><path id="MJX-118-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-118-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-118-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-118-STX-MI-69" d="M115-9C181-9 220 47 255 96L235 111C219 93 191 59 157 59C145 59 139 65 139 78C139 92 144 120 144 120L219 476L197 476L57 465L57 438C57 438 74 440 91 440C118 440 123 424 123 411C123 394 120 380 120 380L69 142C56 83 52 61 52 44C52 9 75-9 115-9M188 556C218 556 243 576 243 610C243 643 224 665 191 665C158 665 136 644 136 610C136 575 158 556 188 556Z"></path><path id="MJX-118-STX-MI-4C" d="M481 0L541 195L509 195C447 79 426 38 299 38L252 38C193 38 178 48 187 92L278 540C293 612 325 627 397 627L402 657L118 657L112 627C198 627 203 607 189 541L103 124C86 44 70 30-7 30L-13 0Z"></path><path id="MJX-118-STX-MI-74" d="M115-9C194-9 236 65 265 104L245 119C210 74 189 59 160 59C146 59 143 69 143 80C143 97 150 130 150 130L211 428L310 428L318 467L219 467L245 593L215 593C165 506 140 482 76 449L72 428L129 428L61 101C59 91 54 61 54 44C54 13 73-9 115-9Z"></path><path id="MJX-118-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-118-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-118-STX-N-5B" d="M299-196L299-164L169-164L169 704L299 704L299 736L90 736L90-196Z"></path><path id="MJX-118-STX-N-5D" d="M259-196L259 736L50 736L50 704L180 704L180-164L50-164L50-196Z"></path><path id="MJX-118-STX-S7-7D" d="M435 302C327 311 301 360 301 486C301 754 361 1075 361 1285C361 1468 295 1574 95 1582L95 1536C225 1526 264 1443 264 1305C264 1109 209 777 209 563C209 359 266 308 347 274L347 266C266 232 209 181 209-23C209-237 264-570 264-766C264-904 225-987 95-997L95-1043C295-1035 361-929 361-746C361-536 301-214 301 54C301 180 327 229 435 238Z"></path><path id="MJX-118-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-118-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-118-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-118-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{c}
\forall \class{ppred}{P}, \class{foldrinv}{\inv}, f, \xs, l. \left\{ \begin{array}{l}
    \class{triple}{(\forall x, a', \ys.\ \s{\class{ppred}{P\ x} * \class{preserve}{\inv\ \ys\ a'}}\ f(x, a')\ \s{r.\ \class{preserve}{\inv\ (x::\ys)\ r}})} \\
    *\ \class{shape}{\islist\ l\ \xs} * \class{ppred}{\m{all}\ P\ \xs} * \class{foldrinv}{\inv\ []\ a}
 \end{array} \right\} \\
 \foldr\ f\ a\ l \\
 \{r.\ \class{shape}{\islist\ l\ \xs} * \class{foldrinv}{\inv\ \xs\ r} \}
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{foldr}\ f\ a\ l \\
 \{r.\ \class{shape}{\islist\ l\ \xs} * \class{foldrinv}{\inv\ \xs\ r} \}
\end{array}
"><g data-mml-node="mtr" data-latex-item="{c}" data-latex="{c}" transform="translate(0,1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mi" data-latex="\forall"><use data-c="2200" xlink:href="#MJX-118-STX-N-2200"></use></g><g data-mml-node="mi" data-latex="\class{ppred}{P}" class="ppred" transform="translate(573,0)"><use data-c="1D443" xlink:href="#MJX-118-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="," transform="translate(1154,0)"><use data-c="2C" xlink:href="#MJX-118-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\class{foldrinv}{\inv}" class="foldrinv" data-mjx-texclass="ORD" transform="translate(1565.7,0)"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-118-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-118-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-118-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(2901.7,0)"><use data-c="2C" xlink:href="#MJX-118-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(3313.3,0)"><use data-c="1D453" xlink:href="#MJX-118-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3890.3,0)"><use data-c="2C" xlink:href="#MJX-118-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(4302,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-118-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(5122,0)"><use data-c="2C" xlink:href="#MJX-118-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(5533.7,0)"><use data-c="1D459" xlink:href="#MJX-118-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="." transform="translate(5811.7,0)"><use data-c="2E" xlink:href="#MJX-118-STX-N-2E"></use></g><g data-mml-node="mrow" data-latex-item="\left\{ \begin{array}{l}
    \class{triple}{(\forall x, a', \ys.\ \s{\class{ppred}{P\ x} * \class{preserve}{\inv\ \ys\ a'}}\ f(x, a')\ \s{r.\ \class{preserve}{\inv\ (x::\ys)\ r}})} \\
    *\ \class{shape}{\islist\ l\ \xs} * \class{ppred}{\m{all}\ P\ \xs} * \class{foldrinv}{\inv\ []\ a}
 \end{array} \right\}" data-latex="\left\{ \begin{array}{l}
    \class{triple}{(\forall x, a', \ys.\ \s{\class{ppred}{P\ x} * \class{preserve}{\inv\ \ys\ a'}}\ f(x, a')\ \s{r.\ \class{preserve}{\inv\ (x::\ys)\ r}})} \\
    *\ \class{shape}{\islist\ l\ \xs} * \class{ppred}{\m{all}\ P\ \xs} * \class{foldrinv}{\inv\ []\ a}
 \end{array} \right\}" transform="translate(6223.3,0)"><g data-mml-node="mo" data-latex-item="\left\{" data-latex="\left\{" transform="translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-118-STX-S7-7B"></use></g><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="{array}" transform="translate(480,0)"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,689.1)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mrow" data-latex="\class{triple}{(\forall x, a', \ys.\ \s{\class{ppred}{P\ x} * \class{preserve}{\inv\ \ys\ a'}}\ f(x, a')\ \s{r.\ \class{preserve}{\inv\ (x::\ys)\ r}})}" class="triple"><g data-mml-node="mo" data-latex="(" transform="translate(0 -20)"><use data-c="28" xlink:href="#MJX-118-STX-N-28"></use></g><g data-mml-node="mi" data-latex="\forall" transform="translate(357,0)"><use data-c="2200" xlink:href="#MJX-118-STX-N-2200"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(930,0)"><use data-c="1D465" xlink:href="#MJX-118-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(1489,0)"><use data-c="2C" xlink:href="#MJX-118-STX-N-2C"></use></g><g data-mml-node="msup" transform="translate(1900.7,0)"><g data-mml-node="mi" data-latex="a"><use data-c="1D44E" xlink:href="#MJX-118-STX-I-1D44E"></use></g><g data-mml-node="mo" transform="translate(588,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-118-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(2784.7,0)"><use data-c="2C" xlink:href="#MJX-118-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(3196.4,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-118-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(446,0)"></use></g></g><g data-mml-node="mo" data-latex="." transform="translate(4009.4,0)"><use data-c="2E" xlink:href="#MJX-118-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(4421.1,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="\{" transform="translate(4656.1,0) translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-118-STX-N-7B"></use></g><g data-mml-node="mrow" data-latex="\class{ppred}{P\ x}" class="ppred" transform="translate(4983.1,0)"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-118-STX-I-1D443"></use></g><g data-mml-node="mtext" transform="translate(581,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(816,0)"><use data-c="1D465" xlink:href="#MJX-118-STX-I-1D465"></use></g></g><g data-mml-node="mo" data-latex="*" transform="translate(6580.3,0)"><use data-c="2217" xlink:href="#MJX-118-STX-N-2217"></use></g><g data-mml-node="mrow" data-latex="\class{preserve}{\inv\ \ys\ a'}" class="preserve" transform="translate(7338.5,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-118-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-118-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-118-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1336,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(1571,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-118-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(446,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2384,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="msup" transform="translate(2619,0)"><g data-mml-node="mi" data-latex="a"><use data-c="1D44E" xlink:href="#MJX-118-STX-I-1D44E"></use></g><g data-mml-node="mo" transform="translate(588,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-118-STX-V-2032"></use></g></g></g><g data-mml-node="mo" data-latex="\}" transform="translate(10841.6,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-118-STX-N-7D"></use></g><g data-mml-node="mtext" transform="translate(11168.6,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(11403.6,0)"><use data-c="1D453" xlink:href="#MJX-118-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(11980.6,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-118-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(12337.6,0)"><use data-c="1D465" xlink:href="#MJX-118-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(12896.6,0)"><use data-c="2C" xlink:href="#MJX-118-STX-N-2C"></use></g><g data-mml-node="msup" transform="translate(13308.3,0)"><g data-mml-node="mi" data-latex="a"><use data-c="1D44E" xlink:href="#MJX-118-STX-I-1D44E"></use></g><g data-mml-node="mo" transform="translate(588,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-118-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(14192.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-118-STX-N-29"></use></g><g data-mml-node="mtext" transform="translate(14549.3,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="\{" transform="translate(14784.3,0) translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-118-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(15111.3,0)"><use data-c="1D45F" xlink:href="#MJX-118-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(15523.3,0)"><use data-c="2E" xlink:href="#MJX-118-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(15935,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mrow" data-latex="\class{preserve}{\inv\ (x::\ys)\ r}" class="preserve" transform="translate(16170,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-118-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-118-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-118-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1336,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(1571,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-118-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(1928,0)"><use data-c="1D465" xlink:href="#MJX-118-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="::" transform="translate(2764.8,0)"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-118-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-118-STX-N-3A"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(3532.6,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-118-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(446,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(4345.6,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-118-STX-N-29"></use></g><g data-mml-node="mtext" transform="translate(4702.6,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(4937.6,0)"><use data-c="1D45F" xlink:href="#MJX-118-STX-I-1D45F"></use></g></g><g data-mml-node="mo" data-latex="\}" transform="translate(21519.6,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-118-STX-N-7D"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(21846.6,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-118-STX-N-29"></use></g></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-710.9)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mo" data-latex="*"><use data-c="2217" xlink:href="#MJX-118-STX-N-2217"></use></g><g data-mml-node="mtext" transform="translate(536,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mrow" data-latex="\class{shape}{\islist\ l\ \xs}" class="shape" transform="translate(771,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{isList}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="isList"><use data-c="69" xlink:href="#MJX-118-STX-MI-69"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(279,0)"></use><use data-c="4C" xlink:href="#MJX-118-STX-MI-4C" transform="translate(646,0)"></use><use data-c="69" xlink:href="#MJX-118-STX-MI-69" transform="translate(1215,0)"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(1494,0)"></use><use data-c="74" xlink:href="#MJX-118-STX-MI-74" transform="translate(1861,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2179,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(2414,0)"><use data-c="1D459" xlink:href="#MJX-118-STX-I-1D459"></use></g><g data-mml-node="mtext" transform="translate(2692,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(2927,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-118-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(453,0)"></use></g></g></g><g data-mml-node="mo" data-latex="*" transform="translate(4740.2,0)"><use data-c="2217" xlink:href="#MJX-118-STX-N-2217"></use></g><g data-mml-node="mrow" data-latex="\class{ppred}{\m{all}\ P\ \xs}" class="ppred" transform="translate(5498.4,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{all}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="all"><use data-c="61" xlink:href="#MJX-118-STX-MI-61"></use><use data-c="6C" xlink:href="#MJX-118-STX-MI-6C" transform="translate(534,0)"></use><use data-c="6C" xlink:href="#MJX-118-STX-MI-6C" transform="translate(807,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1080,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(1315,0)"><use data-c="1D443" xlink:href="#MJX-118-STX-I-1D443"></use></g><g data-mml-node="mtext" transform="translate(1896,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(2131,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-118-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(453,0)"></use></g></g></g><g data-mml-node="mo" data-latex="*" transform="translate(8671.7,0)"><use data-c="2217" xlink:href="#MJX-118-STX-N-2217"></use></g><g data-mml-node="mrow" data-latex="\class{foldrinv}{\inv\ []\ a}" class="foldrinv" transform="translate(9429.9,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-118-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-118-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-118-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1336,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="[" transform="translate(1571,0) translate(0 -20)"><use data-c="5B" xlink:href="#MJX-118-STX-N-5B"></use></g><g data-mml-node="mo" data-latex="]" transform="translate(1920,0) translate(0 -20)"><use data-c="5D" xlink:href="#MJX-118-STX-N-5D"></use></g><g data-mml-node="mtext" transform="translate(2269,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(2504,0)"><use data-c="1D44E" xlink:href="#MJX-118-STX-I-1D44E"></use></g></g></g></g></g><g data-mml-node="mo" data-latex-item="\right\}" data-latex="\right\}" transform="translate(23683.6,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-118-STX-S7-7D"></use></g></g></g></g><g data-mml-node="mtr" data-latex-item="{c}" data-latex="{c}" transform="translate(0,-835.9)"><g data-mml-node="mtd" transform="translate(13632.9,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-118-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-118-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-118-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-118-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-118-STX-MI-72" transform="translate(1590,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2006,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2241,0)"><use data-c="1D453" xlink:href="#MJX-118-STX-I-1D453"></use></g><g data-mml-node="mtext" transform="translate(2818,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(3053,0)"><use data-c="1D44E" xlink:href="#MJX-118-STX-I-1D44E"></use></g><g data-mml-node="mtext" transform="translate(3608,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(3843,0)"><use data-c="1D459" xlink:href="#MJX-118-STX-I-1D459"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{c}" data-latex="{c}" transform="translate(0,-2235.9)"><g data-mml-node="mtd" transform="translate(10954.4,0)"><g data-mml-node="mo" data-latex="\{" transform="translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-118-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(327,0)"><use data-c="1D45F" xlink:href="#MJX-118-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(739,0)"><use data-c="2E" xlink:href="#MJX-118-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(1150.7,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mrow" data-latex="\class{shape}{\islist\ l\ \xs}" class="shape" transform="translate(1385.7,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{isList}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="isList"><use data-c="69" xlink:href="#MJX-118-STX-MI-69"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(279,0)"></use><use data-c="4C" xlink:href="#MJX-118-STX-MI-4C" transform="translate(646,0)"></use><use data-c="69" xlink:href="#MJX-118-STX-MI-69" transform="translate(1215,0)"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(1494,0)"></use><use data-c="74" xlink:href="#MJX-118-STX-MI-74" transform="translate(1861,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2179,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(2414,0)"><use data-c="1D459" xlink:href="#MJX-118-STX-I-1D459"></use></g><g data-mml-node="mtext" transform="translate(2692,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(2927,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-118-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(453,0)"></use></g></g></g><g data-mml-node="mo" data-latex="*" transform="translate(5354.9,0)"><use data-c="2217" xlink:href="#MJX-118-STX-N-2217"></use></g><g data-mml-node="mrow" data-latex="\class{foldrinv}{\inv\ \xs\ r}" class="foldrinv" transform="translate(6113.1,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-118-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-118-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-118-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1336,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(1571,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-118-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-118-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2391,0)"><use data-c="A0" xlink:href="#MJX-118-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(2626,0)"><use data-c="1D45F" xlink:href="#MJX-118-STX-I-1D45F"></use></g></g><g data-mml-node="mo" data-latex="\}" transform="translate(9151.1,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-118-STX-N-7D"></use></g></g></g></g></g></g></svg></mjx-container></div><ol>
<li><span class="trigger" data-id="inv">The most salient feature</span> of this specification is that it is parameterized over an <em>invariant</em> <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="2.789ex" height="1.392ex" role="img" focusable="false" viewBox="0 -657 1336 667" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-119-STX-MI-49" d="M260 0L266 30C185 30 176 40 193 127L275 525C290 603 300 627 389 627L395 657L118 657L112 627C203 627 203 603 186 525L104 131C86 43 74 30-7 30L-13 0Z"></path><path id="MJX-119-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-119-STX-MI-76" d="M160-8C295 76 417 218 417 385C417 424 403 479 353 479C329 479 308 465 308 435C308 388 358 385 358 324C358 232 279 126 185 50L183 50L185 85C181 210 171 349 156 477L132 477L1 461L1 430C14 432 23 433 33 433C66 433 74 421 79 374C96 244 105 143 111-8Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\inv"><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-119-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-119-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-119-STX-MI-76" transform="translate(907,0)"></use></g></g></g></g></svg></mjx-container>, a (separation logic) <em>property</em> whose purpose is to describe the result of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-120-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-120-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-120-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-120-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-120-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-120-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-120-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-120-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-120-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-120-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container>. It does this by relating the suffix of the list traversed so far - initially empty, and finally <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.712ex" height="1.023ex" role="img" focusable="false" viewBox="0 -479 820 490" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-121-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-121-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\xs"><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-121-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-121-STX-MI-73" transform="translate(453,0)"></use></g></g></g></g></svg></mjx-container> - with the result of the fold.</li>
<li>Next, we use a <span class="trigger" data-id="finv">nested triple</span> to require that <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-122-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-122-STX-I-1D453"></use></g></g></g></svg></mjx-container> must preserve the invariant - assuming that the invariant holds of the portion of the list that has been folded <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.466ex" role="img" focusable="false" viewBox="0 -482 813 702" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-123-STX-MI-79" d="M2-220C69-220 126-139 234 15C244 29 348 175 398 268C429 325 441 365 441 401C441 457 411 482 377 482C349 482 334 464 334 442C334 403 383 383 383 346C383 330 374 303 350 264L235 79L229 79L220 179L198 325C186 405 179 437 157 475L142 475L8 464L8 435C17 436 26 437 35 437C94 437 100 393 108 343L165-9C137-51 57-163 35-163C19-163 4-109-37-109C-59-109-76-124-76-152C-76-193-38-220 2-220Z"></path><path id="MJX-123-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\ys"><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-123-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-123-STX-MI-73" transform="translate(446,0)"></use></g></g></g></g></svg></mjx-container> and the result of the recursive call <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.846ex" height="1.636ex" role="img" focusable="false" viewBox="0 -771.7 884.1 783.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-124-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-124-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="a'"><g data-mml-node="msup" data-latex="a'"><g data-mml-node="mi" data-latex="a"><use data-c="1D44E" xlink:href="#MJX-124-STX-I-1D44E"></use></g><g data-mml-node="mo" transform="translate(588,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-124-STX-V-2032"></use></g></g></g></g></svg></mjx-container>, <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-125-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-125-STX-I-1D453"></use></g></g></g></svg></mjx-container> must reestablish it for <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 559 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x::\ys"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-126-STX-I-1D465"></use></g></g></g><defs><path id="MJX-126-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-126-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-126-STX-MI-79" d="M2-220C69-220 126-139 234 15C244 29 348 175 398 268C429 325 441 365 441 401C441 457 411 482 377 482C349 482 334 464 334 442C334 403 383 383 383 346C383 330 374 303 350 264L235 79L229 79L220 179L198 325C186 405 179 437 157 475L142 475L8 464L8 435C17 436 26 437 35 437C94 437 100 393 108 343L165-9C137-51 57-163 35-163C19-163 4-109-37-109C-59-109-76-124-76-152C-76-193-38-220 2-220Z"></path><path id="MJX-126-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs></svg><mjx-break size="4"> </mjx-break><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="3.3ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 1580.8 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x::\ys"><g data-mml-node="mo" data-latex="::"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-126-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-126-STX-N-3A"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(767.8,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-126-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-126-STX-MI-73" transform="translate(446,0)"></use></g></g></g></g></svg></mjx-container> and its result <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.86ex" height="1ex" role="img" focusable="false" viewBox="0 -479 412 479" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-127-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="r"><g data-mml-node="mi" data-latex="r"><use data-c="1D45F" xlink:href="#MJX-127-STX-I-1D45F"></use></g></g></g></svg></mjx-container>. This is fair, as <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-128-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-128-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-128-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-128-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-128-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-128-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-128-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-128-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-128-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-128-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> contains a call to <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-129-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-129-STX-I-1D453"></use></g></g></g></svg></mjx-container>, and so we need the knowledge that <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-130-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-130-STX-I-1D453"></use></g></g></g></svg></mjx-container> preserves the invariant to ensure that <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-131-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-131-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-131-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-131-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-131-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-131-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-131-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-131-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-131-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-131-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> does. As the invariant is a separation logic property, it may also be seen as a way to describe the effect of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-132-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-132-STX-I-1D453"></use></g></g></g></svg></mjx-container>.</li>
<li>Anticipating that some clients may want to operate only on certain kinds of lists, the specification is further <span class="trigger" data-id="ppred">parameterized</span> over a unary predicate <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.213ex" height="1.372ex" role="img" focusable="false" viewBox="0 -657 581 657" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-133-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="P"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-133-STX-I-1D443"></use></g></g></g></svg></mjx-container>. A precondition <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="6.161ex" height="1.497ex" role="img" focusable="false" viewBox="0 -705 2951 717" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-134-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-134-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-134-STX-N-A0" d=""></path><path id="MJX-134-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-134-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-134-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{all}\ P\ \xs"><g data-mml-node="TeXAtom" data-latex="\mathit{all}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="all"><use data-c="61" xlink:href="#MJX-134-STX-MI-61"></use><use data-c="6C" xlink:href="#MJX-134-STX-MI-6C" transform="translate(534,0)"></use><use data-c="6C" xlink:href="#MJX-134-STX-MI-6C" transform="translate(807,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1080,0)"><use data-c="A0" xlink:href="#MJX-134-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(1315,0)"><use data-c="1D443" xlink:href="#MJX-134-STX-I-1D443"></use></g><g data-mml-node="mtext" transform="translate(1896,0)"><use data-c="A0" xlink:href="#MJX-134-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(2131,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-134-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-134-STX-MI-73" transform="translate(453,0)"></use></g></g></g></g></svg></mjx-container>, which must be proved at each call site, allows <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-135-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-135-STX-I-1D453"></use></g></g></g></svg></mjx-container> to then rely on <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="2.871ex" height="1.392ex" role="img" focusable="false" viewBox="0 -657 1375 667" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-136-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-136-STX-N-A0" d=""></path><path id="MJX-136-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="P\ x"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-136-STX-I-1D443"></use></g><g data-mml-node="mtext" transform="translate(581,0)"><use data-c="A0" xlink:href="#MJX-136-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(816,0)"><use data-c="1D465" xlink:href="#MJX-136-STX-I-1D465"></use></g></g></g></svg></mjx-container> in its precondition.</li>
<li><span class="trigger" data-id="shape">A shape predicate</span> <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="4.549ex" height="1.411ex" role="img" focusable="false" viewBox="0 -665 2179 676" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-137-STX-MI-69" d="M115-9C181-9 220 47 255 96L235 111C219 93 191 59 157 59C145 59 139 65 139 78C139 92 144 120 144 120L219 476L197 476L57 465L57 438C57 438 74 440 91 440C118 440 123 424 123 411C123 394 120 380 120 380L69 142C56 83 52 61 52 44C52 9 75-9 115-9M188 556C218 556 243 576 243 610C243 643 224 665 191 665C158 665 136 644 136 610C136 575 158 556 188 556Z"></path><path id="MJX-137-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-137-STX-MI-4C" d="M481 0L541 195L509 195C447 79 426 38 299 38L252 38C193 38 178 48 187 92L278 540C293 612 325 627 397 627L402 657L118 657L112 627C198 627 203 607 189 541L103 124C86 44 70 30-7 30L-13 0Z"></path><path id="MJX-137-STX-MI-74" d="M115-9C194-9 236 65 265 104L245 119C210 74 189 59 160 59C146 59 143 69 143 80C143 97 150 130 150 130L211 428L310 428L318 467L219 467L245 593L215 593C165 506 140 482 76 449L72 428L129 428L61 101C59 91 54 61 54 44C54 13 73-9 115-9Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\islist"><g data-mml-node="TeXAtom" data-latex="\mathit{isList}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="isList"><use data-c="69" xlink:href="#MJX-137-STX-MI-69"></use><use data-c="73" xlink:href="#MJX-137-STX-MI-73" transform="translate(279,0)"></use><use data-c="4C" xlink:href="#MJX-137-STX-MI-4C" transform="translate(646,0)"></use><use data-c="69" xlink:href="#MJX-137-STX-MI-69" transform="translate(1215,0)"></use><use data-c="73" xlink:href="#MJX-137-STX-MI-73" transform="translate(1494,0)"></use><use data-c="74" xlink:href="#MJX-137-STX-MI-74" transform="translate(1861,0)"></use></g></g></g></g></svg></mjx-container> relating the list structure <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.019ex;" xmlns="http://www.w3.org/2000/svg" width="0.58ex" height="1.491ex" role="img" focusable="false" viewBox="0 -705 278 714" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-138-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="l"><g data-mml-node="mi" data-latex="l"><use data-c="1D459" xlink:href="#MJX-138-STX-I-1D459"></use></g></g></g></svg></mjx-container> to its content <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.712ex" height="1.023ex" role="img" focusable="false" viewBox="0 -479 820 490" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-139-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-139-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\xs"><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-139-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-139-STX-MI-73" transform="translate(453,0)"></use></g></g></g></g></svg></mjx-container> appears in both pre- and postcondition. This is to say that <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-140-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-140-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-140-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-140-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-140-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-140-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-140-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-140-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-140-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-140-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> should not change the list.</li>
</ol>
<style>
  .highlight {
    color: red;
  }
  .trigger {
    text-decoration: underline;
    cursor: help;
  }
</style>
<script>
const foldrHighlightData = {
  'inv': 'foldrinv',
  'shape': 'shape',
  'ppred': 'ppred',
  'finv': 'preserve',
};
document.addEventListener('mouseover', function(event) {
  let elt=event.target.closest('.trigger');
  if (elt !== null) {
    document.querySelectorAll('.' + foldrHighlightData[elt.dataset.id])
      .forEach(a => a.classList.add('highlight'));
  }
});
document.addEventListener('mouseout', function(event) {
  let elt=event.target.closest('.trigger');
  if (elt !== null) {
    document.querySelectorAll('.' + foldrHighlightData[elt.dataset.id])
      .forEach(a => a.classList.remove('highlight'));
  }
});
</script>
<p>This specification elegantly solves the problem for the client we presented earlier (using an invariant to relate the value of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.027ex;" xmlns="http://www.w3.org/2000/svg" width="4.868ex" height="1.265ex" role="img" focusable="false" viewBox="0 -593 2332 606" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-141-STX-MI-63" d="M183-13C273-13 336 46 376 108L359 123C329 85 290 57 225 57C150 57 117 95 117 183C117 300 176 446 282 446C313 446 330 434 330 419C330 403 311 375 311 349C311 327 325 314 349 314C386 314 405 346 405 386C405 451 354 479 292 479C152 479 34 337 34 167C34 58 85-13 183-13Z"></path><path id="MJX-141-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-141-STX-MI-75" d="M123-10C240-10 311 127 352 197L361 197C344 132 329 92 329 45C329 1 362-9 389-9C450-9 487 32 531 96L510 111C510 111 473 59 437 59C421 59 416 68 416 76C416 91 422 119 422 119L496 473L413 473L381 332C360 241 249 62 175 62C153 62 145 79 145 103C145 121 152 151 152 151L221 476L190 476L55 465L55 438C66 439 75 440 89 440C106 440 125 434 125 413C125 394 115 350 115 350L67 135C64 121 57 88 57 62C57 25 72-10 123-10Z"></path><path id="MJX-141-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-141-STX-MI-74" d="M115-9C194-9 236 65 265 104L245 119C210 74 189 59 160 59C146 59 143 69 143 80C143 97 150 130 150 130L211 428L310 428L318 467L219 467L245 593L215 593C165 506 140 482 76 449L72 428L129 428L61 101C59 91 54 61 54 44C54 13 73-9 115-9Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{count}"><g data-mml-node="TeXAtom" data-latex="\mathit{count}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="count"><use data-c="63" xlink:href="#MJX-141-STX-MI-63"></use><use data-c="6F" xlink:href="#MJX-141-STX-MI-6F" transform="translate(408,0)"></use><use data-c="75" xlink:href="#MJX-141-STX-MI-75" transform="translate(893,0)"></use><use data-c="6E" xlink:href="#MJX-141-STX-MI-6E" transform="translate(1450,0)"></use><use data-c="74" xlink:href="#MJX-141-STX-MI-74" transform="translate(2014,0)"></use></g></g></g></g></svg></mjx-container> and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.019ex;" xmlns="http://www.w3.org/2000/svg" width="0.706ex" height="1.257ex" role="img" focusable="false" viewBox="0 -593 338 602" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-142-STX-I-1D461" d="M317 467L216 467L244 593L214 593C164 506 139 482 75 449L71 428L128 428L60 101C58 91 53 61 53 44C53 13 72-9 114-9C193-9 235 65 264 104L244 119C209 74 188 59 159 59C145 59 142 69 142 80C142 97 149 130 149 130L208 428L309 428Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="t"><g data-mml-node="mi" data-latex="t"><use data-c="1D461" xlink:href="#MJX-142-STX-I-1D461"></use></g></g></g></svg></mjx-container>, and an identity <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.213ex" height="1.372ex" role="img" focusable="false" viewBox="0 -657 581 657" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-143-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="P"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-143-STX-I-1D443"></use></g></g></g></svg></mjx-container>).
We argue, however, that it is <em>imprecise</em>: there are many clients that <em>cannot be verified</em> using it <em>without significant changes</em>.</p>
<p>The authors of the specification say as much<sup class="footnote-ref"><a href="#fn1" id="fnref1:1">1</a></sup>:</p>
<!-- [Iris tutorial](https://iris-project.org/tutorial-pdfs/iris-lecture-notes.pdf) says as much (pg 35): -->
<blockquote>
<p>Different clients may instantiate foldr with some very different functions, hence it can be hard to give a specification for f that is reasonable and general enough to support all these choices.</p>
</blockquote>
<p>The problem is that due to the use of abstract properties, this specification commits somewhat prematurely to an <em>abstraction</em> of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-144-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-144-STX-I-1D453"></use></g></g></g></svg></mjx-container>'s behavior, and this abstraction may not be precise enough to verify a given client.</p>
<p>We'll look at three examples of such clients.</p>
<h2 id="example-1-mutating-the-list">Example 1: mutating the list</h2>
<p>Suppose we allowed <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-145-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-145-STX-I-1D453"></use></g></g></g></svg></mjx-container> to mutate the list.</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr_ex1 l <span class="token operator">=</span> foldr <span class="token punctuation">(</span><span class="token keyword">fun</span> x r <span class="token operator">-></span> <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token operator">!</span>x <span class="token keyword">in</span>
                                    x <span class="token operator">:=</span> v<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> v<span class="token operator">+</span>r<span class="token punctuation">)</span> l <span class="token number">0</span></code></pre>
<p>This is not technically allowed by the shape predicate in the postcondition, but suppose we changed it to <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="8.51ex" height="1.634ex" role="img" focusable="false" viewBox="0 -771.7 4076.1 782.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-146-STX-MI-69" d="M115-9C181-9 220 47 255 96L235 111C219 93 191 59 157 59C145 59 139 65 139 78C139 92 144 120 144 120L219 476L197 476L57 465L57 438C57 438 74 440 91 440C118 440 123 424 123 411C123 394 120 380 120 380L69 142C56 83 52 61 52 44C52 9 75-9 115-9M188 556C218 556 243 576 243 610C243 643 224 665 191 665C158 665 136 644 136 610C136 575 158 556 188 556Z"></path><path id="MJX-146-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-146-STX-MI-4C" d="M481 0L541 195L509 195C447 79 426 38 299 38L252 38C193 38 178 48 187 92L278 540C293 612 325 627 397 627L402 657L118 657L112 627C198 627 203 607 189 541L103 124C86 44 70 30-7 30L-13 0Z"></path><path id="MJX-146-STX-MI-74" d="M115-9C194-9 236 65 265 104L245 119C210 74 189 59 160 59C146 59 143 69 143 80C143 97 150 130 150 130L211 428L310 428L318 467L219 467L245 593L215 593C165 506 140 482 76 449L72 428L129 428L61 101C59 91 54 61 54 44C54 13 73-9 115-9Z"></path><path id="MJX-146-STX-N-A0" d=""></path><path id="MJX-146-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path><path id="MJX-146-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-146-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\islist\ l\ \xs'"><g data-mml-node="TeXAtom" data-latex="\mathit{isList}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="isList"><use data-c="69" xlink:href="#MJX-146-STX-MI-69"></use><use data-c="73" xlink:href="#MJX-146-STX-MI-73" transform="translate(279,0)"></use><use data-c="4C" xlink:href="#MJX-146-STX-MI-4C" transform="translate(646,0)"></use><use data-c="69" xlink:href="#MJX-146-STX-MI-69" transform="translate(1215,0)"></use><use data-c="73" xlink:href="#MJX-146-STX-MI-73" transform="translate(1494,0)"></use><use data-c="74" xlink:href="#MJX-146-STX-MI-74" transform="translate(1861,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2179,0)"><use data-c="A0" xlink:href="#MJX-146-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(2414,0)"><use data-c="1D459" xlink:href="#MJX-146-STX-I-1D459"></use></g><g data-mml-node="mtext" transform="translate(2692,0)"><use data-c="A0" xlink:href="#MJX-146-STX-N-A0"></use></g><g data-mml-node="msup" transform="translate(2927,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-146-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-146-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" transform="translate(853,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-146-STX-V-2032"></use></g></g></g></g></svg></mjx-container>.</p>
<p>The problem is that <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="6.342ex" height="1.395ex" role="img" focusable="false" viewBox="0 -657 3038 668" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-147-STX-MI-49" d="M260 0L266 30C185 30 176 40 193 127L275 525C290 603 300 627 389 627L395 657L118 657L112 627C203 627 203 603 186 525L104 131C86 43 74 30-7 30L-13 0Z"></path><path id="MJX-147-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-147-STX-MI-76" d="M160-8C295 76 417 218 417 385C417 424 403 479 353 479C329 479 308 465 308 435C308 388 358 385 358 324C358 232 279 126 185 50L183 50L185 85C181 210 171 349 156 477L132 477L1 461L1 430C14 432 23 433 33 433C66 433 74 421 79 374C96 244 105 143 111-8Z"></path><path id="MJX-147-STX-N-A0" d=""></path><path id="MJX-147-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-147-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-147-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\inv\ \xs\ r"><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-147-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-147-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-147-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1336,0)"><use data-c="A0" xlink:href="#MJX-147-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(1571,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-147-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-147-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2391,0)"><use data-c="A0" xlink:href="#MJX-147-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(2626,0)"><use data-c="1D45F" xlink:href="#MJX-147-STX-I-1D45F"></use></g></g></g></svg></mjx-container> tells us nothing about <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="2.399ex" height="1.634ex" role="img" focusable="false" viewBox="0 -771.7 1149.1 782.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-148-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-148-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-148-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\xs'"><g data-mml-node="msup" data-latex="\mathit{xs}'"><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-148-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-148-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" transform="translate(853,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-148-STX-V-2032"></use></g></g></g></g></svg></mjx-container>.
The use of invariants required us to <em>commit to a parameterization</em>, and this particular one is insufficient.</p>
<p>To fix this, we would have to add <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="2.399ex" height="1.634ex" role="img" focusable="false" viewBox="0 -771.7 1149.1 782.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-149-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-149-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-149-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\xs'"><g data-mml-node="msup" data-latex="\mathit{xs}'"><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-149-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-149-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" transform="translate(853,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-149-STX-V-2032"></use></g></g></g></g></svg></mjx-container> as a parameter to every occurrence of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="2.789ex" height="1.392ex" role="img" focusable="false" viewBox="0 -657 1336 667" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-150-STX-MI-49" d="M260 0L266 30C185 30 176 40 193 127L275 525C290 603 300 627 389 627L395 657L118 657L112 627C203 627 203 603 186 525L104 131C86 43 74 30-7 30L-13 0Z"></path><path id="MJX-150-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-150-STX-MI-76" d="M160-8C295 76 417 218 417 385C417 424 403 479 353 479C329 479 308 465 308 435C308 388 358 385 358 324C358 232 279 126 185 50L183 50L185 85C181 210 171 349 156 477L132 477L1 461L1 430C14 432 23 433 33 433C66 433 74 421 79 374C96 244 105 143 111-8Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\inv"><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-150-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-150-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-150-STX-MI-76" transform="translate(907,0)"></use></g></g></g></g></svg></mjx-container>.
While adding results in a more general specification, it would also be cluttered with more anticipated client use cases.</p>
<h2 id="example-2-stronger-precondition">Example 2: stronger precondition</h2>
<p>Suppose we would like to pass a function argument which relies on a property concerning intermediate results of the fold.</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr_ex2 l <span class="token operator">=</span> foldr <span class="token punctuation">(</span><span class="token keyword">fun</span> x r <span class="token operator">-></span> <span class="token keyword">assert</span><span class="token punctuation">(</span>x<span class="token operator">+</span>r<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> x<span class="token operator">+</span>r<span class="token punctuation">)</span> l <span class="token number">0</span></code></pre>
<p>The problem here is that we can't use <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.213ex" height="1.372ex" role="img" focusable="false" viewBox="0 -657 581 657" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-151-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="P"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-151-STX-I-1D443"></use></g></g></g></svg></mjx-container> to strengthen the precondition of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-152-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-152-STX-I-1D453"></use></g></g></g></svg></mjx-container>, as we need a property relating <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="1.021ex" role="img" focusable="false" viewBox="0 -479 559 489" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-153-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-153-STX-I-1D465"></use></g></g></g></svg></mjx-container> and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.86ex" height="1ex" role="img" focusable="false" viewBox="0 -479 412 479" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-154-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="r"><g data-mml-node="mi" data-latex="r"><use data-c="1D45F" xlink:href="#MJX-154-STX-I-1D45F"></use></g></g></g></svg></mjx-container>, and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.213ex" height="1.372ex" role="img" focusable="false" viewBox="0 -657 581 657" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-155-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="P"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-155-STX-I-1D443"></use></g></g></g></svg></mjx-container> only constrains <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="1.021ex" role="img" focusable="false" viewBox="0 -479 559 489" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-156-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-156-STX-I-1D465"></use></g></g></g></svg></mjx-container>. <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="2.789ex" height="1.392ex" role="img" focusable="false" viewBox="0 -657 1336 667" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-157-STX-MI-49" d="M260 0L266 30C185 30 176 40 193 127L275 525C290 603 300 627 389 627L395 657L118 657L112 627C203 627 203 603 186 525L104 131C86 43 74 30-7 30L-13 0Z"></path><path id="MJX-157-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-157-STX-MI-76" d="M160-8C295 76 417 218 417 385C417 424 403 479 353 479C329 479 308 465 308 435C308 388 358 385 358 324C358 232 279 126 185 50L183 50L185 85C181 210 171 349 156 477L132 477L1 461L1 430C14 432 23 433 33 433C66 433 74 421 79 374C96 244 105 143 111-8Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\inv"><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-157-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-157-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-157-STX-MI-76" transform="translate(907,0)"></use></g></g></g></g></svg></mjx-container> also cannot be used, as it only tells us about <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.86ex" height="1ex" role="img" focusable="false" viewBox="0 -479 412 479" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-158-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="r"><g data-mml-node="mi" data-latex="r"><use data-c="1D45F" xlink:href="#MJX-158-STX-I-1D45F"></use></g></g></g></svg></mjx-container>, not <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="1.021ex" role="img" focusable="false" viewBox="0 -479 559 489" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-159-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-159-STX-I-1D465"></use></g></g></g></svg></mjx-container>.</p>
<p>While it is possible to assume something stronger here, e.g. <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 559 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x \geq 0 \wedge r \geq 0"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-160-STX-I-1D465"></use></g></g></g><defs><path id="MJX-160-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-160-STX-N-2265" d="M650 332L650 342L71 623L71 557L514 337L71 116L71 52M650-106L650-38L71-38L71-106Z"></path><path id="MJX-160-STX-N-30" d="M468 317C468 523 378 642 249 642C104 642 27 510 27 320C27 143 86-11 247-11C404-11 468 146 468 317M371 311C371 119 326 25 247 25C167 25 123 121 123 315C123 513 167 608 246 608C328 608 371 514 371 311Z"></path><path id="MJX-160-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-160-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path></defs></svg><mjx-break size="4"> </mjx-break><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="3.116ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 1492.8 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x \geq 0 \wedge r \geq 0"><g data-mml-node="mo" data-latex="\geq"><use data-c="2265" xlink:href="#MJX-160-STX-N-2265"></use></g><g data-mml-node="mn" data-latex="0" transform="translate(997.8,0)"><use data-c="30" xlink:href="#MJX-160-STX-N-30"></use></g></g></g></svg><mjx-break size="3"> </mjx-break><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="2.652ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 1270.2 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x \geq 0 \wedge r \geq 0"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-160-STX-N-2227"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(858.2,0)"><use data-c="1D45F" xlink:href="#MJX-160-STX-I-1D45F"></use></g></g></g></svg><mjx-break size="4"> </mjx-break><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="3.116ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 1492.8 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x \geq 0 \wedge r \geq 0"><g data-mml-node="mo" data-latex="\geq"><use data-c="2265" xlink:href="#MJX-160-STX-N-2265"></use></g><g data-mml-node="mn" data-latex="0" transform="translate(997.8,0)"><use data-c="30" xlink:href="#MJX-160-STX-N-30"></use></g></g></g></svg></mjx-container>, in general it would be awkward to decompose the property into two parts.</p>
<h2 id="example-3-effects-outside-metalogic">Example 3: effects outside metalogic</h2>
<p>This example illustrates a different problem with invariants: suppose we allowed the function to throw an exception.</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr_ex3 l <span class="token operator">=</span> foldr <span class="token punctuation">(</span><span class="token keyword">fun</span> x r <span class="token operator">-></span> <span class="token keyword">if</span> x<span class="token operator">>=</span><span class="token number">0</span> <span class="token keyword">then</span> x<span class="token operator">+</span>r
                                    <span class="token keyword">else</span> raise Exc<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> l <span class="token number">0</span></code></pre>
<p>The problem is that our specification requires <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-161-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-161-STX-I-1D453"></use></g></g></g></svg></mjx-container> to <em>return</em> to preserve the invariant, and does not say anything about exceptions.</p>
<p>The more general issue is that we are trying to abstract <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-162-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-162-STX-I-1D453"></use></g></g></g></svg></mjx-container>'s behavior into a predicate of the underlying logic, and that limits expressiveness to that of the underlying logic.</p>
<p>This is the reason that, as mentioned earlier, many automated verifiers do not handle closures, because they lift function arguments into the pure, first-order logic of SMT, which cannot abstract over heap manipulation.
While separation logic can, it says nothing about exceptions/effects.
One would need some kind of (monadic) encoding or <a href="https://devilhena-paulo.github.io/thesis/de-vilhena-thesis.pdf">protocol</a>, a fundamentally different specification.</p>
<h1 id="staged-logic">Staged logic</h1>
<p>Taking a step back, why did we have to abstract away the behavior of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-163-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-163-STX-I-1D453"></use></g></g></g></svg></mjx-container> to begin with?</p>
<p>The problem was that it was difficult to represent (1) unknown higher-order effectful calls and (2) ordering of effects precisely in pre/post specifications.
Our idea is thus to generalize Hoare triples with the ingredients required to represent them.</p>
<p>Suppose we think of the traditional <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="3.146ex" height="1.478ex" role="img" focusable="false" viewBox="0 -488 1507 708" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-164-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-164-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-164-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{req}"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-164-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-164-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-164-STX-B-1D42A" transform="translate(933,0)"></use></g></g></g></g></svg></mjx-container> and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.261ex" height="1.038ex" role="img" focusable="false" viewBox="0 -485 1562 497" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-165-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-165-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-165-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{ens}"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-165-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-165-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-165-STX-B-1D42C" transform="translate(1134,0)"></use></g></g></g></g></svg></mjx-container>  as propositions in some new logical language <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.453ex;" xmlns="http://www.w3.org/2000/svg" width="1.267ex" height="1.476ex" role="img" focusable="false" viewBox="0 -490 607 707" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-166-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\varphi"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-166-STX-I-1D711"></use></g></g></g></svg></mjx-container> for describing effectful behavior.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="20.136ex" height="1.933ex" role="img" focusable="false" viewBox="0 -706 9645.2 926" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-167-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-167-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-167-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-167-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-167-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-167-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-167-STX-N-A0" d=""></path><path id="MJX-167-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-167-STX-N-2223" d="M170-194L170 706L102 706L102-194Z"></path><path id="MJX-167-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-167-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-167-STX-I-1D444" d="M685 409C685 545 610 669 432 669C219 669 60 492 60 252C61 82 145 1 301-8L316-51C348-136 410-173 564-173L614-173L619-145C476-145 436-60 396 0L396 3C555 39 685 176 685 409M583 415C583 187 485 31 324 31C206 31 163 115 163 243C162 484 283 626 417 626C533 626 583 539 583 415Z"></path><path id="MJX-167-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\varphi ::= \req{P} \mid \ens{Q} \mid ...
"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-167-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="::=" transform="translate(884.8,0)"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-167-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-167-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(490,0)"><use data-c="3D" xlink:href="#MJX-167-STX-N-3D"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2372.6,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-167-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-167-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-167-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(3879.6,0)"><use data-c="A0" xlink:href="#MJX-167-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(4114.6,0)"><use data-c="1D443" xlink:href="#MJX-167-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(4973.3,0)"><use data-c="2223" xlink:href="#MJX-167-STX-N-2223"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(5523.1,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-167-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-167-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-167-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(7085.1,0)"><use data-c="A0" xlink:href="#MJX-167-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="Q" transform="translate(7320.1,0)"><use data-c="1D444" xlink:href="#MJX-167-STX-I-1D444"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(8304.9,0)"><use data-c="2223" xlink:href="#MJX-167-STX-N-2223"></use></g><g data-mml-node="mo" data-latex="." transform="translate(8576.9,0)"><use data-c="2E" xlink:href="#MJX-167-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="." transform="translate(8988.6,0)"><use data-c="2E" xlink:href="#MJX-167-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="." transform="translate(9400.2,0)"><use data-c="2E" xlink:href="#MJX-167-STX-N-2E"></use></g></g></g></svg></mjx-container></div><p><mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.213ex" height="1.372ex" role="img" focusable="false" viewBox="0 -657 581 657" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-168-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="P"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-168-STX-I-1D443"></use></g></g></g></svg></mjx-container> and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.361ex;" xmlns="http://www.w3.org/2000/svg" width="1.476ex" height="1.758ex" role="img" focusable="false" viewBox="0 -669 707 842" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-169-STX-I-1D444" d="M685 409C685 545 610 669 432 669C219 669 60 492 60 252C61 82 145 1 301-8L316-51C348-136 410-173 564-173L614-173L619-145C476-145 436-60 396 0L396 3C555 39 685 176 685 409M583 415C583 187 485 31 324 31C206 31 163 115 163 243C162 484 283 626 417 626C533 626 583 539 583 415Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Q"><g data-mml-node="mi" data-latex="Q"><use data-c="1D444" xlink:href="#MJX-169-STX-I-1D444"></use></g></g></g></svg></mjx-container> are symbolic-heap separation logic formulae,</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="43.681ex" height="1.933ex" role="img" focusable="false" viewBox="0 -706 20923.1 926" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-170-STX-I-1D437" d="M118 657L112 627C184 627 204 616 190 543L103 124C87 43 69 30-7 30L-13 0L241 0C496 0 680 115 680 398C680 554 586 657 378 657M294 614C312 616 321 617 338 617C535 617 580 511 580 389C580 142 456 39 241 39C215 39 195 39 176 42Z"></path><path id="MJX-170-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-170-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-170-STX-I-1D444" d="M685 409C685 545 610 669 432 669C219 669 60 492 60 252C61 82 145 1 301-8L316-51C348-136 410-173 564-173L614-173L619-145C476-145 436-60 396 0L396 3C555 39 685 176 685 409M583 415C583 187 485 31 324 31C206 31 163 115 163 243C162 484 283 626 417 626C533 626 583 539 583 415Z"></path><path id="MJX-170-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-170-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-170-STX-I-1D70E" d="M568 473C533 472 489 469 443 469C395 469 345 472 300 472C139 472 41 350 41 165C41 92 68-14 194-14C337-14 442 87 443 246C444 310 412 361 399 381C398 382 398 383 397 384L397 388C423 387 437 387 460 387C536 387 563 429 570 459M359 390C375 355 387 319 387 268C387 115 292 69 208 69C143 69 89 105 90 192C90 331 190 391 286 391C310 391 335 390 359 390Z"></path><path id="MJX-170-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-170-STX-I-1D70B" d="M625 473C571 469 513 467 451 467C380 468 324 472 252 472C157 472 90 442 48 354L70 339C113 391 135 392 242 392C218 307 189 249 137 169C88 93 76 77 31 14L31 0L126 0C167 68 258 285 281 391C330 391 375 389 424 388C383 277 326 154 326 68C326 26 343-9 391-9C452-9 494 20 527 69L514 86C497 73 479 61 444 61C412 61 405 94 405 121C405 197 452 339 468 387C493 386 507 386 522 386C589 386 622 436 627 461Z"></path><path id="MJX-170-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-170-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-170-STX-MI-70" d="M225-11C376-11 488 119 488 307C488 423 428 479 353 479C303 479 261 450 215 396L215 397L211 397L225 474L206 474L63 459L63 434C63 434 80 436 95 436C121 436 132 427 132 407C132 400 131 394 130 388L5-220L201-220L208-193C128-193 107-166 107-143C107-129 109-111 111-101L135 15C155 3 194-11 225-11M146 65L196 307C223 368 262 423 324 423C352 423 400 402 400 307C400 131 334 32 232 32C191 32 163 50 146 65Z"></path><path id="MJX-170-STX-N-2223" d="M170-194L170 706L102 706L102-194Z"></path><path id="MJX-170-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-170-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-170-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-170-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-170-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="D,P,Q ::= \sigma{\wedge}\pi \quad \quad \quad \sigma ::= \emp \mid x{\mapsto}y \mid \sigma * \sigma \mid ...
"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-170-STX-I-1D437"></use></g><g data-mml-node="mo" data-latex="," transform="translate(702,0)"><use data-c="2C" xlink:href="#MJX-170-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(1113.7,0)"><use data-c="1D443" xlink:href="#MJX-170-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="," transform="translate(1694.7,0)"><use data-c="2C" xlink:href="#MJX-170-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="Q" transform="translate(2106.3,0)"><use data-c="1D444" xlink:href="#MJX-170-STX-I-1D444"></use></g><g data-mml-node="mo" data-latex="::=" transform="translate(3091.1,0)"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-170-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-170-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(490,0)"><use data-c="3D" xlink:href="#MJX-170-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(4578.9,0)"><use data-c="1D70E" xlink:href="#MJX-170-STX-I-1D70E"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(5148.9,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-170-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="\pi" transform="translate(5784.9,0)"><use data-c="1D70B" xlink:href="#MJX-170-STX-I-1D70B"></use></g><g data-mml-node="mspace" data-latex="\quad" transform="translate(6418.9,0)"></g><g data-mml-node="mspace" data-latex="\quad" transform="translate(7418.9,0)"></g><g data-mml-node="mspace" data-latex="\quad" transform="translate(8418.9,0)"></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(9418.9,0)"><use data-c="1D70E" xlink:href="#MJX-170-STX-I-1D70E"></use></g><g data-mml-node="mo" data-latex="::=" transform="translate(10266.7,0)"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-170-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-170-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(490,0)"><use data-c="3D" xlink:href="#MJX-170-STX-N-3D"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{emp}" data-mjx-texclass="ORD" transform="translate(11754.4,0)"><g data-mml-node="mi" data-latex="emp"><use data-c="65" xlink:href="#MJX-170-STX-MI-65"></use><use data-c="6D" xlink:href="#MJX-170-STX-MI-6D" transform="translate(412,0)"></use><use data-c="70" xlink:href="#MJX-170-STX-MI-70" transform="translate(1237,0)"></use></g></g><g data-mml-node="mo" data-latex="\mid" transform="translate(13790.2,0)"><use data-c="2223" xlink:href="#MJX-170-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(14340,0)"><use data-c="1D465" xlink:href="#MJX-170-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(14899,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-170-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="y" transform="translate(15847,0)"><use data-c="1D466" xlink:href="#MJX-170-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(16634.8,0)"><use data-c="2223" xlink:href="#MJX-170-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(17184.6,0)"><use data-c="1D70E" xlink:href="#MJX-170-STX-I-1D70E"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(17976.8,0)"><use data-c="2217" xlink:href="#MJX-170-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(18735,0)"><use data-c="1D70E" xlink:href="#MJX-170-STX-I-1D70E"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(19582.8,0)"><use data-c="2223" xlink:href="#MJX-170-STX-N-2223"></use></g><g data-mml-node="mo" data-latex="." transform="translate(19854.8,0)"><use data-c="2E" xlink:href="#MJX-170-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="." transform="translate(20266.4,0)"><use data-c="2E" xlink:href="#MJX-170-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="." transform="translate(20678.1,0)"><use data-c="2E" xlink:href="#MJX-170-STX-N-2E"></use></g></g></g></svg></mjx-container></div><p>and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="3.146ex" height="1.478ex" role="img" focusable="false" viewBox="0 -488 1507 708" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-171-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-171-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-171-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{req}"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-171-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-171-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-171-STX-B-1D42A" transform="translate(933,0)"></use></g></g></g></g></svg></mjx-container> may be thought of as a separation logic <em>assert</em> (or <em>exhale</em>, in Viper terms, which requires the presence of a portion of heap and consumes it), and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.261ex" height="1.038ex" role="img" focusable="false" viewBox="0 -485 1562 497" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-172-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-172-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-172-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{ens}"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-172-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-172-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-172-STX-B-1D42C" transform="translate(1134,0)"></use></g></g></g></g></svg></mjx-container> as the dual notion of <em>assume</em> (or <em>inhale</em>, which produces a portion of heap).</p>
<p>We then extend this language with two new constructs: sequencing and (un)interpreted relations.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="42.415ex" height="1.965ex" role="img" focusable="false" viewBox="0 -716 20316.8 941" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-173-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-173-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-173-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-173-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-173-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-173-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-173-STX-N-A0" d=""></path><path id="MJX-173-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-173-STX-N-2223" d="M170-194L170 706L102 706L102-194Z"></path><path id="MJX-173-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-173-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-173-STX-I-1D444" d="M685 409C685 545 610 669 432 669C219 669 60 492 60 252C61 82 145 1 301-8L316-51C348-136 410-173 564-173L614-173L619-145C476-145 436-60 396 0L396 3C555 39 685 176 685 409M583 415C583 187 485 31 324 31C206 31 163 115 163 243C162 484 283 626 417 626C533 626 583 539 583 415Z"></path><path id="MJX-173-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-173-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-173-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-173-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-173-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-173-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-173-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-173-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-173-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-173-STX-N-2228" d="M604 549L531 549L319 106L105 549L32 549L314-30L324-30Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\varphi ::= \req{P} \mid \ens{Q} \mid \varphi; \varphi \mid f(x, r) \mid \exists x.\ \varphi \mid \varphi \vee \varphi
"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-173-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="::=" transform="translate(884.8,0)"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-173-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-173-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(490,0)"><use data-c="3D" xlink:href="#MJX-173-STX-N-3D"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2372.6,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-173-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-173-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-173-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(3879.6,0)"><use data-c="A0" xlink:href="#MJX-173-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(4114.6,0)"><use data-c="1D443" xlink:href="#MJX-173-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(4973.3,0)"><use data-c="2223" xlink:href="#MJX-173-STX-N-2223"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(5523.1,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-173-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-173-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-173-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(7085.1,0)"><use data-c="A0" xlink:href="#MJX-173-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="Q" transform="translate(7320.1,0)"><use data-c="1D444" xlink:href="#MJX-173-STX-I-1D444"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(8304.9,0)"><use data-c="2223" xlink:href="#MJX-173-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(8854.7,0)"><use data-c="1D711" xlink:href="#MJX-173-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(9461.7,0)"><use data-c="3B" xlink:href="#MJX-173-STX-N-3B"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(9873.3,0)"><use data-c="1D711" xlink:href="#MJX-173-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(10758.1,0)"><use data-c="2223" xlink:href="#MJX-173-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(11307.9,0)"><use data-c="1D453" xlink:href="#MJX-173-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(11884.9,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-173-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(12241.9,0)"><use data-c="1D465" xlink:href="#MJX-173-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(12800.9,0)"><use data-c="2C" xlink:href="#MJX-173-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(13212.6,0)"><use data-c="1D45F" xlink:href="#MJX-173-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(13624.6,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-173-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(14259.3,0)"><use data-c="2223" xlink:href="#MJX-173-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="\exists" transform="translate(14809.1,0)"><use data-c="2203" xlink:href="#MJX-173-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(15382.1,0)"><use data-c="1D465" xlink:href="#MJX-173-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(15941.1,0)"><use data-c="2E" xlink:href="#MJX-173-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(16352.8,0)"><use data-c="A0" xlink:href="#MJX-173-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(16587.8,0)"><use data-c="1D711" xlink:href="#MJX-173-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(17472.6,0)"><use data-c="2223" xlink:href="#MJX-173-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(18022.3,0)"><use data-c="1D711" xlink:href="#MJX-173-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\vee" transform="translate(18851.6,0)"><use data-c="2228" xlink:href="#MJX-173-STX-N-2228"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(19709.8,0)"><use data-c="1D711" xlink:href="#MJX-173-STX-I-1D711"></use></g></g></g></svg></mjx-container></div><!-- We call $\varphi$ a *staged formula*, for reasons that will be explained shortly. -->
<!-- $\sigma{\wedge}\pi$ is a symbolic-heap separation logic formula. -->
<p>What is the semantics of such formulae? We defer a detailed answer to our paper<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup>, but a first approximation is the following generalization, starting from the (partial correctness) semantics of Hoare triples.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -1.954ex;" xmlns="http://www.w3.org/2000/svg" width="48.783ex" height="4.951ex" role="img" focusable="false" viewBox="0 -1435.9 23367 2371.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-174-STX-N-7B" d="M25 245C72 240 115 233 115 173C115 126 96 8 96-52C96-167 184-197 282-197L282-165C225-165 170-150 170-64C170-13 185 68 185 129C185 212 144 247 93 267L93 273C144 293 185 328 185 411C185 472 170 552 170 603C170 689 225 704 282 704L282 736C184 736 96 706 96 591C96 531 115 414 115 367C115 307 72 300 25 295Z"></path><path id="MJX-174-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-174-STX-N-7D" d="M302 295C255 300 212 307 212 367C212 414 231 531 231 591C231 706 143 736 45 736L45 704C102 704 157 689 157 603C157 552 142 472 142 411C142 328 183 293 234 273L234 267C183 247 142 212 142 129C142 68 157-13 157-64C157-150 102-165 45-165L45-197C143-197 231-167 231-52C231 8 212 126 212 173C212 233 255 240 302 245Z"></path><path id="MJX-174-STX-N-A0" d=""></path><path id="MJX-174-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-174-STX-I-1D444" d="M685 409C685 545 610 669 432 669C219 669 60 492 60 252C61 82 145 1 301-8L316-51C348-136 410-173 564-173L614-173L619-145C476-145 436-60 396 0L396 3C555 39 685 176 685 409M583 415C583 187 485 31 324 31C206 31 163 115 163 243C162 484 283 626 417 626C533 626 583 539 583 415Z"></path><path id="MJX-174-STX-N-2261" d="M658 28L658 96L62 96L62 28M658 225L658 293L62 293L62 225M658 422L658 489L62 489L62 422Z"></path><path id="MJX-174-STX-N-2200" d="M571 678L498 678L423 474L150 474L75 678L2 678L253 0L320 0M400 412L286 105L173 412Z"></path><path id="MJX-174-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-174-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-174-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path><path id="MJX-174-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-174-STX-N-27E8" d="M299 736L262 736L40 280L40 260L262-196L299-196L112 270Z"></path><path id="MJX-174-STX-N-27E9" d="M227 270L40-196L77-196L299 260L299 280L77 736L40 736Z"></path><path id="MJX-174-STX-N-27F6" d="M1555 264C1457 305 1379 383 1313 460L1292 440C1315 406 1346 369 1376 341C1386 331 1390 324 1390 315C1390 305 1374 293 1364 293L56 293L56 225L1363 225C1381 225 1389 215 1389 205C1389 196 1384 185 1375 176C1344 144 1315 111 1291 78L1311 58C1379 136 1457 212 1555 254Z"></path><path id="MJX-174-STX-I-1D463" d="M200 476L53 465L53 437C53 437 83 440 99 440C117 440 123 426 123 409C123 389 116 365 113 354L93 278C82 236 71 183 71 135C71 58 100-9 200-9C380-9 479 206 479 358C479 429 448 479 403 479C382 479 365 464 365 437C365 393 426 369 426 299C426 206 368 55 231 55C170 55 153 99 153 151C153 196 166 249 175 284L222 476Z"></path><path id="MJX-174-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-174-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-174-STX-N-22A8" d="M646 203L646 270L143 270L143 407L646 407L646 475L143 475L143 678L75 678L75 0L143 0L143 203Z"></path><path id="MJX-174-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-174-STX-N-21D2" d="M826 264C702 358 571 445 451 564L429 543C454 515 480 486 506 460C520 444 529 438 529 418C529 409 520 395 502 395L0 395L0 327L649 327C683 308 710 283 710 259C710 234 683 213 650 190L0 190L0 123L502 123C520 123 529 108 529 100C529 84 522 75 505 57C494 46 454 3 429-26L451-46C571 72 700 159 826 254Z"></path><path id="MJX-174-STX-B-7B" d="M333-141C281-141 234-106 234-40C234 32 252 64 252 144C252 217 217 253 154 268L154 274C203 291 255 334 255 405C255 480 234 529 234 583C234 665 281 687 333 687L333 732C209 732 106 687 106 578C106 514 139 425 139 367C139 314 95 303 50 301L50 236C95 235 139 226 139 175C139 121 106 31 106-34C106-141 209-186 333-186Z"></path><path id="MJX-174-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-174-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-174-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-174-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-174-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-174-STX-MI-70" d="M225-11C376-11 488 119 488 307C488 423 428 479 353 479C303 479 261 450 215 396L215 397L211 397L225 474L206 474L63 459L63 434C63 434 80 436 95 436C121 436 132 427 132 407C132 400 131 394 130 388L5-220L201-220L208-193C128-193 107-166 107-143C107-129 109-111 111-101L135 15C155 3 194-11 225-11M146 65L196 307C223 368 262 423 324 423C352 423 400 402 400 307C400 131 334 32 232 32C191 32 163 50 146 65Z"></path><path id="MJX-174-STX-B-7D" d="M45-186C169-186 272-141 272-34C272 31 239 121 239 175C239 226 283 235 328 236L328 301C283 303 239 314 239 367C239 425 272 514 272 578C272 687 169 732 45 732L45 687C97 687 144 665 144 583C144 529 123 480 123 405C123 334 175 291 224 274L224 268C161 253 126 217 126 144C126 64 144 32 144-40C144-106 97-141 45-141Z"></path><path id="MJX-174-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-174-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-174-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{align*}
\s{P}\ e\ \s{Q} \equiv &amp; \ \forall s, s'. \langle s, e \rangle \longrightarrow \langle s', v \rangle \wedge (s\vDash P) \Rightarrow \langle s',v \rangle \vDash Q \\
\s{P}\ e\ \s{Q} \equiv &amp; \ \sb{\ens{\emp}}\ e\ \sb{\req{P}; \ens{Q}} \\
\end{align*}
"><g data-mml-node="mtable" data-latex-item="{align*}" data-latex="\mathbf{ens}\ Q\textbf{\}} \\
\end{align*}
"><g data-mml-node="mtr" transform="translate(0,614.1)"><g data-mml-node="mtd"><g data-mml-node="mo" data-latex="\{" transform="translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-174-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(327,0)"><use data-c="1D443" xlink:href="#MJX-174-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="\}" transform="translate(908,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-174-STX-N-7D"></use></g><g data-mml-node="mtext" transform="translate(1235,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(1470,0)"><use data-c="1D452" xlink:href="#MJX-174-STX-I-1D452"></use></g><g data-mml-node="mtext" transform="translate(1894,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="\{" transform="translate(2129,0) translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-174-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="Q" transform="translate(2456,0)"><use data-c="1D444" xlink:href="#MJX-174-STX-I-1D444"></use></g><g data-mml-node="mo" data-latex="\}" transform="translate(3163,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-174-STX-N-7D"></use></g><g data-mml-node="mo" data-latex="\equiv" transform="translate(3767.8,0)"><use data-c="2261" xlink:href="#MJX-174-STX-N-2261"></use></g></g><g data-mml-node="mtd" transform="translate(4487.8,0)"><g data-mml-node="mstyle"><g data-mml-node="mtext"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\forall" transform="translate(235,0)"><use data-c="2200" xlink:href="#MJX-174-STX-N-2200"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(808,0)"><use data-c="1D460" xlink:href="#MJX-174-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex="," transform="translate(1194,0)"><use data-c="2C" xlink:href="#MJX-174-STX-N-2C"></use></g><g data-mml-node="msup" transform="translate(1605.7,0)"><g data-mml-node="mi" data-latex="s"><use data-c="1D460" xlink:href="#MJX-174-STX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(419,413) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-174-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex="." transform="translate(2320.7,0)"><use data-c="2E" xlink:href="#MJX-174-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="\langle" transform="translate(2732.4,0) translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-174-STX-N-27E8"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(3071.4,0)"><use data-c="1D460" xlink:href="#MJX-174-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3457.4,0)"><use data-c="2C" xlink:href="#MJX-174-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(3869.1,0)"><use data-c="1D452" xlink:href="#MJX-174-STX-I-1D452"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(4293.1,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-174-STX-N-27E9"></use></g><g data-mml-node="mo" data-latex="\longrightarrow" transform="translate(4909.9,0)"><use data-c="27F6" xlink:href="#MJX-174-STX-N-27F6"></use></g><g data-mml-node="mo" data-latex="\langle" transform="translate(6799.6,0) translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-174-STX-N-27E8"></use></g><g data-mml-node="msup" transform="translate(7138.6,0)"><g data-mml-node="mi" data-latex="s"><use data-c="1D460" xlink:href="#MJX-174-STX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(419,413) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-174-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(7853.7,0)"><use data-c="2C" xlink:href="#MJX-174-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="v" transform="translate(8265.4,0)"><use data-c="1D463" xlink:href="#MJX-174-STX-I-1D463"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(8769.4,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-174-STX-N-27E9"></use></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(9330.6,0)"><use data-c="2227" xlink:href="#MJX-174-STX-N-2227"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(10188.8,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-174-STX-N-28"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(10545.8,0)"><use data-c="1D460" xlink:href="#MJX-174-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex="\vDash" transform="translate(11209.6,0)"><use data-c="22A8" xlink:href="#MJX-174-STX-N-22A8"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(12207.4,0)"><use data-c="1D443" xlink:href="#MJX-174-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(12788.4,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-174-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\Rightarrow" transform="translate(13423.1,0)"><use data-c="21D2" xlink:href="#MJX-174-STX-N-21D2"></use></g><g data-mml-node="mo" data-latex="\langle" transform="translate(14587.9,0) translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-174-STX-N-27E8"></use></g><g data-mml-node="msup" transform="translate(14926.9,0)"><g data-mml-node="mi" data-latex="s"><use data-c="1D460" xlink:href="#MJX-174-STX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(419,413) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-174-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(15642,0)"><use data-c="2C" xlink:href="#MJX-174-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="v" transform="translate(16053.7,0)"><use data-c="1D463" xlink:href="#MJX-174-STX-I-1D463"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(16557.7,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-174-STX-N-27E9"></use></g><g data-mml-node="mo" data-latex="\vDash" transform="translate(17174.4,0)"><use data-c="22A8" xlink:href="#MJX-174-STX-N-22A8"></use></g><g data-mml-node="mi" data-latex="Q" transform="translate(18172.2,0)"><use data-c="1D444" xlink:href="#MJX-174-STX-I-1D444"></use></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-685.9)"><g data-mml-node="mtd"><g data-mml-node="mo" data-latex="\{" transform="translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-174-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(327,0)"><use data-c="1D443" xlink:href="#MJX-174-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="\}" transform="translate(908,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-174-STX-N-7D"></use></g><g data-mml-node="mtext" transform="translate(1235,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(1470,0)"><use data-c="1D452" xlink:href="#MJX-174-STX-I-1D452"></use></g><g data-mml-node="mtext" transform="translate(1894,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="\{" transform="translate(2129,0) translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-174-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="Q" transform="translate(2456,0)"><use data-c="1D444" xlink:href="#MJX-174-STX-I-1D444"></use></g><g data-mml-node="mo" data-latex="\}" transform="translate(3163,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-174-STX-N-7D"></use></g><g data-mml-node="mo" data-latex="\equiv" transform="translate(3767.8,0)"><use data-c="2261" xlink:href="#MJX-174-STX-N-2261"></use></g></g><g data-mml-node="mtd" transform="translate(4487.8,0)"><g data-mml-node="mstyle"><g data-mml-node="mtext"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mtext" data-latex="\textbf{\{}" transform="translate(235,0)"><use data-c="7B" xlink:href="#MJX-174-STX-B-7B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(613,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-174-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-174-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-174-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2175,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{emp}" data-mjx-texclass="ORD" transform="translate(2410,0)"><g data-mml-node="mi" data-latex="emp"><use data-c="65" xlink:href="#MJX-174-STX-MI-65"></use><use data-c="6D" xlink:href="#MJX-174-STX-MI-6D" transform="translate(412,0)"></use><use data-c="70" xlink:href="#MJX-174-STX-MI-70" transform="translate(1237,0)"></use></g></g><g data-mml-node="mtext" data-latex="\textbf{\}}" transform="translate(4168,0)"><use data-c="7D" xlink:href="#MJX-174-STX-B-7D"></use></g><g data-mml-node="mtext" transform="translate(4546,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(4781,0)"><use data-c="1D452" xlink:href="#MJX-174-STX-I-1D452"></use></g><g data-mml-node="mtext" transform="translate(5205,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mtext" data-latex="\textbf{\{}" transform="translate(5440,0)"><use data-c="7B" xlink:href="#MJX-174-STX-B-7B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(5818,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-174-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-174-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-174-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(7325,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(7560,0)"><use data-c="1D443" xlink:href="#MJX-174-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(8141,0)"><use data-c="3B" xlink:href="#MJX-174-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(8552.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-174-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-174-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-174-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(10114.7,0)"><use data-c="A0" xlink:href="#MJX-174-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="Q" transform="translate(10349.7,0)"><use data-c="1D444" xlink:href="#MJX-174-STX-I-1D444"></use></g><g data-mml-node="mtext" data-latex="\textbf{\}}" transform="translate(11056.7,0)"><use data-c="7D" xlink:href="#MJX-174-STX-B-7D"></use></g></g></g></g></g></g></g></svg></mjx-container></div><p>Suppose we redefined Hoare triples in terms of a new &quot;bold&quot; kind of triple, with the new formula type on both sides.
Intuitively, the formula on the left describes a &quot;history&quot;, while the formula on the right describes the behavior of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.885ex" height="1.025ex" role="img" focusable="false" viewBox="0 -479 424 491" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-175-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="e"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-175-STX-I-1D452"></use></g></g></g></svg></mjx-container> on top of that history.</p>
<p>This is a specific case of this new kind of triple.
The more general case could have its semantics defined as follows.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.597ex;" xmlns="http://www.w3.org/2000/svg" width="48.237ex" height="2.237ex" role="img" focusable="false" viewBox="0 -785.9 23105.7 1071.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-176-STX-B-7B" d="M333-141C281-141 234-106 234-40C234 32 252 64 252 144C252 217 217 253 154 268L154 274C203 291 255 334 255 405C255 480 234 529 234 583C234 665 281 687 333 687L333 732C209 732 106 687 106 578C106 514 139 425 139 367C139 314 95 303 50 301L50 236C95 235 139 226 139 175C139 121 106 31 106-34C106-141 209-186 333-186Z"></path><path id="MJX-176-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-176-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-176-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-176-STX-N-A0" d=""></path><path id="MJX-176-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-176-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-176-STX-MI-70" d="M225-11C376-11 488 119 488 307C488 423 428 479 353 479C303 479 261 450 215 396L215 397L211 397L225 474L206 474L63 459L63 434C63 434 80 436 95 436C121 436 132 427 132 407C132 400 131 394 130 388L5-220L201-220L208-193C128-193 107-166 107-143C107-129 109-111 111-101L135 15C155 3 194-11 225-11M146 65L196 307C223 368 262 423 324 423C352 423 400 402 400 307C400 131 334 32 232 32C191 32 163 50 146 65Z"></path><path id="MJX-176-STX-B-7D" d="M45-186C169-186 272-141 272-34C272 31 239 121 239 175C239 226 283 235 328 236L328 301C283 303 239 314 239 367C239 425 272 514 272 578C272 687 169 732 45 732L45 687C97 687 144 665 144 583C144 529 123 480 123 405C123 334 175 291 224 274L224 268C161 253 126 217 126 144C126 64 144 32 144-40C144-106 97-141 45-141Z"></path><path id="MJX-176-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-176-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-176-STX-N-2261" d="M658 28L658 96L62 96L62 28M658 225L658 293L62 293L62 225M658 422L658 489L62 489L62 422Z"></path><path id="MJX-176-STX-N-2200" d="M571 678L498 678L423 474L150 474L75 678L2 678L253 0L320 0M400 412L286 105L173 412Z"></path><path id="MJX-176-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-176-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-176-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path><path id="MJX-176-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-176-STX-N-27E8" d="M299 736L262 736L40 280L40 260L262-196L299-196L112 270Z"></path><path id="MJX-176-STX-N-27E9" d="M227 270L40-196L77-196L299 260L299 280L77 736L40 736Z"></path><path id="MJX-176-STX-N-27F6" d="M1555 264C1457 305 1379 383 1313 460L1292 440C1315 406 1346 369 1376 341C1386 331 1390 324 1390 315C1390 305 1374 293 1364 293L56 293L56 225L1363 225C1381 225 1389 215 1389 205C1389 196 1384 185 1375 176C1344 144 1315 111 1291 78L1311 58C1379 136 1457 212 1555 254Z"></path><path id="MJX-176-STX-I-1D463" d="M200 476L53 465L53 437C53 437 83 440 99 440C117 440 123 426 123 409C123 389 116 365 113 354L93 278C82 236 71 183 71 135C71 58 100-9 200-9C380-9 479 206 479 358C479 429 448 479 403 479C382 479 365 464 365 437C365 393 426 369 426 299C426 206 368 55 231 55C170 55 153 99 153 151C153 196 166 249 175 284L222 476Z"></path><path id="MJX-176-STX-N-21D2" d="M826 264C702 358 571 445 451 564L429 543C454 515 480 486 506 460C520 444 529 438 529 418C529 409 520 395 502 395L0 395L0 327L649 327C683 308 710 283 710 259C710 234 683 213 650 190L0 190L0 123L502 123C520 123 529 108 529 100C529 84 522 75 505 57C494 46 454 3 429-26L451-46C571 72 700 159 826 254Z"></path><path id="MJX-176-STX-N-22A8" d="M646 203L646 270L143 270L143 407L646 407L646 475L143 475L143 678L75 678L75 0L143 0L143 203Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{align*}
\sb{\ens{\emp}}\ e\ \sb{\varphi} \equiv &amp; \ \forall s, s'. \langle s, e \rangle \longrightarrow \langle s', v \rangle \Rightarrow \langle s, s', v \rangle \vDash \varphi
\end{align*}
"><g data-mml-node="mtable" data-latex-item="{align*}" data-latex="\textbf{\{}\varphi\textbf{\}} \equiv &amp; \ \forall s, s'. \langle s, e \rangle \longrightarrow \langle s', v \rangle \Rightarrow \langle s, s', v \rangle \vDash \varphi
\end{align*}
"><g data-mml-node="mtr" transform="translate(0,-35.9)"><g data-mml-node="mtd"><g data-mml-node="mtext" data-latex="\textbf{\{}"><use data-c="7B" xlink:href="#MJX-176-STX-B-7B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(378,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-176-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-176-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-176-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1940,0)"><use data-c="A0" xlink:href="#MJX-176-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{emp}" data-mjx-texclass="ORD" transform="translate(2175,0)"><g data-mml-node="mi" data-latex="emp"><use data-c="65" xlink:href="#MJX-176-STX-MI-65"></use><use data-c="6D" xlink:href="#MJX-176-STX-MI-6D" transform="translate(412,0)"></use><use data-c="70" xlink:href="#MJX-176-STX-MI-70" transform="translate(1237,0)"></use></g></g><g data-mml-node="mtext" data-latex="\textbf{\}}" transform="translate(3933,0)"><use data-c="7D" xlink:href="#MJX-176-STX-B-7D"></use></g><g data-mml-node="mtext" transform="translate(4311,0)"><use data-c="A0" xlink:href="#MJX-176-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(4546,0)"><use data-c="1D452" xlink:href="#MJX-176-STX-I-1D452"></use></g><g data-mml-node="mtext" transform="translate(4970,0)"><use data-c="A0" xlink:href="#MJX-176-STX-N-A0"></use></g><g data-mml-node="mtext" data-latex="\textbf{\{}" transform="translate(5205,0)"><use data-c="7B" xlink:href="#MJX-176-STX-B-7B"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(5583,0)"><use data-c="1D711" xlink:href="#MJX-176-STX-I-1D711"></use></g><g data-mml-node="mtext" data-latex="\textbf{\}}" transform="translate(6190,0)"><use data-c="7D" xlink:href="#MJX-176-STX-B-7D"></use></g><g data-mml-node="mo" data-latex="\equiv" transform="translate(6845.8,0)"><use data-c="2261" xlink:href="#MJX-176-STX-N-2261"></use></g></g><g data-mml-node="mtd" transform="translate(7565.8,0)"><g data-mml-node="mstyle"><g data-mml-node="mtext"><use data-c="A0" xlink:href="#MJX-176-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\forall" transform="translate(235,0)"><use data-c="2200" xlink:href="#MJX-176-STX-N-2200"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(808,0)"><use data-c="1D460" xlink:href="#MJX-176-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex="," transform="translate(1194,0)"><use data-c="2C" xlink:href="#MJX-176-STX-N-2C"></use></g><g data-mml-node="msup" transform="translate(1605.7,0)"><g data-mml-node="mi" data-latex="s"><use data-c="1D460" xlink:href="#MJX-176-STX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(419,413) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-176-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex="." transform="translate(2320.7,0)"><use data-c="2E" xlink:href="#MJX-176-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="\langle" transform="translate(2732.4,0) translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-176-STX-N-27E8"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(3071.4,0)"><use data-c="1D460" xlink:href="#MJX-176-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3457.4,0)"><use data-c="2C" xlink:href="#MJX-176-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(3869.1,0)"><use data-c="1D452" xlink:href="#MJX-176-STX-I-1D452"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(4293.1,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-176-STX-N-27E9"></use></g><g data-mml-node="mo" data-latex="\longrightarrow" transform="translate(4909.9,0)"><use data-c="27F6" xlink:href="#MJX-176-STX-N-27F6"></use></g><g data-mml-node="mo" data-latex="\langle" transform="translate(6799.6,0) translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-176-STX-N-27E8"></use></g><g data-mml-node="msup" transform="translate(7138.6,0)"><g data-mml-node="mi" data-latex="s"><use data-c="1D460" xlink:href="#MJX-176-STX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(419,413) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-176-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(7853.7,0)"><use data-c="2C" xlink:href="#MJX-176-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="v" transform="translate(8265.4,0)"><use data-c="1D463" xlink:href="#MJX-176-STX-I-1D463"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(8769.4,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-176-STX-N-27E9"></use></g><g data-mml-node="mo" data-latex="\Rightarrow" transform="translate(9386.1,0)"><use data-c="21D2" xlink:href="#MJX-176-STX-N-21D2"></use></g><g data-mml-node="mo" data-latex="\langle" transform="translate(10550.9,0) translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-176-STX-N-27E8"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(10889.9,0)"><use data-c="1D460" xlink:href="#MJX-176-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex="," transform="translate(11275.9,0)"><use data-c="2C" xlink:href="#MJX-176-STX-N-2C"></use></g><g data-mml-node="msup" transform="translate(11687.6,0)"><g data-mml-node="mi" data-latex="s"><use data-c="1D460" xlink:href="#MJX-176-STX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(419,413) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-176-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(12402.7,0)"><use data-c="2C" xlink:href="#MJX-176-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="v" transform="translate(12814.3,0)"><use data-c="1D463" xlink:href="#MJX-176-STX-I-1D463"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(13318.3,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-176-STX-N-27E9"></use></g><g data-mml-node="mo" data-latex="\vDash" transform="translate(13935.1,0)"><use data-c="22A8" xlink:href="#MJX-176-STX-N-22A8"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(14932.9,0)"><use data-c="1D711" xlink:href="#MJX-176-STX-I-1D711"></use></g></g></g></g></g></g></g></svg></mjx-container></div><p>Now we can clearly see how this new kind of triple generalizes the standard one: where we previously had a precondition <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.213ex" height="1.372ex" role="img" focusable="false" viewBox="0 -657 581 657" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-177-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="P"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-177-STX-I-1D443"></use></g></g></g></svg></mjx-container> constraining the initial state <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="0.806ex" height="1.023ex" role="img" focusable="false" viewBox="0 -479 386 490" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-178-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="s"><g data-mml-node="mi" data-latex="s"><use data-c="1D460" xlink:href="#MJX-178-STX-I-1D460"></use></g></g></g></svg></mjx-container>, and a postcondition <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.361ex;" xmlns="http://www.w3.org/2000/svg" width="1.476ex" height="1.758ex" role="img" focusable="false" viewBox="0 -669 707 842" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-179-STX-I-1D444" d="M685 409C685 545 610 669 432 669C219 669 60 492 60 252C61 82 145 1 301-8L316-51C348-136 410-173 564-173L614-173L619-145C476-145 436-60 396 0L396 3C555 39 685 176 685 409M583 415C583 187 485 31 324 31C206 31 163 115 163 243C162 484 283 626 417 626C533 626 583 539 583 415Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Q"><g data-mml-node="mi" data-latex="Q"><use data-c="1D444" xlink:href="#MJX-179-STX-I-1D444"></use></g></g></g></svg></mjx-container> constraining the final state <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.493ex" height="1.634ex" role="img" focusable="false" viewBox="0 -771.7 715.1 782.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-180-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-180-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="s'"><g data-mml-node="msup" data-latex="s'"><g data-mml-node="mi" data-latex="s"><use data-c="1D460" xlink:href="#MJX-180-STX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(419,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-180-STX-V-2032"></use></g></g></g></g></svg></mjx-container> and result <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.019ex;" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.019ex" role="img" focusable="false" viewBox="0 -479 504 488" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-181-STX-I-1D463" d="M200 476L53 465L53 437C53 437 83 440 99 440C117 440 123 426 123 409C123 389 116 365 113 354L93 278C82 236 71 183 71 135C71 58 100-9 200-9C380-9 479 206 479 358C479 429 448 479 403 479C382 479 365 464 365 437C365 393 426 369 426 299C426 206 368 55 231 55C170 55 153 99 153 151C153 196 166 249 175 284L222 476Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="v"><g data-mml-node="mi" data-latex="v"><use data-c="1D463" xlink:href="#MJX-181-STX-I-1D463"></use></g></g></g></svg></mjx-container>, we now have a formula constraining the same three things, with the ability to have an arbitrary number of assertions.</p>
<p>To give a flavour of some reasoning rules, here is the standard separation logic rule for load/deference, followed by our new one.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -1.93ex;" xmlns="http://www.w3.org/2000/svg" width="31.202ex" height="3.341ex" role="img" focusable="false" viewBox="0 -676 14945.6 1600.5" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-182-STX-N-7B" d="M25 245C72 240 115 233 115 173C115 126 96 8 96-52C96-167 184-197 282-197L282-165C225-165 170-150 170-64C170-13 185 68 185 129C185 212 144 247 93 267L93 273C144 293 185 328 185 411C185 472 170 552 170 603C170 689 225 704 282 704L282 736C184 736 96 706 96 591C96 531 115 414 115 367C115 307 72 300 25 295Z"></path><path id="MJX-182-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-182-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-182-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-182-STX-N-7D" d="M302 295C255 300 212 307 212 367C212 414 231 531 231 591C231 706 143 736 45 736L45 704C102 704 157 689 157 603C157 552 142 472 142 411C142 328 183 293 234 273L234 267C183 247 142 212 142 129C142 68 157-13 157-64C157-150 102-165 45-165L45-197C143-197 231-167 231-52C231 8 212 126 212 173C212 233 255 240 302 245Z"></path><path id="MJX-182-STX-N-A0" d=""></path><path id="MJX-182-STX-N-21" d="M123 170L158 170L191 538C193 561 194 584 194 601C194 641 180 669 141 669C99 669 88 640 88 603C88 587 90 566 92 538M201 49C201 82 179 111 141 111C104 111 82 83 82 50C82 16 102-8 141-8C179-8 201 18 201 49Z"></path><path id="MJX-182-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-182-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-182-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-182-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-182-STX-N-53" d="M440 467L433 667L407 667C402 646 392 638 376 638C352 638 330 669 239 669C135 668 49 612 49 507C49 402 130 354 210 308C292 261 376 226 376 138C376 62 329 32 254 32C152 31 101 63 66 201L35 201L44-15L75-15C76 5 88 18 102 18C125 18 164-12 268-12C384-12 471 51 471 167C471 286 372 331 283 381C208 424 136 460 136 535C136 597 175 629 243 629C344 630 382 577 410 467Z"></path><path id="MJX-182-STX-N-4C" d="M568 195L536 195C497 79 481 42 347 42L301 42C242 42 225 51 225 95L225 529C225 607 242 627 323 627L323 657L42 657L42 627C122 627 133 607 133 530L133 123C133 45 122 30 42 30L42 0L538 0Z"></path><path id="MJX-182-STX-N-44" d="M35 657L35 627C110 627 133 616 133 543L133 124C133 43 123 30 35 30L35 0L321 0C537 0 680 102 680 332C680 576 518 657 310 657M225 614C244 616 258 616 274 616C481 616 575 513 575 323C575 98 466 38 284 38C264 38 245 39 225 41Z"></path><path id="MJX-182-STX-N-65" d="M415 143C383 101 352 65 271 65C191 65 115 128 115 266L431 266C426 406 354 485 245 485C128 485 34 405 34 238C34 77 127-10 247-10C350-10 398 53 434 129M114 303C122 396 162 445 230 445C301 445 334 377 337 303Z"></path><path id="MJX-182-STX-N-72" d="M183 482L159 482L35 452L35 424C35 424 46 426 66 426C102 426 102 408 102 372L102 97C102 41 95 29 29 29L29 0L279 0L279 29C204 29 185 39 185 102L185 330C209 370 241 412 264 412C276 412 296 378 329 378C351 378 373 394 373 432C373 466 354 488 315 488C267 488 237 453 186 379L183 379Z"></path><path id="MJX-182-STX-N-66" d="M26 468L26 426L102 426L102 119C102 41 91 29 18 29L18 0L287 0L287 29C204 29 185 41 185 119L185 426L307 426L307 468L185 468L185 562C185 646 196 676 233 676C283 676 288 600 338 600C361 600 379 614 379 643C379 688 332 713 267 713C197 713 161 686 134 640C108 594 102 549 102 468Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\frac{}{\s{x \mapsto y}\ !x\ \s{ r.\ x\mapsto y \wedge r =y }} {\scriptsize \text{SLDeref}}
"><g data-mml-node="mfrac" data-latex="\frac{}{\s{x \mapsto y}\ !x\ \s{ r.\ x\mapsto y \wedge r =y }}"><g data-mml-node="mrow" data-latex="" transform="translate(6270.9,676)"></g><g data-mml-node="mrow" data-latex="\{  r.\ x\mapsto y \wedge r =y  \}" transform="translate(220,-704.5)"><g data-mml-node="mo" data-latex="\{" transform="translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-182-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(327,0)"><use data-c="1D465" xlink:href="#MJX-182-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="\mapsto" transform="translate(1163.8,0)"><use data-c="21A6" xlink:href="#MJX-182-STX-N-21A6"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(2389.6,0)"><use data-c="1D466" xlink:href="#MJX-182-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="\}" transform="translate(2899.6,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-182-STX-N-7D"></use></g><g data-mml-node="mtext" transform="translate(3226.6,0)"><use data-c="A0" xlink:href="#MJX-182-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="!" transform="translate(3461.6,0)"><use data-c="21" xlink:href="#MJX-182-STX-N-21"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(3744.6,0)"><use data-c="1D465" xlink:href="#MJX-182-STX-I-1D465"></use></g><g data-mml-node="mtext" transform="translate(4303.6,0)"><use data-c="A0" xlink:href="#MJX-182-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="\{" transform="translate(4538.6,0) translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-182-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(4865.6,0)"><use data-c="1D45F" xlink:href="#MJX-182-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(5277.6,0)"><use data-c="2E" xlink:href="#MJX-182-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(5689.2,0)"><use data-c="A0" xlink:href="#MJX-182-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(5924.2,0)"><use data-c="1D465" xlink:href="#MJX-182-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="\mapsto" transform="translate(6761,0)"><use data-c="21A6" xlink:href="#MJX-182-STX-N-21A6"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7986.8,0)"><use data-c="1D466" xlink:href="#MJX-182-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(8719,0)"><use data-c="2227" xlink:href="#MJX-182-STX-N-2227"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(9577.2,0)"><use data-c="1D45F" xlink:href="#MJX-182-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(10267,0)"><use data-c="3D" xlink:href="#MJX-182-STX-N-3D"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(11264.8,0)"><use data-c="1D466" xlink:href="#MJX-182-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="\}" transform="translate(11774.8,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-182-STX-N-7D"></use></g></g><rect width="12301.8" height="68" x="120" y="216"></rect></g><g data-mml-node="TeXAtom" data-latex="{}" data-mjx-texclass="ORD" transform="translate(12541.8,0)"><g data-mml-node="mstyle" transform="scale(0.7)"><g data-mml-node="mtext" data-latex="\text{SLDeref}"><use data-c="53" xlink:href="#MJX-182-STX-N-53"></use><use data-c="4C" xlink:href="#MJX-182-STX-N-4C" transform="translate(504,0)"></use><use data-c="44" xlink:href="#MJX-182-STX-N-44" transform="translate(1089,0)"></use><use data-c="65" xlink:href="#MJX-182-STX-N-65" transform="translate(1819,0)"></use><use data-c="72" xlink:href="#MJX-182-STX-N-72" transform="translate(2283,0)"></use><use data-c="65" xlink:href="#MJX-182-STX-N-65" transform="translate(2663,0)"></use><use data-c="66" xlink:href="#MJX-182-STX-N-66" transform="translate(3127,0)"></use></g></g></g></g></g></svg></mjx-container></div><div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -1.962ex;" xmlns="http://www.w3.org/2000/svg" width="48.205ex" height="3.374ex" role="img" focusable="false" viewBox="0 -676 23090.2 1616" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-183-STX-B-7B" d="M333-141C281-141 234-106 234-40C234 32 252 64 252 144C252 217 217 253 154 268L154 274C203 291 255 334 255 405C255 480 234 529 234 583C234 665 281 687 333 687L333 732C209 732 106 687 106 578C106 514 139 425 139 367C139 314 95 303 50 301L50 236C95 235 139 226 139 175C139 121 106 31 106-34C106-141 209-186 333-186Z"></path><path id="MJX-183-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-183-STX-B-7D" d="M45-186C169-186 272-141 272-34C272 31 239 121 239 175C239 226 283 235 328 236L328 301C283 303 239 314 239 367C239 425 272 514 272 578C272 687 169 732 45 732L45 687C97 687 144 665 144 583C144 529 123 480 123 405C123 334 175 291 224 274L224 268C161 253 126 217 126 144C126 64 144 32 144-40C144-106 97-141 45-141Z"></path><path id="MJX-183-STX-N-A0" d=""></path><path id="MJX-183-STX-N-21" d="M123 170L158 170L191 538C193 561 194 584 194 601C194 641 180 669 141 669C99 669 88 640 88 603C88 587 90 566 92 538M201 49C201 82 179 111 141 111C104 111 82 83 82 50C82 16 102-8 141-8C179-8 201 18 201 49Z"></path><path id="MJX-183-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-183-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-183-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-183-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-183-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-183-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-183-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-183-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-183-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-183-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-183-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-183-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-183-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-183-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-183-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-183-STX-N-53" d="M440 467L433 667L407 667C402 646 392 638 376 638C352 638 330 669 239 669C135 668 49 612 49 507C49 402 130 354 210 308C292 261 376 226 376 138C376 62 329 32 254 32C152 31 101 63 66 201L35 201L44-15L75-15C76 5 88 18 102 18C125 18 164-12 268-12C384-12 471 51 471 167C471 286 372 331 283 381C208 424 136 460 136 535C136 597 175 629 243 629C344 630 382 577 410 467Z"></path><path id="MJX-183-STX-N-74" d="M293 90C268 62 255 49 223 49C184 49 175 73 175 144L175 426L288 426L288 468L175 468L176 610L150 610C114 525 84 478 37 449L37 426L92 426L92 116C92 26 121-10 188-10C252-10 273 20 312 74Z"></path><path id="MJX-183-STX-N-44" d="M35 657L35 627C110 627 133 616 133 543L133 124C133 43 123 30 35 30L35 0L321 0C537 0 680 102 680 332C680 576 518 657 310 657M225 614C244 616 258 616 274 616C481 616 575 513 575 323C575 98 466 38 284 38C264 38 245 39 225 41Z"></path><path id="MJX-183-STX-N-65" d="M415 143C383 101 352 65 271 65C191 65 115 128 115 266L431 266C426 406 354 485 245 485C128 485 34 405 34 238C34 77 127-10 247-10C350-10 398 53 434 129M114 303C122 396 162 445 230 445C301 445 334 377 337 303Z"></path><path id="MJX-183-STX-N-72" d="M183 482L159 482L35 452L35 424C35 424 46 426 66 426C102 426 102 408 102 372L102 97C102 41 95 29 29 29L29 0L279 0L279 29C204 29 185 39 185 102L185 330C209 370 241 412 264 412C276 412 296 378 329 378C351 378 373 394 373 432C373 466 354 488 315 488C267 488 237 453 186 379L183 379Z"></path><path id="MJX-183-STX-N-66" d="M26 468L26 426L102 426L102 119C102 41 91 29 18 29L18 0L287 0L287 29C204 29 185 41 185 119L185 426L307 426L307 468L185 468L185 562C185 646 196 676 233 676C283 676 288 600 338 600C361 600 379 614 379 643C379 688 332 713 267 713C197 713 161 686 134 640C108 594 102 549 102 468Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\frac{}{\sb{\varphi}\ !x\ \sb{\varphi; \exists y, r.\ \req{x\mapsto y}; \ens{r.\ x\mapsto y \wedge r=y} }} {\scriptsize \text{StDeref}}
"><g data-mml-node="mfrac" data-latex="\frac{}{\sb{\varphi}\ !x\ \sb{\varphi; \exists y, r.\ \req{x\mapsto y}; \ens{r.\ x\mapsto y \wedge r=y} }}"><g data-mml-node="mrow" data-latex="" transform="translate(10437.7,676)"></g><g data-mml-node="mrow" data-latex="\mathbf{ens}\ r.\ x\mapsto y \wedge r=y \textbf{\}}" transform="translate(220,-720)"><g data-mml-node="mtext" data-latex="\textbf{\{}"><use data-c="7B" xlink:href="#MJX-183-STX-B-7B"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(378,0)"><use data-c="1D711" xlink:href="#MJX-183-STX-I-1D711"></use></g><g data-mml-node="mtext" data-latex="\textbf{\}}" transform="translate(985,0)"><use data-c="7D" xlink:href="#MJX-183-STX-B-7D"></use></g><g data-mml-node="mtext" transform="translate(1363,0)"><use data-c="A0" xlink:href="#MJX-183-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="!" transform="translate(1598,0)"><use data-c="21" xlink:href="#MJX-183-STX-N-21"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(1881,0)"><use data-c="1D465" xlink:href="#MJX-183-STX-I-1D465"></use></g><g data-mml-node="mtext" transform="translate(2440,0)"><use data-c="A0" xlink:href="#MJX-183-STX-N-A0"></use></g><g data-mml-node="mtext" data-latex="\textbf{\{}" transform="translate(2675,0)"><use data-c="7B" xlink:href="#MJX-183-STX-B-7B"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(3053,0)"><use data-c="1D711" xlink:href="#MJX-183-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(3660,0)"><use data-c="3B" xlink:href="#MJX-183-STX-N-3B"></use></g><g data-mml-node="mi" data-latex="\exists" transform="translate(4071.7,0)"><use data-c="2203" xlink:href="#MJX-183-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4644.7,0)"><use data-c="1D466" xlink:href="#MJX-183-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(5154.7,0)"><use data-c="2C" xlink:href="#MJX-183-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5566.3,0)"><use data-c="1D45F" xlink:href="#MJX-183-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(5978.3,0)"><use data-c="2E" xlink:href="#MJX-183-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(6390,0)"><use data-c="A0" xlink:href="#MJX-183-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(6625,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-183-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-183-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-183-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(8132,0)"><use data-c="A0" xlink:href="#MJX-183-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(8367,0)"><use data-c="1D465" xlink:href="#MJX-183-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="\mapsto" transform="translate(9203.8,0)"><use data-c="21A6" xlink:href="#MJX-183-STX-N-21A6"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(10429.6,0)"><use data-c="1D466" xlink:href="#MJX-183-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(10939.6,0)"><use data-c="3B" xlink:href="#MJX-183-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(11351.2,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-183-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-183-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-183-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(12913.2,0)"><use data-c="A0" xlink:href="#MJX-183-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(13148.2,0)"><use data-c="1D45F" xlink:href="#MJX-183-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(13560.2,0)"><use data-c="2E" xlink:href="#MJX-183-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(13971.9,0)"><use data-c="A0" xlink:href="#MJX-183-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(14206.9,0)"><use data-c="1D465" xlink:href="#MJX-183-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="\mapsto" transform="translate(15043.7,0)"><use data-c="21A6" xlink:href="#MJX-183-STX-N-21A6"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(16269.4,0)"><use data-c="1D466" xlink:href="#MJX-183-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(17001.7,0)"><use data-c="2227" xlink:href="#MJX-183-STX-N-2227"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(17859.9,0)"><use data-c="1D45F" xlink:href="#MJX-183-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(18549.7,0)"><use data-c="3D" xlink:href="#MJX-183-STX-N-3D"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(19547.4,0)"><use data-c="1D466" xlink:href="#MJX-183-STX-I-1D466"></use></g><g data-mml-node="mtext" data-latex="\textbf{\}}" transform="translate(20057.4,0)"><use data-c="7D" xlink:href="#MJX-183-STX-B-7D"></use></g></g><rect width="20635.4" height="68" x="120" y="216"></rect></g><g data-mml-node="TeXAtom" data-latex="{}" data-mjx-texclass="ORD" transform="translate(20875.4,0)"><g data-mml-node="mstyle" transform="scale(0.7)"><g data-mml-node="mtext" data-latex="\text{StDeref}"><use data-c="53" xlink:href="#MJX-183-STX-N-53"></use><use data-c="74" xlink:href="#MJX-183-STX-N-74" transform="translate(504,0)"></use><use data-c="44" xlink:href="#MJX-183-STX-N-44" transform="translate(819,0)"></use><use data-c="65" xlink:href="#MJX-183-STX-N-65" transform="translate(1549,0)"></use><use data-c="72" xlink:href="#MJX-183-STX-N-72" transform="translate(2013,0)"></use><use data-c="65" xlink:href="#MJX-183-STX-N-65" transform="translate(2393,0)"></use><use data-c="66" xlink:href="#MJX-183-STX-N-66" transform="translate(2857,0)"></use></g></g></g></g></g></svg></mjx-container></div><!-- https://github.com/KaTeX/KaTeX/issues/471 -->
<p>It shouldn't be too surprising, as it mostly follows the schema we just presented.</p>
<p>The advantage of having the precondition on the right becomes clearer with the rule for function application, which is the first place where our new logic fundamentally differs.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -2.116ex;" xmlns="http://www.w3.org/2000/svg" width="40.668ex" height="5.276ex" role="img" focusable="false" viewBox="0 -1513.6 19480 2527.2" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-184-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-184-STX-N-2200" d="M571 678L498 678L423 474L150 474L75 678L2 678L253 0L320 0M400 412L286 105L173 412Z"></path><path id="MJX-184-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-184-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-184-STX-N-A0" d=""></path><path id="MJX-184-STX-N-7B" d="M25 245C72 240 115 233 115 173C115 126 96 8 96-52C96-167 184-197 282-197L282-165C225-165 170-150 170-64C170-13 185 68 185 129C185 212 144 247 93 267L93 273C144 293 185 328 185 411C185 472 170 552 170 603C170 689 225 704 282 704L282 736C184 736 96 706 96 591C96 531 115 414 115 367C115 307 72 300 25 295Z"></path><path id="MJX-184-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-184-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-184-STX-N-7D" d="M302 295C255 300 212 307 212 367C212 414 231 531 231 591C231 706 143 736 45 736L45 704C102 704 157 689 157 603C157 552 142 472 142 411C142 328 183 293 234 273L234 267C183 247 142 212 142 129C142 68 157-13 157-64C157-150 102-165 45-165L45-197C143-197 231-167 231-52C231 8 212 126 212 173C212 233 255 240 302 245Z"></path><path id="MJX-184-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-184-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-184-STX-I-1D444" d="M685 409C685 545 610 669 432 669C219 669 60 492 60 252C61 82 145 1 301-8L316-51C348-136 410-173 564-173L614-173L619-145C476-145 436-60 396 0L396 3C555 39 685 176 685 409M583 415C583 187 485 31 324 31C206 31 163 115 163 243C162 484 283 626 417 626C533 626 583 539 583 415Z"></path><path id="MJX-184-STX-N-22A2" d="M646 305L646 372L145 372L145 678L75 678L75 0L145 0L145 305Z"></path><path id="MJX-184-STX-N-5B" d="M299-196L299-164L169-164L169 704L299 704L299 736L90 736L90-196Z"></path><path id="MJX-184-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-184-STX-N-2F" d="M351 709L296 709L35-89L91-89Z"></path><path id="MJX-184-STX-N-5D" d="M259-196L259 736L50 736L50 704L180 704L180-164L50-164L50-196Z"></path><path id="MJX-184-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-184-STX-I-1D439" d="M607 494L634 657L118 657L112 627C193 627 204 613 190 544L101 116C86 42 62 30-7 30L-13 0L275 0L280 30C218 30 186 37 186 72C186 81 187 93 190 106L233 320L341 320C427 320 443 309 427 224L460 224L506 457L474 457C457 377 436 358 351 358L240 358L294 618L444 618C574 618 578 589 577 494Z"></path><path id="MJX-184-STX-N-53" d="M440 467L433 667L407 667C402 646 392 638 376 638C352 638 330 669 239 669C135 668 49 612 49 507C49 402 130 354 210 308C292 261 376 226 376 138C376 62 329 32 254 32C152 31 101 63 66 201L35 201L44-15L75-15C76 5 88 18 102 18C125 18 164-12 268-12C384-12 471 51 471 167C471 286 372 331 283 381C208 424 136 460 136 535C136 597 175 629 243 629C344 630 382 577 410 467Z"></path><path id="MJX-184-STX-N-4C" d="M568 195L536 195C497 79 481 42 347 42L301 42C242 42 225 51 225 95L225 529C225 607 242 627 323 627L323 657L42 657L42 627C122 627 133 607 133 530L133 123C133 45 122 30 42 30L42 0L538 0Z"></path><path id="MJX-184-STX-N-41" d="M714 0L714 30C660 30 640 53 611 119L374 662L333 662L121 160C73 46 59 30 3 30L3 0L213 0L213 30C166 30 146 36 146 64C146 82 151 97 157 113L202 219L458 219L497 129C510 99 514 81 514 67C514 32 475 30 445 30L445 0M443 259L217 259L330 539L333 539Z"></path><path id="MJX-184-STX-N-70" d="M176 482L151 482L25 454L25 425C25 425 44 427 57 427C90 427 95 414 95 376L95-119C95-175 85-192 22-192L22-220L275-220L275-191C197-191 178-178 178-113L178 18L182 18C211-2 245-10 283-10C403-10 502 91 502 261C502 392 433 485 334 485C275 485 227 454 179 398L176 398M178 356C197 381 240 417 293 417C367 417 411 359 411 233C411 94 358 29 288 29C232 29 197 74 178 95Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\frac{(\forall y.\ \s{P_f}\ f(y)\ \s{ r.\ Q_f }) \quad P \vdash P_f[x/y] * F}{\s{P}\ f(x)\ \s{ r.\ Q_f[x/y] * F } } {\scriptsize \text{SLApp}}
"><g data-mml-node="mfrac" data-latex="\frac{(\forall y.\ \s{P_f}\ f(y)\ \s{ r.\ Q_f }) \quad P \vdash P_f[x/y] * F}{\s{P}\ f(x)\ \s{ r.\ Q_f[x/y] * F } }"><g data-mml-node="mrow" data-latex="\{  r.\ Q_f  \}) \quad P \vdash P_f[x/y] * F" transform="translate(220,797.1)"><g data-mml-node="mo" data-latex="(" transform="translate(0 -20)"><use data-c="28" xlink:href="#MJX-184-STX-N-28"></use></g><g data-mml-node="mi" data-latex="\forall" transform="translate(357,0)"><use data-c="2200" xlink:href="#MJX-184-STX-N-2200"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(930,0)"><use data-c="1D466" xlink:href="#MJX-184-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1440,0)"><use data-c="2E" xlink:href="#MJX-184-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(1851.7,0)"><use data-c="A0" xlink:href="#MJX-184-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="\{" transform="translate(2086.7,0) translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-184-STX-N-7B"></use></g><g data-mml-node="msub" data-latex="P_f" transform="translate(2413.7,0)"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-184-STX-I-1D443"></use></g><g data-mml-node="mi" transform="translate(602,-150) scale(0.707)" data-latex="f"><use data-c="1D453" xlink:href="#MJX-184-STX-I-1D453"></use></g></g><g data-mml-node="mo" data-latex="\}" transform="translate(3473.7,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-184-STX-N-7D"></use></g><g data-mml-node="mtext" transform="translate(3800.7,0)"><use data-c="A0" xlink:href="#MJX-184-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(4035.7,0)"><use data-c="1D453" xlink:href="#MJX-184-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(4612.7,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-184-STX-N-28"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4969.7,0)"><use data-c="1D466" xlink:href="#MJX-184-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(5479.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-184-STX-N-29"></use></g><g data-mml-node="mtext" transform="translate(5836.7,0)"><use data-c="A0" xlink:href="#MJX-184-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="\{" transform="translate(6071.7,0) translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-184-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(6398.7,0)"><use data-c="1D45F" xlink:href="#MJX-184-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(6810.7,0)"><use data-c="2E" xlink:href="#MJX-184-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(7222.3,0)"><use data-c="A0" xlink:href="#MJX-184-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="Q_f" transform="translate(7457.3,0)"><g data-mml-node="mi" data-latex="Q"><use data-c="1D444" xlink:href="#MJX-184-STX-I-1D444"></use></g><g data-mml-node="mi" transform="translate(740,-150) scale(0.707)" data-latex="f"><use data-c="1D453" xlink:href="#MJX-184-STX-I-1D453"></use></g></g><g data-mml-node="mo" data-latex="\}" transform="translate(8655.3,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-184-STX-N-7D"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(8982.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-184-STX-N-29"></use></g><g data-mml-node="mspace" data-latex="\quad" transform="translate(9339.3,0)"></g><g data-mml-node="mi" data-latex="P" transform="translate(10339.3,0)"><use data-c="1D443" xlink:href="#MJX-184-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="\vdash" transform="translate(11198.1,0)"><use data-c="22A2" xlink:href="#MJX-184-STX-N-22A2"></use></g><g data-mml-node="msub" data-latex="P_f" transform="translate(12195.9,0)"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-184-STX-I-1D443"></use></g><g data-mml-node="mi" transform="translate(602,-150) scale(0.707)" data-latex="f"><use data-c="1D453" xlink:href="#MJX-184-STX-I-1D453"></use></g></g><g data-mml-node="mo" data-latex="[" transform="translate(13255.9,0) translate(0 -20)"><use data-c="5B" xlink:href="#MJX-184-STX-N-5B"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(13604.9,0)"><use data-c="1D465" xlink:href="#MJX-184-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(14163.9,0)"><g data-mml-node="mo" data-latex="/"><use data-c="2F" xlink:href="#MJX-184-STX-N-2F"></use></g></g><g data-mml-node="mi" data-latex="y" transform="translate(14549.9,0)"><use data-c="1D466" xlink:href="#MJX-184-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="]" transform="translate(15059.9,0) translate(0 -20)"><use data-c="5D" xlink:href="#MJX-184-STX-N-5D"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(15631.1,0)"><use data-c="2217" xlink:href="#MJX-184-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="F" transform="translate(16389.3,0)"><use data-c="1D439" xlink:href="#MJX-184-STX-I-1D439"></use></g></g><g data-mml-node="mrow" data-latex="\{  r.\ Q_f[x/y] * F  \} " transform="translate(3615.1,-704.5)"><g data-mml-node="mo" data-latex="\{" transform="translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-184-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(327,0)"><use data-c="1D443" xlink:href="#MJX-184-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="\}" transform="translate(908,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-184-STX-N-7D"></use></g><g data-mml-node="mtext" transform="translate(1235,0)"><use data-c="A0" xlink:href="#MJX-184-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(1470,0)"><use data-c="1D453" xlink:href="#MJX-184-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(2047,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-184-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(2404,0)"><use data-c="1D465" xlink:href="#MJX-184-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(2963,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-184-STX-N-29"></use></g><g data-mml-node="mtext" transform="translate(3320,0)"><use data-c="A0" xlink:href="#MJX-184-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="\{" transform="translate(3555,0) translate(0 -19.5)"><use data-c="7B" xlink:href="#MJX-184-STX-N-7B"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(3882,0)"><use data-c="1D45F" xlink:href="#MJX-184-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(4294,0)"><use data-c="2E" xlink:href="#MJX-184-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(4705.7,0)"><use data-c="A0" xlink:href="#MJX-184-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="Q_f" transform="translate(4940.7,0)"><g data-mml-node="mi" data-latex="Q"><use data-c="1D444" xlink:href="#MJX-184-STX-I-1D444"></use></g><g data-mml-node="mi" transform="translate(740,-150) scale(0.707)" data-latex="f"><use data-c="1D453" xlink:href="#MJX-184-STX-I-1D453"></use></g></g><g data-mml-node="mo" data-latex="[" transform="translate(6138.7,0) translate(0 -20)"><use data-c="5B" xlink:href="#MJX-184-STX-N-5B"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(6487.7,0)"><use data-c="1D465" xlink:href="#MJX-184-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(7046.7,0)"><g data-mml-node="mo" data-latex="/"><use data-c="2F" xlink:href="#MJX-184-STX-N-2F"></use></g></g><g data-mml-node="mi" data-latex="y" transform="translate(7432.7,0)"><use data-c="1D466" xlink:href="#MJX-184-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="]" transform="translate(7942.7,0) translate(0 -20)"><use data-c="5D" xlink:href="#MJX-184-STX-N-5D"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(8513.9,0)"><use data-c="2217" xlink:href="#MJX-184-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="F" transform="translate(9272.1,0)"><use data-c="1D439" xlink:href="#MJX-184-STX-I-1D439"></use></g><g data-mml-node="mo" data-latex="\}" transform="translate(9906.1,0) translate(0 -19.5)"><use data-c="7D" xlink:href="#MJX-184-STX-N-7D"></use></g></g><rect width="17223.3" height="68" x="120" y="216"></rect></g><g data-mml-node="TeXAtom" data-latex="{}" data-mjx-texclass="ORD" transform="translate(17463.3,0)"><g data-mml-node="mstyle" transform="scale(0.7)"><g data-mml-node="mtext" data-latex="\text{SLApp}"><use data-c="53" xlink:href="#MJX-184-STX-N-53"></use><use data-c="4C" xlink:href="#MJX-184-STX-N-4C" transform="translate(504,0)"></use><use data-c="41" xlink:href="#MJX-184-STX-N-41" transform="translate(1089,0)"></use><use data-c="70" xlink:href="#MJX-184-STX-N-70" transform="translate(1807,0)"></use><use data-c="70" xlink:href="#MJX-184-STX-N-70" transform="translate(2344,0)"></use></g></g></g></g></g></svg></mjx-container></div><div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -1.973ex;" xmlns="http://www.w3.org/2000/svg" width="25.116ex" height="3.384ex" role="img" focusable="false" viewBox="0 -676 12030.7 1621" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-185-STX-B-7B" d="M333-141C281-141 234-106 234-40C234 32 252 64 252 144C252 217 217 253 154 268L154 274C203 291 255 334 255 405C255 480 234 529 234 583C234 665 281 687 333 687L333 732C209 732 106 687 106 578C106 514 139 425 139 367C139 314 95 303 50 301L50 236C95 235 139 226 139 175C139 121 106 31 106-34C106-141 209-186 333-186Z"></path><path id="MJX-185-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-185-STX-B-7D" d="M45-186C169-186 272-141 272-34C272 31 239 121 239 175C239 226 283 235 328 236L328 301C283 303 239 314 239 367C239 425 272 514 272 578C272 687 169 732 45 732L45 687C97 687 144 665 144 583C144 529 123 480 123 405C123 334 175 291 224 274L224 268C161 253 126 217 126 144C126 64 144 32 144-40C144-106 97-141 45-141Z"></path><path id="MJX-185-STX-N-A0" d=""></path><path id="MJX-185-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-185-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-185-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-185-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-185-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-185-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-185-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-185-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-185-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-185-STX-N-53" d="M440 467L433 667L407 667C402 646 392 638 376 638C352 638 330 669 239 669C135 668 49 612 49 507C49 402 130 354 210 308C292 261 376 226 376 138C376 62 329 32 254 32C152 31 101 63 66 201L35 201L44-15L75-15C76 5 88 18 102 18C125 18 164-12 268-12C384-12 471 51 471 167C471 286 372 331 283 381C208 424 136 460 136 535C136 597 175 629 243 629C344 630 382 577 410 467Z"></path><path id="MJX-185-STX-N-74" d="M293 90C268 62 255 49 223 49C184 49 175 73 175 144L175 426L288 426L288 468L175 468L176 610L150 610C114 525 84 478 37 449L37 426L92 426L92 116C92 26 121-10 188-10C252-10 273 20 312 74Z"></path><path id="MJX-185-STX-N-41" d="M714 0L714 30C660 30 640 53 611 119L374 662L333 662L121 160C73 46 59 30 3 30L3 0L213 0L213 30C166 30 146 36 146 64C146 82 151 97 157 113L202 219L458 219L497 129C510 99 514 81 514 67C514 32 475 30 445 30L445 0M443 259L217 259L330 539L333 539Z"></path><path id="MJX-185-STX-N-70" d="M176 482L151 482L25 454L25 425C25 425 44 427 57 427C90 427 95 414 95 376L95-119C95-175 85-192 22-192L22-220L275-220L275-191C197-191 178-178 178-113L178 18L182 18C211-2 245-10 283-10C403-10 502 91 502 261C502 392 433 485 334 485C275 485 227 454 179 398L176 398M178 356C197 381 240 417 293 417C367 417 411 359 411 233C411 94 358 29 288 29C232 29 197 74 178 95Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\frac{}{\sb{ \varphi }\ f(x)\ \sb{ \varphi; \exists r.\ f(x,r) }} {\scriptsize \text{StApp}}
"><g data-mml-node="mfrac" data-latex="\frac{}{\sb{ \varphi }\ f(x)\ \sb{ \varphi; \exists r.\ f(x,r) }}"><g data-mml-node="mrow" data-latex="" transform="translate(5101.5,676)"></g><g data-mml-node="mrow" data-latex="\textbf{\{} \varphi; \exists r.\ f(x,r) \textbf{\}}" transform="translate(220,-720)"><g data-mml-node="mtext" data-latex="\textbf{\{}"><use data-c="7B" xlink:href="#MJX-185-STX-B-7B"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(378,0)"><use data-c="1D711" xlink:href="#MJX-185-STX-I-1D711"></use></g><g data-mml-node="mtext" data-latex="\textbf{\}}" transform="translate(985,0)"><use data-c="7D" xlink:href="#MJX-185-STX-B-7D"></use></g><g data-mml-node="mtext" transform="translate(1363,0)"><use data-c="A0" xlink:href="#MJX-185-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(1598,0)"><use data-c="1D453" xlink:href="#MJX-185-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(2175,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-185-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(2532,0)"><use data-c="1D465" xlink:href="#MJX-185-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(3091,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-185-STX-N-29"></use></g><g data-mml-node="mtext" transform="translate(3448,0)"><use data-c="A0" xlink:href="#MJX-185-STX-N-A0"></use></g><g data-mml-node="mtext" data-latex="\textbf{\{}" transform="translate(3683,0)"><use data-c="7B" xlink:href="#MJX-185-STX-B-7B"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(4061,0)"><use data-c="1D711" xlink:href="#MJX-185-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(4668,0)"><use data-c="3B" xlink:href="#MJX-185-STX-N-3B"></use></g><g data-mml-node="mi" data-latex="\exists" transform="translate(5079.7,0)"><use data-c="2203" xlink:href="#MJX-185-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5652.7,0)"><use data-c="1D45F" xlink:href="#MJX-185-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(6064.7,0)"><use data-c="2E" xlink:href="#MJX-185-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(6476.3,0)"><use data-c="A0" xlink:href="#MJX-185-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(6711.3,0)"><use data-c="1D453" xlink:href="#MJX-185-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(7288.3,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-185-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(7645.3,0)"><use data-c="1D465" xlink:href="#MJX-185-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(8204.3,0)"><use data-c="2C" xlink:href="#MJX-185-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(8616,0)"><use data-c="1D45F" xlink:href="#MJX-185-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(9028,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-185-STX-N-29"></use></g><g data-mml-node="mtext" data-latex="\textbf{\}}" transform="translate(9385,0)"><use data-c="7D" xlink:href="#MJX-185-STX-B-7D"></use></g></g><rect width="9963" height="68" x="120" y="216"></rect></g><g data-mml-node="TeXAtom" data-latex="{}" data-mjx-texclass="ORD" transform="translate(10203,0)"><g data-mml-node="mstyle" transform="scale(0.7)"><g data-mml-node="mtext" data-latex="\text{StApp}"><use data-c="53" xlink:href="#MJX-185-STX-N-53"></use><use data-c="74" xlink:href="#MJX-185-STX-N-74" transform="translate(504,0)"></use><use data-c="41" xlink:href="#MJX-185-STX-N-41" transform="translate(819,0)"></use><use data-c="70" xlink:href="#MJX-185-STX-N-70" transform="translate(1537,0)"></use><use data-c="70" xlink:href="#MJX-185-STX-N-70" transform="translate(2074,0)"></use></g></g></g></g></g></svg></mjx-container></div><p>First, we have the standard separation logic rule for function application. The key part is that some <em>knowledge</em> or <em>specification</em> of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-186-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-186-STX-I-1D453"></use></g></g></g></svg></mjx-container> is required to prove that it is safe to call in a state satisfying <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.213ex" height="1.372ex" role="img" focusable="false" viewBox="0 -657 581 657" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-187-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="P"><g data-mml-node="mi" data-latex="P"><use data-c="1D443" xlink:href="#MJX-187-STX-I-1D443"></use></g></g></g></svg></mjx-container>. Once this is done via the entailment on the right, a postcondition <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.645ex;" xmlns="http://www.w3.org/2000/svg" width="2.501ex" height="2.042ex" role="img" focusable="false" viewBox="0 -669 1198 978.1" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-188-STX-I-1D444" d="M685 409C685 545 610 669 432 669C219 669 60 492 60 252C61 82 145 1 301-8L316-51C348-136 410-173 564-173L614-173L619-145C476-145 436-60 396 0L396 3C555 39 685 176 685 409M583 415C583 187 485 31 324 31C206 31 163 115 163 243C162 484 283 626 417 626C533 626 583 539 583 415Z"></path><path id="MJX-188-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Q_f"><g data-mml-node="msub" data-latex="Q_f"><g data-mml-node="mi" data-latex="Q"><use data-c="1D444" xlink:href="#MJX-188-STX-I-1D444"></use></g><g data-mml-node="mi" transform="translate(740,-150) scale(0.707)" data-latex="f"><use data-c="1D453" xlink:href="#MJX-188-STX-I-1D453"></use></g></g></g></g></svg></mjx-container> (with appropriate substitutions) and frame <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.324ex" height="1.372ex" role="img" focusable="false" viewBox="0 -657 634 657" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-189-STX-I-1D439" d="M607 494L634 657L118 657L112 627C193 627 204 613 190 544L101 116C86 42 62 30-7 30L-13 0L275 0L280 30C218 30 186 37 186 72C186 81 187 93 190 106L233 320L341 320C427 320 443 309 427 224L460 224L506 457L474 457C457 377 436 358 351 358L240 358L294 618L444 618C574 618 578 589 577 494Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="F"><g data-mml-node="mi" data-latex="F"><use data-c="1D439" xlink:href="#MJX-189-STX-I-1D439"></use></g></g></g></svg></mjx-container> are produced, allowing us to continue.</p>
<p>On the other hand, the new rule requires no knowledge of the function being called, and can hence work even when <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-190-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-190-STX-I-1D453"></use></g></g></g></svg></mjx-container> is completely unknown, as is the case when it is a possibly effectful function parameter.
Placing the precondition on the right essentially allows us to defer checking it until a later.</p>
<p>We call this new language of formulae <em>staged logic</em>. It consists of the following ingredients.</p>
<ol>
<li>Sequencing and uninterpreted relations</li>
<li>Recursive formulae</li>
<li>Re-summarization of recursion (lemmas)</li>
<li>Compact sequences of pre/post stages using biabduction</li>
</ol>
<p>The insight is that these allow us to <em>defer abstraction</em> until appropriate.</p>
<p>We go over each in turn using examples, then present solutions to the clients we couldn't verify earlier before concluding.</p>
<h2 id="effectful-placeholders">Effectful placeholders</h2>
<p>Consider the following toy heap-manipulating program. <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.248ex" height="1.499ex" role="img" focusable="false" viewBox="0 -706 2035 718" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-191-STX-I-210E" d="M528 112C513 93 489 60 453 60C440 60 434 68 434 79C434 91 438 103 438 103L494 334C497 348 503 382 503 408C503 444 488 479 437 479C319 479 227 334 185 259L177 259L278 706L255 706L117 695L117 668C117 668 137 670 150 670C173 670 182 660 182 644C182 629 179 610 179 610L47 0L129 0L165 158C197 227 313 407 387 407C410 407 417 390 417 367C417 347 410 319 410 319L351 88C349 83 346 65 346 49C346 19 361-10 411-10C483-10 523 60 549 97Z"></path><path id="MJX-191-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-191-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path><path id="MJX-191-STX-I-1D45C" d="M460 297C460 416 378 479 293 479C136 479 26 330 26 175C26 77 73-10 189-10C348-10 460 129 460 297M369 307C369 133 299 25 200 25C134 25 117 93 117 166C117 345 199 445 285 445C345 445 369 381 369 307Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="hello"><g data-mml-node="mi" data-latex="h"><use data-c="210E" xlink:href="#MJX-191-STX-I-210E"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(569,0)"><use data-c="1D452" xlink:href="#MJX-191-STX-I-1D452"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(993,0)"><use data-c="1D459" xlink:href="#MJX-191-STX-I-1D459"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(1271,0)"><use data-c="1D459" xlink:href="#MJX-191-STX-I-1D459"></use></g><g data-mml-node="mi" data-latex="o" transform="translate(1549,0)"><use data-c="1D45C" xlink:href="#MJX-191-STX-I-1D45C"></use></g></g></g></svg></mjx-container> is an effectful higher-order function, as it calls an unknown function <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-192-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-192-STX-I-1D453"></use></g></g></g></svg></mjx-container>.</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> hello f x y <span class="token operator">=</span>
  x <span class="token operator">:=</span> <span class="token operator">!</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> r <span class="token operator">=</span> f y <span class="token keyword">in</span>
  <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token operator">!</span>x <span class="token operator">+</span> r <span class="token keyword">in</span>
  y <span class="token operator">:=</span> r2<span class="token punctuation">;</span>
  r2</code></pre>
<p>Here is a possible specification for it.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -6.628ex;" xmlns="http://www.w3.org/2000/svg" width="32ex" height="14.301ex" role="img" focusable="false" viewBox="0 -3675 15328.1 6850" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-193-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-193-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-193-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-193-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-193-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-193-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-193-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-193-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-193-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-193-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-193-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-193-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-193-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-193-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-193-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-193-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-193-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-193-STX-N-A0" d=""></path><path id="MJX-193-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-193-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-193-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-193-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-193-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-193-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-193-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-193-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-193-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-193-STX-I-1D44F" d="M198 402L257 705L235 705L97 694L97 668C97 668 116 670 127 670C147 670 163 663 163 641C163 629 160 610 159 606L46 25C95 0 146-12 204-12C382-12 483 140 483 304C483 424 421 479 342 479C289 479 246 450 203 402M184 316C205 363 249 423 313 423C358 423 395 390 395 300C395 148 338 30 219 30C177 30 148 54 135 66Z"></path><path id="MJX-193-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-193-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-193-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-193-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-193-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{l}
\m{hello}(f, x, y, res) = \\
\quad \exists a.\ \req{x{\mapsto}a}; \ens{x{\mapsto}a{+}1} \\
\quad \exists r.\ f(y, r); \\
\quad \exists b.\ \req{x{\mapsto}b * y{\mapsto}\_}; \\
\quad \phantom{\exists b.\ } \ens{x{\mapsto}b * y{\mapsto}\m{res}{\wedge}\m{res}{=}b{+}r} \\
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res}{=}b{+}r \\
\end{array}
"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,2800)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-193-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-193-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-193-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-193-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-193-STX-MI-6F" transform="translate(1507,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(1992,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-193-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2349,0)"><use data-c="1D453" xlink:href="#MJX-193-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2926,0)"><use data-c="2C" xlink:href="#MJX-193-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(3337.7,0)"><use data-c="1D465" xlink:href="#MJX-193-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3896.7,0)"><use data-c="2C" xlink:href="#MJX-193-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4308.3,0)"><use data-c="1D466" xlink:href="#MJX-193-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4818.3,0)"><use data-c="2C" xlink:href="#MJX-193-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5230,0)"><use data-c="1D45F" xlink:href="#MJX-193-STX-I-1D45F"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(5642,0)"><use data-c="1D452" xlink:href="#MJX-193-STX-I-1D452"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(6066,0)"><use data-c="1D460" xlink:href="#MJX-193-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(6452,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-193-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(7086.8,0)"><use data-c="3D" xlink:href="#MJX-193-STX-N-3D"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-193-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(1573,0)"><use data-c="1D44E" xlink:href="#MJX-193-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2128,0)"><use data-c="2E" xlink:href="#MJX-193-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2539.7,0)"><use data-c="A0" xlink:href="#MJX-193-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2774.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-193-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-193-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-193-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4281.7,0)"><use data-c="A0" xlink:href="#MJX-193-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4516.7,0)"><use data-c="1D465" xlink:href="#MJX-193-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5075.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-193-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(6023.7,0)"><use data-c="1D44E" xlink:href="#MJX-193-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(6578.7,0)"><use data-c="3B" xlink:href="#MJX-193-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(6990.3,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-193-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-193-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-193-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(8552.3,0)"><use data-c="A0" xlink:href="#MJX-193-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(8787.3,0)"><use data-c="1D465" xlink:href="#MJX-193-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(9346.3,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-193-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(10294.3,0)"><use data-c="1D44E" xlink:href="#MJX-193-STX-I-1D44E"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(10849.3,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-193-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(11569.3,0)"><use data-c="31" xlink:href="#MJX-193-STX-N-31"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,0)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-193-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(1573,0)"><use data-c="1D45F" xlink:href="#MJX-193-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1985,0)"><use data-c="2E" xlink:href="#MJX-193-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2396.7,0)"><use data-c="A0" xlink:href="#MJX-193-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2631.7,0)"><use data-c="1D453" xlink:href="#MJX-193-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(3208.7,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-193-STX-N-28"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(3565.7,0)"><use data-c="1D466" xlink:href="#MJX-193-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4075.7,0)"><use data-c="2C" xlink:href="#MJX-193-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(4487.3,0)"><use data-c="1D45F" xlink:href="#MJX-193-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(4899.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-193-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(5256.3,0)"><use data-c="3B" xlink:href="#MJX-193-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-193-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="b" transform="translate(1573,0)"><use data-c="1D44F" xlink:href="#MJX-193-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2091,0)"><use data-c="2E" xlink:href="#MJX-193-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2502.7,0)"><use data-c="A0" xlink:href="#MJX-193-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-193-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-193-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-193-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4244.7,0)"><use data-c="A0" xlink:href="#MJX-193-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4479.7,0)"><use data-c="1D465" xlink:href="#MJX-193-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5038.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-193-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(5986.7,0)"><use data-c="1D44F" xlink:href="#MJX-193-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6726.9,0)"><use data-c="2217" xlink:href="#MJX-193-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7485.1,0)"><use data-c="1D466" xlink:href="#MJX-193-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(7995.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-193-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="\_" transform="translate(8943.1,0)"><use data-c="5F" xlink:href="#MJX-193-STX-N-5F"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(9455.1,0)"><use data-c="3B" xlink:href="#MJX-193-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-2800)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="TeXAtom" data-latex="\phantom{\exists b.\ }" data-mjx-texclass="ORD" transform="translate(1000,0)"><g data-mml-node="mphantom"></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-193-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-193-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-193-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4299.7,0)"><use data-c="A0" xlink:href="#MJX-193-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4534.7,0)"><use data-c="1D465" xlink:href="#MJX-193-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5093.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-193-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(6041.7,0)"><use data-c="1D44F" xlink:href="#MJX-193-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6781.9,0)"><use data-c="2217" xlink:href="#MJX-193-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7540.1,0)"><use data-c="1D466" xlink:href="#MJX-193-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(8050.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-193-STX-N-21A6"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(8998.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-193-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-193-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-193-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(10160.1,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-193-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(10796.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-193-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-193-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-193-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(11958.1,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-193-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(12678.1,0)"><use data-c="1D44F" xlink:href="#MJX-193-STX-I-1D44F"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(13196.1,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-193-STX-N-2B"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(13916.1,0)"><use data-c="1D45F" xlink:href="#MJX-193-STX-I-1D45F"></use></g></g></g></g></g></g></svg></mjx-container></div><p>Sequencing and uninterpreted relations together allow us to leave placeholders for unknown function parameters, to represent their effects.</p>
<p>Stateful behavior is otherwise <em>compacted</em> into a single <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="3.146ex" height="1.478ex" role="img" focusable="false" viewBox="0 -488 1507 708" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-194-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-194-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-194-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\textbf{req}"><g data-mml-node="mtext" data-latex="\textbf{req}"><use data-c="1D42B" xlink:href="#MJX-194-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-194-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-194-STX-B-1D42A" transform="translate(933,0)"></use></g></g></g></svg></mjx-container>/<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.261ex" height="1.038ex" role="img" focusable="false" viewBox="0 -485 1562 497" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-195-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-195-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-195-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\textbf{ens}"><g data-mml-node="mtext" data-latex="\textbf{ens}"><use data-c="1D41E" xlink:href="#MJX-195-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-195-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-195-STX-B-1D42C" transform="translate(1134,0)"></use></g></g></g></svg></mjx-container> pair.</p>
<!-- $f$ may be seen as *stratifying* the behavior of $\m{hello}$ into two *stages* under [compaction](#compaction-via-biabduction), hence the name "staged formulae", in allusion to *staged programming*. -->
<p>One might wonder why we must require the presence of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="1.021ex" role="img" focusable="false" viewBox="0 -479 559 489" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-196-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-196-STX-I-1D465"></use></g></g></g></svg></mjx-container> and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="1.065ex" height="1.466ex" role="img" focusable="false" viewBox="0 -482 510 702" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-197-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="y"><g data-mml-node="mi" data-latex="y"><use data-c="1D466" xlink:href="#MJX-197-STX-I-1D466"></use></g></g></g></svg></mjx-container> after the call to <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-198-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-198-STX-I-1D453"></use></g></g></g></svg></mjx-container>.
For <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="1.065ex" height="1.466ex" role="img" focusable="false" viewBox="0 -482 510 702" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-199-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="y"><g data-mml-node="mi" data-latex="y"><use data-c="1D466" xlink:href="#MJX-199-STX-I-1D466"></use></g></g></g></svg></mjx-container>, this is easy, as it is passed as an argument to <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-200-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-200-STX-I-1D453"></use></g></g></g></svg></mjx-container>, and we have to require that it is not, e.g., deallocated.
Interestingly, we also cannot assume anything about <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="1.021ex" role="img" focusable="false" viewBox="0 -479 559 489" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-201-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-201-STX-I-1D465"></use></g></g></g></svg></mjx-container> after the call to <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-202-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-202-STX-I-1D453"></use></g></g></g></svg></mjx-container>. As <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-203-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-203-STX-I-1D453"></use></g></g></g></svg></mjx-container> is unknown and arbitrary, it is possible that it may capture <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="1.021ex" role="img" focusable="false" viewBox="0 -479 559 489" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-204-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-204-STX-I-1D465"></use></g></g></g></svg></mjx-container> and cause it to have a potentially different value after, <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.081ex" height="1.497ex" role="img" focusable="false" viewBox="0 -705 518 717" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-205-STX-I-1D44F" d="M198 402L257 705L235 705L97 694L97 668C97 668 116 670 127 670C147 670 163 663 163 641C163 629 160 610 159 606L46 25C95 0 146-12 204-12C382-12 483 140 483 304C483 424 421 479 342 479C289 479 246 450 203 402M184 316C205 363 249 423 313 423C358 423 395 390 395 300C395 148 338 30 219 30C177 30 148 54 135 66Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="b"><g data-mml-node="mi" data-latex="b"><use data-c="1D44F" xlink:href="#MJX-205-STX-I-1D44F"></use></g></g></g></svg></mjx-container>.</p>
<p>Another detail is that this specification assumes that <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="1.167ex" height="1.021ex" role="img" focusable="false" viewBox="0 -479 559 489" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-206-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="x"><g data-mml-node="mi" data-latex="x"><use data-c="1D465" xlink:href="#MJX-206-STX-I-1D465"></use></g></g></g></svg></mjx-container> and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="1.065ex" height="1.466ex" role="img" focusable="false" viewBox="0 -482 510 702" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-207-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="y"><g data-mml-node="mi" data-latex="y"><use data-c="1D466" xlink:href="#MJX-207-STX-I-1D466"></use></g></g></g></svg></mjx-container> are not aliased. Details on how to relax this assumption are in the paper<sup class="footnote-ref"><a href="#fn2" id="fnref2:1">2</a></sup>.</p>
<!--

Sequencing of multiple effectful functions can be represented directly.

```ocaml
let compose f g x = f (g x)
```

$$
\m{compose}(f, g, x, \m{res}) = \exists r.\ g(x, r); f(r, \m{res})
$$

-->
<h2 id="recursion">Recursion</h2>
<p>Recursive programs are naturally represented by recursive specifications.</p>
<!-- under a least fixed point interpretation -->
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr f a l <span class="token operator">=</span>
  <span class="token keyword">match</span> l <span class="token keyword">with</span>
  <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=></span> a
  <span class="token operator">|</span> h <span class="token punctuation">::</span> t <span class="token operator">=></span>
    f h <span class="token punctuation">(</span>foldr f a t<span class="token punctuation">)</span></code></pre>
<p>here is a staged logic specification for it:</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -3.706ex;" xmlns="http://www.w3.org/2000/svg" width="44.804ex" height="8.455ex" role="img" focusable="false" viewBox="0 -2275 21461.1 4050" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-208-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-208-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-208-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-208-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-208-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-208-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-208-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-208-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-208-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-208-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path><path id="MJX-208-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-208-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-208-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-208-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-208-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-208-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-208-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-208-STX-N-A0" d=""></path><path id="MJX-208-STX-N-5B" d="M299-196L299-164L169-164L169 704L299 704L299 736L90 736L90-196Z"></path><path id="MJX-208-STX-N-5D" d="M259-196L259 736L50 736L50 704L180 704L180-164L50-164L50-196Z"></path><path id="MJX-208-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-208-STX-N-2228" d="M604 549L531 549L319 106L105 549L32 549L314-30L324-30Z"></path><path id="MJX-208-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-208-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-208-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-208-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-208-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-208-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-208-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{l}
\foldr(f, a, l, \m{res}) = \\
\quad \phantom{\vee\ } \ens{l{=}[]{\wedge}\m{res}{=}a} \\
\quad \vee\ \exists r, l_1.\ \ens{l{=}x{::}l_1}; \foldr(f, a, l_1, r); f(x, r, \m{res})
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res})
\end{array}
"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-208-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-208-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-208-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-208-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-208-STX-MI-72" transform="translate(1590,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(2006,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-208-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2363,0)"><use data-c="1D453" xlink:href="#MJX-208-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2940,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(3351.7,0)"><use data-c="1D44E" xlink:href="#MJX-208-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3906.7,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(4318.3,0)"><use data-c="1D459" xlink:href="#MJX-208-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4596.3,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(5008,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-208-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-208-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-208-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(6170,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-208-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(6804.8,0)"><use data-c="3D" xlink:href="#MJX-208-STX-N-3D"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="TeXAtom" data-latex="\phantom{\vee\ }" data-mjx-texclass="ORD" transform="translate(1000,0)"><g data-mml-node="mphantom"></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(1871,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-208-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-208-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-208-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(3433,0)"><use data-c="A0" xlink:href="#MJX-208-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(3668,0)"><use data-c="1D459" xlink:href="#MJX-208-STX-I-1D459"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(3946,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-208-STX-N-3D"></use></g></g><g data-mml-node="mo" data-latex="[" transform="translate(4666,0) translate(0 -20)"><use data-c="5B" xlink:href="#MJX-208-STX-N-5B"></use></g><g data-mml-node="mo" data-latex="]" transform="translate(5015,0) translate(0 -20)"><use data-c="5D" xlink:href="#MJX-208-STX-N-5D"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(5364,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-208-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(6000,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-208-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-208-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-208-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(7162,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-208-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(7882,0)"><use data-c="1D44E" xlink:href="#MJX-208-STX-I-1D44E"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mo" data-latex="\vee" transform="translate(1000,0)"><use data-c="2228" xlink:href="#MJX-208-STX-N-2228"></use></g><g data-mml-node="mtext" transform="translate(1636,0)"><use data-c="A0" xlink:href="#MJX-208-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1871,0)"><use data-c="2203" xlink:href="#MJX-208-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(2444,0)"><use data-c="1D45F" xlink:href="#MJX-208-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2856,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="msub" data-latex="l_1" transform="translate(3267.7,0)"><g data-mml-node="mi" data-latex="l"><use data-c="1D459" xlink:href="#MJX-208-STX-I-1D459"></use></g><g data-mml-node="mn" transform="translate(311,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-208-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex="." transform="translate(3978.7,0)"><use data-c="2E" xlink:href="#MJX-208-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(4390.4,0)"><use data-c="A0" xlink:href="#MJX-208-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(4625.4,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-208-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-208-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-208-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(6187.4,0)"><use data-c="A0" xlink:href="#MJX-208-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(6422.4,0)"><use data-c="1D459" xlink:href="#MJX-208-STX-I-1D459"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(6700.4,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-208-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="x" transform="translate(7420.4,0)"><use data-c="1D465" xlink:href="#MJX-208-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{::}" data-mjx-texclass="ORD" transform="translate(7979.4,0)"><g data-mml-node="mo" data-latex="::"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-208-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-208-STX-N-3A"></use></g></g></g><g data-mml-node="msub" data-latex="l_1" transform="translate(8469.4,0)"><g data-mml-node="mi" data-latex="l"><use data-c="1D459" xlink:href="#MJX-208-STX-I-1D459"></use></g><g data-mml-node="mn" transform="translate(311,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-208-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(9180.4,0)"><use data-c="3B" xlink:href="#MJX-208-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD" transform="translate(9592,0)"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-208-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-208-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-208-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-208-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-208-STX-MI-72" transform="translate(1590,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(11598,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-208-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(11955,0)"><use data-c="1D453" xlink:href="#MJX-208-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(12532,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(12943.7,0)"><use data-c="1D44E" xlink:href="#MJX-208-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(13498.7,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="msub" data-latex="l_1" transform="translate(13910.4,0)"><g data-mml-node="mi" data-latex="l"><use data-c="1D459" xlink:href="#MJX-208-STX-I-1D459"></use></g><g data-mml-node="mn" transform="translate(311,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-208-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(14621.4,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(15033.1,0)"><use data-c="1D45F" xlink:href="#MJX-208-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(15445.1,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-208-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(15802.1,0)"><use data-c="3B" xlink:href="#MJX-208-STX-N-3B"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(16213.7,0)"><use data-c="1D453" xlink:href="#MJX-208-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(16790.7,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-208-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(17147.7,0)"><use data-c="1D465" xlink:href="#MJX-208-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(17706.7,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(18118.4,0)"><use data-c="1D45F" xlink:href="#MJX-208-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="," transform="translate(18530.4,0)"><use data-c="2C" xlink:href="#MJX-208-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(18942.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-208-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-208-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-208-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(20104.1,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-208-STX-N-29"></use></g></g></g></g></g></g></svg></mjx-container></div><p>Most importantly, the call to <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-209-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-209-STX-I-1D453"></use></g></g></g></svg></mjx-container> can be represented directly, without abstraction.</p>
<p>This specification looks very much like the program, because there is no state that could benefit from being expressed with separation logic.
However, it is still an abstraction of the program.</p>
<p>Comparing this to the previous specification, this time expressed as a single <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="3.146ex" height="1.478ex" role="img" focusable="false" viewBox="0 -488 1507 708" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-210-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-210-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-210-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{req}"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-210-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-210-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-210-STX-B-1D42A" transform="translate(933,0)"></use></g></g></g></g></svg></mjx-container>/<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.261ex" height="1.038ex" role="img" focusable="false" viewBox="0 -485 1562 497" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-211-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-211-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-211-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{ens}"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-211-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-211-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-211-STX-B-1D42C" transform="translate(1134,0)"></use></g></g></g></g></svg></mjx-container> pair in staged logic,</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -5.19ex;" xmlns="http://www.w3.org/2000/svg" width="57.902ex" height="11.423ex" role="img" focusable="false" viewBox="0 -2985.9 27735.1 5471.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-212-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-212-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-212-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-212-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-212-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-212-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-212-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-212-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-212-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-212-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path><path id="MJX-212-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-212-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-212-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-212-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-212-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-212-STX-I-1D443" d="M122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0L269 0L275 30C194 30 176 41 193 123L228 294C239 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657M293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 236 331Z"></path><path id="MJX-212-STX-MI-49" d="M260 0L266 30C185 30 176 40 193 127L275 525C290 603 300 627 389 627L395 657L118 657L112 627C203 627 203 603 186 525L104 131C86 43 74 30-7 30L-13 0Z"></path><path id="MJX-212-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-212-STX-MI-76" d="M160-8C295 76 417 218 417 385C417 424 403 479 353 479C329 479 308 465 308 435C308 388 358 385 358 324C358 232 279 126 185 50L183 50L185 85C181 210 171 349 156 477L132 477L1 461L1 430C14 432 23 433 33 433C66 433 74 421 79 374C96 244 105 143 111-8Z"></path><path id="MJX-212-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-212-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-212-STX-N-A0" d=""></path><path id="MJX-212-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-212-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-212-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-212-STX-MI-4C" d="M481 0L541 195L509 195C447 79 426 38 299 38L252 38C193 38 178 48 187 92L278 540C293 612 325 627 397 627L402 657L118 657L112 627C198 627 203 607 189 541L103 124C86 44 70 30-7 30L-13 0Z"></path><path id="MJX-212-STX-MI-69" d="M115-9C181-9 220 47 255 96L235 111C219 93 191 59 157 59C145 59 139 65 139 78C139 92 144 120 144 120L219 476L197 476L57 465L57 438C57 438 74 440 91 440C118 440 123 424 123 411C123 394 120 380 120 380L69 142C56 83 52 61 52 44C52 9 75-9 115-9M188 556C218 556 243 576 243 610C243 643 224 665 191 665C158 665 136 644 136 610C136 575 158 556 188 556Z"></path><path id="MJX-212-STX-MI-74" d="M115-9C194-9 236 65 265 104L245 119C210 74 189 59 160 59C146 59 143 69 143 80C143 97 150 130 150 130L211 428L310 428L318 467L219 467L245 593L215 593C165 506 140 482 76 449L72 428L129 428L61 101C59 91 54 61 54 44C54 13 73-9 115-9Z"></path><path id="MJX-212-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-212-STX-N-5B" d="M299-196L299-164L169-164L169 704L299 704L299 736L90 736L90-196Z"></path><path id="MJX-212-STX-N-5D" d="M259-196L259 736L50 736L50 704L180 704L180-164L50-164L50-196Z"></path><path id="MJX-212-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-212-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-212-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-212-STX-V-2032" d="M80 28C142 144 270 399 292 457C297 470 302 494 302 506C302 556 269 578 232 578C201 578 171 567 154 515C136 455 71 167 45 41Z"></path><path id="MJX-212-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-212-STX-N-2291" d="M646 52L646 120L143 120L143 554L646 554L646 621L75 621L75 52M646-106L646-38L75-38L75-106Z"></path><path id="MJX-212-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-212-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-212-STX-MI-79" d="M2-220C69-220 126-139 234 15C244 29 348 175 398 268C429 325 441 365 441 401C441 457 411 482 377 482C349 482 334 464 334 442C334 403 383 383 383 346C383 330 374 303 350 264L235 79L229 79L220 179L198 325C186 405 179 437 157 475L142 475L8 464L8 435C17 436 26 437 35 437C94 437 100 393 108 343L165-9C137-51 57-163 35-163C19-163 4-109-37-109C-59-109-76-124-76-152C-76-193-38-220 2-220Z"></path><path id="MJX-212-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-212-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-212-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-212-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{l}
\foldr(f, a, l, \m{res}) = \\
\quad \exists P, \inv, \xs.\ \req{\m{List}(l, \xs) * \inv([], a) \wedge \m{all}(P, \xs)} \\
\qquad \wedge f(x, a', r) \sqsubseteq (\exists ys.\ \req{\inv(\ys, a') \wedge P(x)}; \ens{\inv(x{::}\ys, r)}); \\
\quad \ens{\m{List}(l, \xs) * \inv(\xs, \m{res})}
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res})
\end{array}
"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,2110.9)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-212-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-212-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-212-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-212-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-212-STX-MI-72" transform="translate(1590,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(2006,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2363,0)"><use data-c="1D453" xlink:href="#MJX-212-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2940,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(3351.7,0)"><use data-c="1D44E" xlink:href="#MJX-212-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3906.7,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(4318.3,0)"><use data-c="1D459" xlink:href="#MJX-212-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4596.3,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(5008,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-212-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-212-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(6170,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(6804.8,0)"><use data-c="3D" xlink:href="#MJX-212-STX-N-3D"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,710.9)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-212-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(1573,0)"><use data-c="1D443" xlink:href="#MJX-212-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2154,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD" transform="translate(2565.7,0)"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-212-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-212-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-212-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(3901.7,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(4313.3,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-212-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex="." transform="translate(5133.3,0)"><use data-c="2E" xlink:href="#MJX-212-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(5545,0)"><use data-c="A0" xlink:href="#MJX-212-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(5780,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-212-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-212-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-212-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(7287,0)"><use data-c="A0" xlink:href="#MJX-212-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{List}" data-mjx-texclass="ORD" transform="translate(7522,0)"><g data-mml-node="mi" data-latex="List"><use data-c="4C" xlink:href="#MJX-212-STX-MI-4C"></use><use data-c="69" xlink:href="#MJX-212-STX-MI-69" transform="translate(569,0)"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(848,0)"></use><use data-c="74" xlink:href="#MJX-212-STX-MI-74" transform="translate(1215,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(9055,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(9412,0)"><use data-c="1D459" xlink:href="#MJX-212-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(9690,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(10101.7,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-212-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(10921.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(11500.9,0)"><use data-c="2217" xlink:href="#MJX-212-STX-N-2217"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD" transform="translate(12259.1,0)"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-212-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-212-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-212-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(13595.1,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mo" data-latex="[" transform="translate(13952.1,0) translate(0 -20)"><use data-c="5B" xlink:href="#MJX-212-STX-N-5B"></use></g><g data-mml-node="mo" data-latex="]" transform="translate(14301.1,0) translate(0 -20)"><use data-c="5D" xlink:href="#MJX-212-STX-N-5D"></use></g><g data-mml-node="mo" data-latex="," transform="translate(14650.1,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(15061.8,0)"><use data-c="1D44E" xlink:href="#MJX-212-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(15616.8,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(16196,0)"><use data-c="2227" xlink:href="#MJX-212-STX-N-2227"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{all}" data-mjx-texclass="ORD" transform="translate(17054.2,0)"><g data-mml-node="mi" data-latex="all"><use data-c="61" xlink:href="#MJX-212-STX-MI-61"></use><use data-c="6C" xlink:href="#MJX-212-STX-MI-6C" transform="translate(534,0)"></use><use data-c="6C" xlink:href="#MJX-212-STX-MI-6C" transform="translate(807,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(18134.2,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(18491.2,0)"><use data-c="1D443" xlink:href="#MJX-212-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="," transform="translate(19072.2,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(19483.9,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-212-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(20303.9,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-710.9)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\qquad"></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(2000,0)"><use data-c="2227" xlink:href="#MJX-212-STX-N-2227"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2636,0)"><use data-c="1D453" xlink:href="#MJX-212-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(3213,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(3570,0)"><use data-c="1D465" xlink:href="#MJX-212-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4129,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="msup" transform="translate(4540.7,0)"><g data-mml-node="mi" data-latex="a"><use data-c="1D44E" xlink:href="#MJX-212-STX-I-1D44E"></use></g><g data-mml-node="mo" transform="translate(588,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-212-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(5424.7,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5836.4,0)"><use data-c="1D45F" xlink:href="#MJX-212-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(6248.4,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\sqsubseteq" transform="translate(6883.2,0)"><use data-c="2291" xlink:href="#MJX-212-STX-N-2291"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(7881,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mi" data-latex="\exists" transform="translate(8238,0)"><use data-c="2203" xlink:href="#MJX-212-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(8811,0)"><use data-c="1D466" xlink:href="#MJX-212-STX-I-1D466"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(9321,0)"><use data-c="1D460" xlink:href="#MJX-212-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex="." transform="translate(9707,0)"><use data-c="2E" xlink:href="#MJX-212-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(10118.6,0)"><use data-c="A0" xlink:href="#MJX-212-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(10353.6,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-212-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-212-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-212-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(11860.6,0)"><use data-c="A0" xlink:href="#MJX-212-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD" transform="translate(12095.6,0)"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-212-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-212-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-212-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(13431.6,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(13788.6,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-212-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(446,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(14601.6,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="msup" transform="translate(15013.3,0)"><g data-mml-node="mi" data-latex="a"><use data-c="1D44E" xlink:href="#MJX-212-STX-I-1D44E"></use></g><g data-mml-node="mo" transform="translate(588,363) scale(0.707)" data-latex="'"><use data-c="2032" xlink:href="#MJX-212-STX-V-2032"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(15897.4,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(16476.6,0)"><use data-c="2227" xlink:href="#MJX-212-STX-N-2227"></use></g><g data-mml-node="mi" data-latex="P" transform="translate(17334.8,0)"><use data-c="1D443" xlink:href="#MJX-212-STX-I-1D443"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(17915.8,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(18272.8,0)"><use data-c="1D465" xlink:href="#MJX-212-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(18831.8,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(19188.8,0)"><use data-c="3B" xlink:href="#MJX-212-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(19600.5,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-212-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-212-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-212-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(21162.5,0)"><use data-c="A0" xlink:href="#MJX-212-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD" transform="translate(21397.5,0)"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-212-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-212-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-212-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(22733.5,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(23090.5,0)"><use data-c="1D465" xlink:href="#MJX-212-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{::}" data-mjx-texclass="ORD" transform="translate(23649.5,0)"><g data-mml-node="mo" data-latex="::"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-212-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-212-STX-N-3A"></use></g></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(24139.5,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-212-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(446,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(24952.5,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(25364.1,0)"><use data-c="1D45F" xlink:href="#MJX-212-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(25776.1,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(26133.1,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(26490.1,0)"><use data-c="3B" xlink:href="#MJX-212-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-2110.9)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(1000,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-212-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-212-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-212-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(2562,0)"><use data-c="A0" xlink:href="#MJX-212-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{List}" data-mjx-texclass="ORD" transform="translate(2797,0)"><g data-mml-node="mi" data-latex="List"><use data-c="4C" xlink:href="#MJX-212-STX-MI-4C"></use><use data-c="69" xlink:href="#MJX-212-STX-MI-69" transform="translate(569,0)"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(848,0)"></use><use data-c="74" xlink:href="#MJX-212-STX-MI-74" transform="translate(1215,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(4330,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(4687,0)"><use data-c="1D459" xlink:href="#MJX-212-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4965,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(5376.7,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-212-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(6196.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6775.9,0)"><use data-c="2217" xlink:href="#MJX-212-STX-N-2217"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{Inv}" data-mjx-texclass="ORD" transform="translate(7534.1,0)"><g data-mml-node="mi" data-latex="Inv"><use data-c="49" xlink:href="#MJX-212-STX-MI-49"></use><use data-c="6E" xlink:href="#MJX-212-STX-MI-6E" transform="translate(343,0)"></use><use data-c="76" xlink:href="#MJX-212-STX-MI-76" transform="translate(907,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(8870.1,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-212-STX-N-28"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(9227.1,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-212-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(10047.1,0)"><use data-c="2C" xlink:href="#MJX-212-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(10458.8,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-212-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-212-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-212-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(11620.8,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-212-STX-N-29"></use></g></g></g></g></g></g></svg></mjx-container></div><p>we see that it is longer and more complex, and contains all kinds of paramterization to make up for the inability to speak simply about ordering.
Leaving the recursion in the specification <em>before</em> we are aware of what clients expect (and thus, what kind of abstraction is appropriate) is what allows staged specifications to be more precise.</p>
<!-- not precise when it comes to concurrency due to summary of stateful behavior, which may no longer be atomic -->
<h2 id="re-summarization">Re-summarization</h2>
<p>We previously saw function calls represented without any abstraction in specifications, which probably wouldn't work well in large programs.
We would hence like to recover abstraction at some appropriate time.
That time tends to be at calls;
given a use of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-213-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-213-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-213-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-213-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-213-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-213-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-213-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-213-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-213-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-213-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> such as the following, which passes a closure as an argument,</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr_sum_state x xs init <span class="token operator">=</span>
  <span class="token keyword">let</span> g c t <span class="token operator">=</span> x <span class="token operator">:=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> c <span class="token operator">+</span> t <span class="token keyword">in</span>
  foldr g xs init</code></pre>
<p>and a user-provided specification (below), we can verify the above program by proving the following entailment.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -2.244ex;" xmlns="http://www.w3.org/2000/svg" width="49.735ex" height="5.532ex" role="img" focusable="false" viewBox="0 -1575 23823 2650" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-214-STX-N-2200" d="M571 678L498 678L423 474L150 474L75 678L2 678L253 0L320 0M400 412L286 105L173 412Z"></path><path id="MJX-214-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-214-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-214-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-214-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-214-STX-MI-69" d="M115-9C181-9 220 47 255 96L235 111C219 93 191 59 157 59C145 59 139 65 139 78C139 92 144 120 144 120L219 476L197 476L57 465L57 438C57 438 74 440 91 440C118 440 123 424 123 411C123 394 120 380 120 380L69 142C56 83 52 61 52 44C52 9 75-9 115-9M188 556C218 556 243 576 243 610C243 643 224 665 191 665C158 665 136 644 136 610C136 575 158 556 188 556Z"></path><path id="MJX-214-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-214-STX-MI-74" d="M115-9C194-9 236 65 265 104L245 119C210 74 189 59 160 59C146 59 143 69 143 80C143 97 150 130 150 130L211 428L310 428L318 467L219 467L245 593L215 593C165 506 140 482 76 449L72 428L129 428L61 101C59 91 54 61 54 44C54 13 73-9 115-9Z"></path><path id="MJX-214-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-214-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-214-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-214-STX-N-A0" d=""></path><path id="MJX-214-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-214-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-214-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-214-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-214-STX-MI-5F" d="M432-128L443-77L-69-77L-80-128Z"></path><path id="MJX-214-STX-MI-75" d="M123-10C240-10 311 127 352 197L361 197C344 132 329 92 329 45C329 1 362-9 389-9C450-9 487 32 531 96L510 111C510 111 473 59 437 59C421 59 416 68 416 76C416 91 422 119 422 119L496 473L413 473L381 332C360 241 249 62 175 62C153 62 145 79 145 103C145 121 152 151 152 151L221 476L190 476L55 465L55 438C66 439 75 440 89 440C106 440 125 434 125 413C125 394 115 350 115 350L67 135C64 121 57 88 57 62C57 25 72-10 123-10Z"></path><path id="MJX-214-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-214-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-214-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-214-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-214-STX-N-2291" d="M646 52L646 120L143 120L143 554L646 554L646 621L75 621L75 52M646-106L646-38L75-38L75-106Z"></path><path id="MJX-214-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-214-STX-I-1D456" d="M219 476L197 476L57 465L57 438C57 438 74 440 91 440C118 440 123 424 123 411C123 394 120 380 120 380L69 142C56 83 52 61 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 191 59 157 59C145 59 139 65 139 78C139 92 144 120 144 120M243 610C243 643 224 665 191 665C158 665 136 644 136 610C136 575 158 556 188 556C218 556 243 576 243 610Z"></path><path id="MJX-214-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-214-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-214-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-214-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-214-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-214-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-214-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-214-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-214-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-214-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-214-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{rl}
&amp; \forall x, \xs, \m{init}, \res.\ \m{foldr\_sum\_state}(x, \xs, \m{init}, \res) \\
\sqsubseteq &amp; \exists i,r.\ \req{x{\mapsto}i}; \ens{x{\mapsto}i{+}r{\wedge}\res{=}r{+}\m{init}{\wedge}r{=}\m{sum}(\xs)}
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{xs})
\end{array}
"><g data-mml-node="mtr" data-latex-item="{rl}" data-latex="{rl}" transform="translate(0,700)"><g data-mml-node="mtd" transform="translate(1220,0)"></g><g data-mml-node="mtd" transform="translate(2220,0)"><g data-mml-node="mi" data-latex="\forall"><use data-c="2200" xlink:href="#MJX-214-STX-N-2200"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(573,0)"><use data-c="1D465" xlink:href="#MJX-214-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(1132,0)"><use data-c="2C" xlink:href="#MJX-214-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(1543.7,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-214-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-214-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(2363.7,0)"><use data-c="2C" xlink:href="#MJX-214-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{init}" data-mjx-texclass="ORD" transform="translate(2775.3,0)"><g data-mml-node="mi" data-latex="init"><use data-c="69" xlink:href="#MJX-214-STX-MI-69"></use><use data-c="6E" xlink:href="#MJX-214-STX-MI-6E" transform="translate(279,0)"></use><use data-c="69" xlink:href="#MJX-214-STX-MI-69" transform="translate(843,0)"></use><use data-c="74" xlink:href="#MJX-214-STX-MI-74" transform="translate(1122,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(4215.3,0)"><use data-c="2C" xlink:href="#MJX-214-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(4627,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-214-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-214-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-214-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex="." transform="translate(5789,0)"><use data-c="2E" xlink:href="#MJX-214-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(6200.7,0)"><use data-c="A0" xlink:href="#MJX-214-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{foldr\_sum\_state}" data-mjx-texclass="ORD" transform="translate(6435.7,0)"><g data-mml-node="mi" data-latex="oldr"><use data-c="66" xlink:href="#MJX-214-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-214-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-214-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-214-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-214-STX-MI-72" transform="translate(1590,0)"></use></g><g data-mml-node="mi" data-latex="\_" transform="translate(1973,0)"><use data-c="5F" xlink:href="#MJX-214-STX-MI-5F"></use></g><g data-mml-node="mi" data-latex="um" transform="translate(2485,0)"><use data-c="73" xlink:href="#MJX-214-STX-MI-73"></use><use data-c="75" xlink:href="#MJX-214-STX-MI-75" transform="translate(367,0)"></use><use data-c="6D" xlink:href="#MJX-214-STX-MI-6D" transform="translate(924,0)"></use></g><g data-mml-node="mi" data-latex="\_" transform="translate(4234,0)"><use data-c="5F" xlink:href="#MJX-214-STX-MI-5F"></use></g><g data-mml-node="mi" data-latex="tate" transform="translate(4746,0)"><use data-c="73" xlink:href="#MJX-214-STX-MI-73"></use><use data-c="74" xlink:href="#MJX-214-STX-MI-74" transform="translate(367,0)"></use><use data-c="61" xlink:href="#MJX-214-STX-MI-61" transform="translate(665,0)"></use><use data-c="74" xlink:href="#MJX-214-STX-MI-74" transform="translate(1199,0)"></use><use data-c="65" xlink:href="#MJX-214-STX-MI-65" transform="translate(1497,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(13090.7,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-214-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(13447.7,0)"><use data-c="1D465" xlink:href="#MJX-214-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(14006.7,0)"><use data-c="2C" xlink:href="#MJX-214-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(14418.3,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-214-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-214-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(15238.3,0)"><use data-c="2C" xlink:href="#MJX-214-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{init}" data-mjx-texclass="ORD" transform="translate(15650,0)"><g data-mml-node="mi" data-latex="init"><use data-c="69" xlink:href="#MJX-214-STX-MI-69"></use><use data-c="6E" xlink:href="#MJX-214-STX-MI-6E" transform="translate(279,0)"></use><use data-c="69" xlink:href="#MJX-214-STX-MI-69" transform="translate(843,0)"></use><use data-c="74" xlink:href="#MJX-214-STX-MI-74" transform="translate(1122,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(17090,0)"><use data-c="2C" xlink:href="#MJX-214-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(17501.7,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-214-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-214-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-214-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(18663.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-214-STX-N-29"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{rl}" data-latex="{rl}" transform="translate(0,-700)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mo" data-latex="\sqsubseteq"><use data-c="2291" xlink:href="#MJX-214-STX-N-2291"></use></g></g><g data-mml-node="mtd" transform="translate(2220,0)"><g data-mml-node="mi" data-latex="\exists"><use data-c="2203" xlink:href="#MJX-214-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="i" transform="translate(573,0)"><use data-c="1D456" xlink:href="#MJX-214-STX-I-1D456"></use></g><g data-mml-node="mo" data-latex="," transform="translate(847,0)"><use data-c="2C" xlink:href="#MJX-214-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(1258.7,0)"><use data-c="1D45F" xlink:href="#MJX-214-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1670.7,0)"><use data-c="2E" xlink:href="#MJX-214-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2082.3,0)"><use data-c="A0" xlink:href="#MJX-214-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2317.3,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-214-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-214-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-214-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(3824.3,0)"><use data-c="A0" xlink:href="#MJX-214-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4059.3,0)"><use data-c="1D465" xlink:href="#MJX-214-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(4618.3,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-214-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="i" transform="translate(5566.3,0)"><use data-c="1D456" xlink:href="#MJX-214-STX-I-1D456"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(5840.3,0)"><use data-c="3B" xlink:href="#MJX-214-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(6252,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-214-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-214-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-214-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(7814,0)"><use data-c="A0" xlink:href="#MJX-214-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(8049,0)"><use data-c="1D465" xlink:href="#MJX-214-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(8608,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-214-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="i" transform="translate(9556,0)"><use data-c="1D456" xlink:href="#MJX-214-STX-I-1D456"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(9830,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-214-STX-N-2B"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(10550,0)"><use data-c="1D45F" xlink:href="#MJX-214-STX-I-1D45F"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(10962,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-214-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(11598,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-214-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-214-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-214-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(12760,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-214-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(13480,0)"><use data-c="1D45F" xlink:href="#MJX-214-STX-I-1D45F"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(13892,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-214-STX-N-2B"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{init}" data-mjx-texclass="ORD" transform="translate(14612,0)"><g data-mml-node="mi" data-latex="init"><use data-c="69" xlink:href="#MJX-214-STX-MI-69"></use><use data-c="6E" xlink:href="#MJX-214-STX-MI-6E" transform="translate(279,0)"></use><use data-c="69" xlink:href="#MJX-214-STX-MI-69" transform="translate(843,0)"></use><use data-c="74" xlink:href="#MJX-214-STX-MI-74" transform="translate(1122,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(16052,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-214-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(16688,0)"><use data-c="1D45F" xlink:href="#MJX-214-STX-I-1D45F"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(17100,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-214-STX-N-3D"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{sum}" data-mjx-texclass="ORD" transform="translate(17820,0)"><g data-mml-node="mi" data-latex="sum"><use data-c="73" xlink:href="#MJX-214-STX-MI-73"></use><use data-c="75" xlink:href="#MJX-214-STX-MI-75" transform="translate(367,0)"></use><use data-c="6D" xlink:href="#MJX-214-STX-MI-6D" transform="translate(924,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(19569,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-214-STX-N-28"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(19926,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-214-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-214-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(20746,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-214-STX-N-29"></use></g></g></g></g></g></g></svg></mjx-container></div><p>This may also be seen as a means of <em>recovering abstraction</em>,
or <em>re-summarizing</em> the relatively low-level staged specification,
to get rid of recursion and explicit occurrences of unknown functions
and produce a simpler, non-recursive summary of its behavior.</p>
<p>This example also demonstrates the utility of staged logic,
which allows us to very plainly state the effectful behavior of the program,
and also <em>prove the entailment automatically</em>.</p>
<p>In the paper<sup class="footnote-ref"><a href="#fn2" id="fnref2:2">2</a></sup>, we define a set of syntactic proof rules for reducing <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.221ex;" xmlns="http://www.w3.org/2000/svg" width="1.503ex" height="1.518ex" role="img" focusable="false" viewBox="0 -621 720 727" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-215-STX-N-2291" d="M646 52L646 120L143 120L143 554L646 554L646 621L75 621L75 52M646-106L646-38L75-38L75-106Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\sqsubseteq"><g data-mml-node="mo" data-latex="\sqsubseteq"><use data-c="2291" xlink:href="#MJX-215-STX-N-2291"></use></g></g></g></svg></mjx-container>-entailments (modulo <em>compaction</em>) into separation logic proof obligations,
which can be discharged using an off-the-shelf SL prover and SMT.
This particular proof uses an inferred (or provided, in general) induction hypothesis.</p>
<h2 id="compaction-via-biabduction">Compaction via biabduction</h2>
<p>The final piece is <em>compaction</em>, which allows us to have the expressiveness of stages, but also the <em>succinctness</em> of triples when the extra expressiveness is not needed.
In short, it allows any staged formula to always be transformed into the following normal form.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.967ex;" xmlns="http://www.w3.org/2000/svg" width="41.813ex" height="3.119ex" role="img" focusable="false" viewBox="0 -1030.9 20028.3 1493.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-216-STX-LO-28" d="M54 270C54-57 178-315 354-443L373-418C212-263 143-25 143 270C143 565 212 803 373 958L354 983C178 855 54 597 54 270Z"></path><path id="MJX-216-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-216-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-216-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-216-STX-N-A0" d=""></path><path id="MJX-216-STX-I-1D70E" d="M568 473C533 472 489 469 443 469C395 469 345 472 300 472C139 472 41 350 41 165C41 92 68-14 194-14C337-14 442 87 443 246C444 310 412 361 399 381C398 382 398 383 397 384L397 388C423 387 437 387 460 387C536 387 563 429 570 459M359 390C375 355 387 319 387 268C387 115 292 69 208 69C143 69 89 105 90 192C90 331 190 391 286 391C310 391 335 390 359 390Z"></path><path id="MJX-216-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-216-STX-I-1D70B" d="M625 473C571 469 513 467 451 467C380 468 324 472 252 472C157 472 90 442 48 354L70 339C113 391 135 392 242 392C218 307 189 249 137 169C88 93 76 77 31 14L31 0L126 0C167 68 258 285 281 391C330 391 375 389 424 388C383 277 326 154 326 68C326 26 343-9 391-9C452-9 494 20 527 69L514 86C497 73 479 61 444 61C412 61 405 94 405 121C405 197 452 339 468 387C493 386 507 386 522 386C589 386 622 436 627 461Z"></path><path id="MJX-216-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-216-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-216-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-216-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-216-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-216-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-216-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-216-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-216-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-216-STX-LO-29" d="M350 270C350 597 226 855 50 983L31 958C192 803 261 565 261 270C261-25 192-263 31-418L50-443C226-315 350-57 350 270Z"></path><path id="MJX-216-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\big(\req{\sigma{\wedge}\pi}; \ens{\sigma{\wedge}\pi}; f(x, r); \big)^* \req{\sigma{\wedge}\pi}; \ens{\sigma{\wedge}\pi}
"><g data-mml-node="TeXAtom" data-latex="\big(" data-mjx-texclass="ORD"><g data-mml-node="mo" transform="translate(0 -20)"><use data-c="28" xlink:href="#MJX-216-STX-LO-28"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(404,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-216-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-216-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-216-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1911,0)"><use data-c="A0" xlink:href="#MJX-216-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(2146,0)"><use data-c="1D70E" xlink:href="#MJX-216-STX-I-1D70E"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(2716,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-216-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="\pi" transform="translate(3352,0)"><use data-c="1D70B" xlink:href="#MJX-216-STX-I-1D70B"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(3986,0)"><use data-c="3B" xlink:href="#MJX-216-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(4397.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-216-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-216-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-216-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(5959.7,0)"><use data-c="A0" xlink:href="#MJX-216-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(6194.7,0)"><use data-c="1D70E" xlink:href="#MJX-216-STX-I-1D70E"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(6764.7,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-216-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="\pi" transform="translate(7400.7,0)"><use data-c="1D70B" xlink:href="#MJX-216-STX-I-1D70B"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(8034.7,0)"><use data-c="3B" xlink:href="#MJX-216-STX-N-3B"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(8446.3,0)"><use data-c="1D453" xlink:href="#MJX-216-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(9023.3,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-216-STX-N-28"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(9380.3,0)"><use data-c="1D465" xlink:href="#MJX-216-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(9939.3,0)"><use data-c="2C" xlink:href="#MJX-216-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(10351,0)"><use data-c="1D45F" xlink:href="#MJX-216-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(10763,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-216-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(11120,0)"><use data-c="3B" xlink:href="#MJX-216-STX-N-3B"></use></g><g data-mml-node="msup" data-latex="\big)^*" transform="translate(11531.7,0)"><g data-mml-node="TeXAtom" data-latex="\big)" data-mjx-texclass="ORD"><g data-mml-node="mo" transform="translate(0 -20)"><use data-c="29" xlink:href="#MJX-216-STX-LO-29"></use></g></g><g data-mml-node="mo" transform="translate(437,690.1) scale(0.707)" data-latex="*"><use data-c="2217" xlink:href="#MJX-216-STX-N-2217"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(12397.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-216-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-216-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-216-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(13904.7,0)"><use data-c="A0" xlink:href="#MJX-216-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(14139.7,0)"><use data-c="1D70E" xlink:href="#MJX-216-STX-I-1D70E"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(14709.7,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-216-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="\pi" transform="translate(15345.7,0)"><use data-c="1D70B" xlink:href="#MJX-216-STX-I-1D70B"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(15979.7,0)"><use data-c="3B" xlink:href="#MJX-216-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(16391.3,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-216-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-216-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-216-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(17953.3,0)"><use data-c="A0" xlink:href="#MJX-216-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(18188.3,0)"><use data-c="1D70E" xlink:href="#MJX-216-STX-I-1D70E"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(18758.3,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-216-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="\pi" transform="translate(19394.3,0)"><use data-c="1D70B" xlink:href="#MJX-216-STX-I-1D70B"></use></g></g></g></svg></mjx-container></div><p>Compaction can be seen as a normalization procedure for (programs represented as) staged formulae.
This is key not only for entailment proofs, but for automation:
in our prototype, users only need to provide essential lemmas, and all other intermediate specifications are derived mechanically.
In this way, compaction functions as a means of specification inference in a verification setting.</p>
<p>We'll illustrate it by example on the heap-manipulating <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.159ex" height="1.497ex" role="img" focusable="false" viewBox="0 -705 1992 717" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-217-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-217-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-217-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-217-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{hello}"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-217-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-217-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-217-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-217-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-217-STX-MI-6F" transform="translate(1507,0)"></use></g></g></g></g></svg></mjx-container> program we saw earlier.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -6.628ex;" xmlns="http://www.w3.org/2000/svg" width="32ex" height="14.301ex" role="img" focusable="false" viewBox="0 -3675 15328.1 6850" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-218-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-218-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-218-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-218-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-218-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-218-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-218-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-218-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-218-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-218-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-218-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-218-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-218-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-218-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-218-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-218-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-218-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-218-STX-N-A0" d=""></path><path id="MJX-218-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-218-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-218-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-218-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-218-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-218-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-218-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-218-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-218-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-218-STX-I-1D44F" d="M198 402L257 705L235 705L97 694L97 668C97 668 116 670 127 670C147 670 163 663 163 641C163 629 160 610 159 606L46 25C95 0 146-12 204-12C382-12 483 140 483 304C483 424 421 479 342 479C289 479 246 450 203 402M184 316C205 363 249 423 313 423C358 423 395 390 395 300C395 148 338 30 219 30C177 30 148 54 135 66Z"></path><path id="MJX-218-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-218-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-218-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-218-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-218-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{l}
\m{hello}(f, x, y, res) = \\
\quad \exists a.\ \req{x{\mapsto}a}; \ens{x{\mapsto}a{+}1} \\
\quad \exists r.\ f(y, r); \\
\quad \exists b.\ \req{x{\mapsto}b * y{\mapsto}\_}; \\
\quad \phantom{\exists b.\ } \ens{x{\mapsto}b * y{\mapsto}\m{res}{\wedge}\m{res}{=}b{+}r} \\
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res}{=}b{+}r \\
\end{array}
"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,2800)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-218-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-218-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-218-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-218-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-218-STX-MI-6F" transform="translate(1507,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(1992,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-218-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2349,0)"><use data-c="1D453" xlink:href="#MJX-218-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2926,0)"><use data-c="2C" xlink:href="#MJX-218-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(3337.7,0)"><use data-c="1D465" xlink:href="#MJX-218-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3896.7,0)"><use data-c="2C" xlink:href="#MJX-218-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4308.3,0)"><use data-c="1D466" xlink:href="#MJX-218-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4818.3,0)"><use data-c="2C" xlink:href="#MJX-218-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5230,0)"><use data-c="1D45F" xlink:href="#MJX-218-STX-I-1D45F"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(5642,0)"><use data-c="1D452" xlink:href="#MJX-218-STX-I-1D452"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(6066,0)"><use data-c="1D460" xlink:href="#MJX-218-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(6452,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-218-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(7086.8,0)"><use data-c="3D" xlink:href="#MJX-218-STX-N-3D"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-218-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(1573,0)"><use data-c="1D44E" xlink:href="#MJX-218-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2128,0)"><use data-c="2E" xlink:href="#MJX-218-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2539.7,0)"><use data-c="A0" xlink:href="#MJX-218-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2774.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-218-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-218-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-218-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4281.7,0)"><use data-c="A0" xlink:href="#MJX-218-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4516.7,0)"><use data-c="1D465" xlink:href="#MJX-218-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5075.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-218-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(6023.7,0)"><use data-c="1D44E" xlink:href="#MJX-218-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(6578.7,0)"><use data-c="3B" xlink:href="#MJX-218-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(6990.3,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-218-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-218-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-218-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(8552.3,0)"><use data-c="A0" xlink:href="#MJX-218-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(8787.3,0)"><use data-c="1D465" xlink:href="#MJX-218-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(9346.3,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-218-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(10294.3,0)"><use data-c="1D44E" xlink:href="#MJX-218-STX-I-1D44E"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(10849.3,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-218-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(11569.3,0)"><use data-c="31" xlink:href="#MJX-218-STX-N-31"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,0)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-218-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(1573,0)"><use data-c="1D45F" xlink:href="#MJX-218-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1985,0)"><use data-c="2E" xlink:href="#MJX-218-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2396.7,0)"><use data-c="A0" xlink:href="#MJX-218-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2631.7,0)"><use data-c="1D453" xlink:href="#MJX-218-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(3208.7,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-218-STX-N-28"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(3565.7,0)"><use data-c="1D466" xlink:href="#MJX-218-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4075.7,0)"><use data-c="2C" xlink:href="#MJX-218-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(4487.3,0)"><use data-c="1D45F" xlink:href="#MJX-218-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(4899.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-218-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(5256.3,0)"><use data-c="3B" xlink:href="#MJX-218-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-218-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="b" transform="translate(1573,0)"><use data-c="1D44F" xlink:href="#MJX-218-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2091,0)"><use data-c="2E" xlink:href="#MJX-218-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2502.7,0)"><use data-c="A0" xlink:href="#MJX-218-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-218-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-218-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-218-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4244.7,0)"><use data-c="A0" xlink:href="#MJX-218-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4479.7,0)"><use data-c="1D465" xlink:href="#MJX-218-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5038.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-218-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(5986.7,0)"><use data-c="1D44F" xlink:href="#MJX-218-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6726.9,0)"><use data-c="2217" xlink:href="#MJX-218-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7485.1,0)"><use data-c="1D466" xlink:href="#MJX-218-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(7995.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-218-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="\_" transform="translate(8943.1,0)"><use data-c="5F" xlink:href="#MJX-218-STX-N-5F"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(9455.1,0)"><use data-c="3B" xlink:href="#MJX-218-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-2800)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="TeXAtom" data-latex="\phantom{\exists b.\ }" data-mjx-texclass="ORD" transform="translate(1000,0)"><g data-mml-node="mphantom"></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-218-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-218-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-218-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4299.7,0)"><use data-c="A0" xlink:href="#MJX-218-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4534.7,0)"><use data-c="1D465" xlink:href="#MJX-218-STX-I-1D465"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5093.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-218-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(6041.7,0)"><use data-c="1D44F" xlink:href="#MJX-218-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6781.9,0)"><use data-c="2217" xlink:href="#MJX-218-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7540.1,0)"><use data-c="1D466" xlink:href="#MJX-218-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(8050.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-218-STX-N-21A6"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(8998.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-218-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-218-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-218-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(10160.1,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-218-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(10796.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-218-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-218-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-218-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(11958.1,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-218-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(12678.1,0)"><use data-c="1D44F" xlink:href="#MJX-218-STX-I-1D44F"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(13196.1,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-218-STX-N-2B"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(13916.1,0)"><use data-c="1D45F" xlink:href="#MJX-218-STX-I-1D45F"></use></g></g></g></g></g></g></svg></mjx-container></div><p>This specification is already in normal form, but suppose we find out an interpretation for <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-219-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-219-STX-I-1D453"></use></g></g></g></svg></mjx-container>, for example, from the following client.</p>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> z <span class="token operator">=</span> ref <span class="token number">0</span> <span class="token keyword">in</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> ref <span class="token number">1</span> <span class="token keyword">in</span>
hello <span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">_</span> <span class="token operator">-></span> incr z<span class="token punctuation">;</span> <span class="token number">0</span><span class="token punctuation">)</span> z y</code></pre>
<p>Now we have the following interpretation for <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-220-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-220-STX-I-1D453"></use></g></g></g></svg></mjx-container>.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="35.406ex" height="1.965ex" role="img" focusable="false" viewBox="0 -716 16959.6 941" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-221-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-221-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-221-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-221-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-221-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-221-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-221-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-221-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-221-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-221-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-221-STX-I-1D450" d="M358 123C327 85 288 57 219 57C161 57 109 77 109 184C109 300 170 446 280 446C312 446 329 434 329 419C329 403 310 375 310 349C310 327 324 314 348 314C385 314 404 346 404 386C404 451 353 479 290 479C146 479 26 335 26 169C26 68 71-12 179-12C269-12 334 44 375 108Z"></path><path id="MJX-221-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-221-STX-N-A0" d=""></path><path id="MJX-221-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-221-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-221-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-221-STX-I-1D467" d="M438 172L405 172C373 88 351 72 280 72L126 72L126 75L477 440L481 467L115 467L79 313L110 313C130 380 141 398 205 398L368 398L368 395L17 29L13 0L393 0Z"></path><path id="MJX-221-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-221-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-221-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-221-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-221-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-221-STX-N-30" d="M468 317C468 523 378 642 249 642C104 642 27 510 27 320C27 143 86-11 247-11C404-11 468 146 468 317M371 311C371 119 326 25 247 25C167 25 123 121 123 315C123 513 167 608 246 608C328 608 371 514 371 311Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f(\_,\res) = \exists c.\ \req{z{\mapsto}c}; \ens{z{\mapsto}c{\wedge}\res{=}0}
"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-221-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(577,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-221-STX-N-28"></use></g><g data-mml-node="mi" data-latex="\_" transform="translate(934,0)"><use data-c="5F" xlink:href="#MJX-221-STX-N-5F"></use></g><g data-mml-node="mo" data-latex="," transform="translate(1446,0)"><use data-c="2C" xlink:href="#MJX-221-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(1857.7,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-221-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-221-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-221-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(3019.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-221-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(3654.4,0)"><use data-c="3D" xlink:href="#MJX-221-STX-N-3D"></use></g><g data-mml-node="mi" data-latex="\exists" transform="translate(4652.2,0)"><use data-c="2203" xlink:href="#MJX-221-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="c" transform="translate(5225.2,0)"><use data-c="1D450" xlink:href="#MJX-221-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex="." transform="translate(5639.2,0)"><use data-c="2E" xlink:href="#MJX-221-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(6050.9,0)"><use data-c="A0" xlink:href="#MJX-221-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(6285.9,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-221-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-221-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-221-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(7792.9,0)"><use data-c="A0" xlink:href="#MJX-221-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(8027.9,0)"><use data-c="1D467" xlink:href="#MJX-221-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(8520.9,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-221-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(9468.9,0)"><use data-c="1D450" xlink:href="#MJX-221-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(9882.9,0)"><use data-c="3B" xlink:href="#MJX-221-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(10294.6,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-221-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-221-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-221-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(11856.6,0)"><use data-c="A0" xlink:href="#MJX-221-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(12091.6,0)"><use data-c="1D467" xlink:href="#MJX-221-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(12584.6,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-221-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(13532.6,0)"><use data-c="1D450" xlink:href="#MJX-221-STX-I-1D450"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(13946.6,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-221-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(14582.6,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-221-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-221-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-221-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(15744.6,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-221-STX-N-3D"></use></g></g><g data-mml-node="mn" data-latex="0" transform="translate(16464.6,0)"><use data-c="30" xlink:href="#MJX-221-STX-N-30"></use></g></g></g></svg></mjx-container></div><p>Unfolding <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="1.205ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 577 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-222-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="f"><g data-mml-node="mi" data-latex="f"><use data-c="1D453" xlink:href="#MJX-222-STX-I-1D453"></use></g></g></g></svg></mjx-container> in <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.159ex" height="1.497ex" role="img" focusable="false" viewBox="0 -705 1992 717" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-223-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-223-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-223-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-223-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{hello}"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-223-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-223-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-223-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-223-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-223-STX-MI-6F" transform="translate(1507,0)"></use></g></g></g></g></svg></mjx-container> (and doing some renaming),</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -7.103ex;" xmlns="http://www.w3.org/2000/svg" width="31.862ex" height="15.251ex" role="img" focusable="false" viewBox="0 -3902.5 15262.1 7305" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-224-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-224-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-224-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-224-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-224-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-224-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-224-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-224-STX-I-1D467" d="M438 172L405 172C373 88 351 72 280 72L126 72L126 75L477 440L481 467L115 467L79 313L110 313C130 380 141 398 205 398L368 398L368 395L17 29L13 0L393 0Z"></path><path id="MJX-224-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-224-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-224-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-224-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-224-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-224-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-224-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-224-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-224-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-224-STX-N-A0" d=""></path><path id="MJX-224-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-224-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-224-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-224-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-224-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-224-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-224-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-224-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-224-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-224-STX-I-1D450" d="M358 123C327 85 288 57 219 57C161 57 109 77 109 184C109 300 170 446 280 446C312 446 329 434 329 419C329 403 310 375 310 349C310 327 324 314 348 314C385 314 404 346 404 386C404 451 353 479 290 479C146 479 26 335 26 169C26 68 71-12 179-12C269-12 334 44 375 108Z"></path><path id="MJX-224-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-224-STX-N-30" d="M468 317C468 523 378 642 249 642C104 642 27 510 27 320C27 143 86-11 247-11C404-11 468 146 468 317M371 311C371 119 326 25 247 25C167 25 123 121 123 315C123 513 167 608 246 608C328 608 371 514 371 311Z"></path><path id="MJX-224-STX-I-1D44F" d="M198 402L257 705L235 705L97 694L97 668C97 668 116 670 127 670C147 670 163 663 163 641C163 629 160 610 159 606L46 25C95 0 146-12 204-12C382-12 483 140 483 304C483 424 421 479 342 479C289 479 246 450 203 402M184 316C205 363 249 423 313 423C358 423 395 390 395 300C395 148 338 30 219 30C177 30 148 54 135 66Z"></path><path id="MJX-224-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-224-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-224-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-224-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{l}
\m{hello}(f, z, y, res) = \\
\quad \exists a.\ \req{z{\mapsto}a}; \boxed{\ens{z{\mapsto}a{+}1}} \\
\quad \exists r,c.\ \boxed{\req{z{\mapsto}c}}; \ens{z{\mapsto}c{\wedge}r{=}0} \\
\quad \exists b.\ \req{z{\mapsto}b * y{\mapsto}\_}; \\
\quad \phantom{\exists b.\ } \ens{z{\mapsto}b * y{\mapsto}\m{res}{\wedge}\m{res}{=}b{+}r} \\
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res}{=}b{+}r \\
\end{array}
"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,3027.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-224-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-224-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-224-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-224-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-224-STX-MI-6F" transform="translate(1507,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(1992,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-224-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2349,0)"><use data-c="1D453" xlink:href="#MJX-224-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2926,0)"><use data-c="2C" xlink:href="#MJX-224-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(3337.7,0)"><use data-c="1D467" xlink:href="#MJX-224-STX-I-1D467"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3830.7,0)"><use data-c="2C" xlink:href="#MJX-224-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4242.3,0)"><use data-c="1D466" xlink:href="#MJX-224-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4752.3,0)"><use data-c="2C" xlink:href="#MJX-224-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5164,0)"><use data-c="1D45F" xlink:href="#MJX-224-STX-I-1D45F"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(5576,0)"><use data-c="1D452" xlink:href="#MJX-224-STX-I-1D452"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(6000,0)"><use data-c="1D460" xlink:href="#MJX-224-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(6386,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-224-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(7020.8,0)"><use data-c="3D" xlink:href="#MJX-224-STX-N-3D"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,1471.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-224-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(1573,0)"><use data-c="1D44E" xlink:href="#MJX-224-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2128,0)"><use data-c="2E" xlink:href="#MJX-224-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2539.7,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2774.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-224-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-224-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-224-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4281.7,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(4516.7,0)"><use data-c="1D467" xlink:href="#MJX-224-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5009.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-224-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(5957.7,0)"><use data-c="1D44E" xlink:href="#MJX-224-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(6512.7,0)"><use data-c="3B" xlink:href="#MJX-224-STX-N-3B"></use></g><g data-mml-node="menclose" data-latex="\fbox{$\displaystyle{\ens{z{\mapsto}a{+}1}}$}" transform="translate(6924.3,0)"><g transform="translate(267, 0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle" data-latex="\mathbf{ens}\ z{\mapsto}a{+}1}"><g data-mml-node="TeXAtom" data-latex="{\mathbf{ens}z{\mapsto}a{+}1}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-224-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-224-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-224-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1562,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(1797,0)"><use data-c="1D467" xlink:href="#MJX-224-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(2290,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-224-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(3238,0)"><use data-c="1D44E" xlink:href="#MJX-224-STX-I-1D44E"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(3793,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-224-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(4513,0)"><use data-c="31" xlink:href="#MJX-224-STX-N-31"></use></g></g></g></g></g><rect x="33.5" y="-273.5" width="5475" height="1146" fill="none" stroke-width="67"></rect></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,9.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-224-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(1573,0)"><use data-c="1D45F" xlink:href="#MJX-224-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="," transform="translate(1985,0)"><use data-c="2C" xlink:href="#MJX-224-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="c" transform="translate(2396.7,0)"><use data-c="1D450" xlink:href="#MJX-224-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2810.7,0)"><use data-c="2E" xlink:href="#MJX-224-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(3222.3,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="menclose" data-latex="\fbox{$\displaystyle{\req{z{\mapsto}c}}$}" transform="translate(3457.3,0)"><g transform="translate(267, 0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle" data-latex="\mathbf{req}\ z{\mapsto}c}"><g data-mml-node="TeXAtom" data-latex="{\mathbf{req}z{\mapsto}c}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-224-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-224-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-224-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1507,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(1742,0)"><use data-c="1D467" xlink:href="#MJX-224-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(2235,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-224-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(3183,0)"><use data-c="1D450" xlink:href="#MJX-224-STX-I-1D450"></use></g></g></g></g></g><rect x="33.5" y="-453.5" width="4064" height="1175" fill="none" stroke-width="67"></rect></g><g data-mml-node="mo" data-latex=";" transform="translate(7588.3,0)"><use data-c="3B" xlink:href="#MJX-224-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(8000,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-224-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-224-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-224-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(9562,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(9797,0)"><use data-c="1D467" xlink:href="#MJX-224-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(10290,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-224-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(11238,0)"><use data-c="1D450" xlink:href="#MJX-224-STX-I-1D450"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(11652,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-224-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(12288,0)"><use data-c="1D45F" xlink:href="#MJX-224-STX-I-1D45F"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(12700,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-224-STX-N-3D"></use></g></g><g data-mml-node="mn" data-latex="0" transform="translate(13420,0)"><use data-c="30" xlink:href="#MJX-224-STX-N-30"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-1627.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-224-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="b" transform="translate(1573,0)"><use data-c="1D44F" xlink:href="#MJX-224-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2091,0)"><use data-c="2E" xlink:href="#MJX-224-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2502.7,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-224-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-224-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-224-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4244.7,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(4479.7,0)"><use data-c="1D467" xlink:href="#MJX-224-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(4972.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-224-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(5920.7,0)"><use data-c="1D44F" xlink:href="#MJX-224-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6660.9,0)"><use data-c="2217" xlink:href="#MJX-224-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7419.1,0)"><use data-c="1D466" xlink:href="#MJX-224-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(7929.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-224-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="\_" transform="translate(8877.1,0)"><use data-c="5F" xlink:href="#MJX-224-STX-N-5F"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(9389.1,0)"><use data-c="3B" xlink:href="#MJX-224-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-3027.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="TeXAtom" data-latex="\phantom{\exists b.\ }" data-mjx-texclass="ORD" transform="translate(1000,0)"><g data-mml-node="mphantom"></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-224-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-224-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-224-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4299.7,0)"><use data-c="A0" xlink:href="#MJX-224-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(4534.7,0)"><use data-c="1D467" xlink:href="#MJX-224-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5027.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-224-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(5975.7,0)"><use data-c="1D44F" xlink:href="#MJX-224-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6715.9,0)"><use data-c="2217" xlink:href="#MJX-224-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7474.1,0)"><use data-c="1D466" xlink:href="#MJX-224-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(7984.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-224-STX-N-21A6"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(8932.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-224-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-224-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-224-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(10094.1,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-224-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(10730.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-224-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-224-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-224-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(11892.1,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-224-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(12612.1,0)"><use data-c="1D44F" xlink:href="#MJX-224-STX-I-1D44F"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(13130.1,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-224-STX-N-2B"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(13850.1,0)"><use data-c="1D45F" xlink:href="#MJX-224-STX-I-1D45F"></use></g></g></g></g></g></g></svg></mjx-container></div><p>This specification is not in normal form.
Focusing on the boxed portions, we see an <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.261ex" height="1.038ex" role="img" focusable="false" viewBox="0 -485 1562 497" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-225-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-225-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-225-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{ens}"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-225-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-225-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-225-STX-B-1D42C" transform="translate(1134,0)"></use></g></g></g></g></svg></mjx-container> followed by a <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="3.146ex" height="1.478ex" role="img" focusable="false" viewBox="0 -488 1507 708" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-226-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-226-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-226-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{req}"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-226-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-226-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-226-STX-B-1D42A" transform="translate(933,0)"></use></g></g></g></g></svg></mjx-container>.
We can apply the following normalization rule.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -1.891ex;" xmlns="http://www.w3.org/2000/svg" width="30.384ex" height="4.718ex" role="img" focusable="false" viewBox="0 -1354 14553.8 2260" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-227-STX-I-1D437" d="M118 657L112 627C184 627 204 616 190 543L103 124C87 43 69 30-7 30L-13 0L241 0C496 0 680 115 680 398C680 554 586 657 378 657M294 614C312 616 321 617 338 617C535 617 580 511 580 389C580 142 456 39 241 39C215 39 195 39 176 42Z"></path><path id="MJX-227-STX-I-1D434" d="M642 0L648 30C588 30 574 53 561 119L482 661L440 661L94 160C19 46 0 30-55 30L-62 0L147 0L154 30C110 30 96 36 96 57C96 76 107 94 121 113L191 219L449 219L459 129C460 117 461 103 461 87C461 37 430 30 381 30L375 0M445 259L215 259L409 548L412 548Z"></path><path id="MJX-227-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-227-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-227-STX-N-22A2" d="M646 305L646 372L145 372L145 678L75 678L75 0L145 0L145 305Z"></path><path id="MJX-227-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path><path id="MJX-227-STX-I-1D439" d="M607 494L634 657L118 657L112 627C193 627 204 613 190 544L101 116C86 42 62 30-7 30L-13 0L275 0L280 30C218 30 186 37 186 72C186 81 187 93 190 106L233 320L341 320C427 320 443 309 427 224L460 224L506 457L474 457C457 377 436 358 351 358L240 358L294 618L444 618C574 618 578 589 577 494Z"></path><path id="MJX-227-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-227-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-227-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-227-STX-N-A0" d=""></path><path id="MJX-227-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-227-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-227-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-227-STX-N-21D2" d="M826 264C702 358 571 445 451 564L429 543C454 515 480 486 506 460C520 444 529 438 529 418C529 409 520 395 502 395L0 395L0 327L649 327C683 308 710 283 710 259C710 234 683 213 650 190L0 190L0 123L502 123C520 123 529 108 529 100C529 84 522 75 505 57C494 46 454 3 429-26L451-46C571 72 700 159 826 254Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\frac{D_A * D_1 \vdash D_2 * D_F}{\ens{D_1};\req{D_2} \Rightarrow \req{D_A}; \ens{D_F}}
"><g data-mml-node="mfrac" data-latex="\frac{D_A * D_1 \vdash D_2 * D_F}{\ens{D_1};\req{D_2} \Rightarrow \req{D_A}; \ens{D_F}}
"><g data-mml-node="mrow" data-latex="D_A * D_1  \vdash D_2  * D_F" transform="translate(3273.7,676)"><g data-mml-node="msub" data-latex="D_A"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-227-STX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(735,-150) scale(0.707)" data-latex="A"><use data-c="1D434" xlink:href="#MJX-227-STX-I-1D434"></use></g></g><g data-mml-node="mo" data-latex="*" transform="translate(1488.8,0)"><use data-c="2217" xlink:href="#MJX-227-STX-N-2217"></use></g><g data-mml-node="msub" data-latex="D_1" transform="translate(2247,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-227-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-227-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex="\vdash" transform="translate(3659.8,0)"><use data-c="22A2" xlink:href="#MJX-227-STX-N-22A2"></use></g><g data-mml-node="msub" data-latex="D_2" transform="translate(4657.6,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-227-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-227-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="*" transform="translate(6014.8,0)"><use data-c="2217" xlink:href="#MJX-227-STX-N-2217"></use></g><g data-mml-node="msub" data-latex="D_F" transform="translate(6773,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-227-STX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(735,-150) scale(0.707)" data-latex="F"><use data-c="1D439" xlink:href="#MJX-227-STX-I-1D439"></use></g></g></g><g data-mml-node="mrow" data-latex="\mathbf{ens}\ D_F" transform="translate(220,-686)"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-227-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-227-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-227-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1562,0)"><use data-c="A0" xlink:href="#MJX-227-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="D_1" transform="translate(1797,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-227-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-227-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(2932,0)"><use data-c="3B" xlink:href="#MJX-227-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(3343.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-227-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-227-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-227-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4850.7,0)"><use data-c="A0" xlink:href="#MJX-227-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="D_2" transform="translate(5085.7,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-227-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-227-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="\Rightarrow" transform="translate(6498.5,0)"><use data-c="21D2" xlink:href="#MJX-227-STX-N-21D2"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(7663.3,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-227-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-227-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-227-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(9170.3,0)"><use data-c="A0" xlink:href="#MJX-227-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="D_A" transform="translate(9405.3,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-227-STX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(735,-150) scale(0.707)" data-latex="A"><use data-c="1D434" xlink:href="#MJX-227-STX-I-1D434"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(10671.8,0)"><use data-c="3B" xlink:href="#MJX-227-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(11083.5,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-227-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-227-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-227-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(12645.5,0)"><use data-c="A0" xlink:href="#MJX-227-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="D_F" transform="translate(12880.5,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-227-STX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(735,-150) scale(0.707)" data-latex="F"><use data-c="1D439" xlink:href="#MJX-227-STX-I-1D439"></use></g></g></g><rect width="14313.8" height="68" x="120" y="216"></rect></g></g></g></svg></mjx-container></div><p>In other words, it suffices to solve a <a href="https://fbinfer.com/docs/separation-logic-and-bi-abduction/">biabductive entailment</a> to infer a pair of <em>frame</em> (in the separation logic sense) and <em>antiframe</em> (an additional condition <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.313ex;" xmlns="http://www.w3.org/2000/svg" width="2.644ex" height="1.685ex" role="img" focusable="false" viewBox="0 -657 1266.5 807" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-228-STX-I-1D437" d="M118 657L112 627C184 627 204 616 190 543L103 124C87 43 69 30-7 30L-13 0L241 0C496 0 680 115 680 398C680 554 586 657 378 657M294 614C312 616 321 617 338 617C535 617 580 511 580 389C580 142 456 39 241 39C215 39 195 39 176 42Z"></path><path id="MJX-228-STX-I-1D434" d="M642 0L648 30C588 30 574 53 561 119L482 661L440 661L94 160C19 46 0 30-55 30L-62 0L147 0L154 30C110 30 96 36 96 57C96 76 107 94 121 113L191 219L449 219L459 129C460 117 461 103 461 87C461 37 430 30 381 30L375 0M445 259L215 259L409 548L412 548Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="D_A"><g data-mml-node="msub" data-latex="D_A"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-228-STX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(735,-150) scale(0.707)" data-latex="A"><use data-c="1D434" xlink:href="#MJX-228-STX-I-1D434"></use></g></g></g></g></svg></mjx-container> required for <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.313ex;" xmlns="http://www.w3.org/2000/svg" width="2.37ex" height="1.685ex" role="img" focusable="false" viewBox="0 -657 1135 807" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-229-STX-I-1D437" d="M118 657L112 627C184 627 204 616 190 543L103 124C87 43 69 30-7 30L-13 0L241 0C496 0 680 115 680 398C680 554 586 657 378 657M294 614C312 616 321 617 338 617C535 617 580 511 580 389C580 142 456 39 241 39C215 39 195 39 176 42Z"></path><path id="MJX-229-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="D_1"><g data-mml-node="msub" data-latex="D_1 "><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-229-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-229-STX-N-31"></use></g></g></g></g></svg></mjx-container> to entail <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.313ex;" xmlns="http://www.w3.org/2000/svg" width="2.37ex" height="1.685ex" role="img" focusable="false" viewBox="0 -657 1135 807" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-230-STX-I-1D437" d="M118 657L112 627C184 627 204 616 190 543L103 124C87 43 69 30-7 30L-13 0L241 0C496 0 680 115 680 398C680 554 586 657 378 657M294 614C312 616 321 617 338 617C535 617 580 511 580 389C580 142 456 39 241 39C215 39 195 39 176 42Z"></path><path id="MJX-230-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="D_2"><g data-mml-node="msub" data-latex="D_2 "><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-230-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-230-STX-N-32"></use></g></g></g></g></svg></mjx-container>).
We can then use these in place of the original conditions, &quot;swapping&quot; them around, or &quot;pushing&quot; the <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="3.146ex" height="1.478ex" role="img" focusable="false" viewBox="0 -488 1507 708" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-231-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-231-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-231-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{req}"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-231-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-231-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-231-STX-B-1D42A" transform="translate(933,0)"></use></g></g></g></g></svg></mjx-container> &quot;through&quot; the <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.261ex" height="1.038ex" role="img" focusable="false" viewBox="0 -485 1562 497" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-232-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-232-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-232-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{ens}"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-232-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-232-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-232-STX-B-1D42C" transform="translate(1134,0)"></use></g></g></g></g></svg></mjx-container>.</p>
<p>For this example, one solution is:</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="28.556ex" height="1.954ex" role="img" focusable="false" viewBox="0 -716 13678.4 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-233-STX-I-1D467" d="M438 172L405 172C373 88 351 72 280 72L126 72L126 75L477 440L481 467L115 467L79 313L110 313C130 380 141 398 205 398L368 398L368 395L17 29L13 0L393 0Z"></path><path id="MJX-233-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-233-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-233-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-233-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-233-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-233-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-233-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-233-STX-I-1D450" d="M358 123C327 85 288 57 219 57C161 57 109 77 109 184C109 300 170 446 280 446C312 446 329 434 329 419C329 403 310 375 310 349C310 327 324 314 348 314C385 314 404 346 404 386C404 451 353 479 290 479C146 479 26 335 26 169C26 68 71-12 179-12C269-12 334 44 375 108Z"></path><path id="MJX-233-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-233-STX-N-22A2" d="M646 305L646 372L145 372L145 678L75 678L75 0L145 0L145 305Z"></path><path id="MJX-233-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-233-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-233-STX-MI-70" d="M225-11C376-11 488 119 488 307C488 423 428 479 353 479C303 479 261 450 215 396L215 397L211 397L225 474L206 474L63 459L63 434C63 434 80 436 95 436C121 436 132 427 132 407C132 400 131 394 130 388L5-220L201-220L208-193C128-193 107-166 107-143C107-129 109-111 111-101L135 15C155 3 194-11 225-11M146 65L196 307C223 368 262 423 324 423C352 423 400 402 400 307C400 131 334 32 232 32C191 32 163 50 146 65Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="z{\mapsto}a{+}1 * (a{+}1{=}c) \vdash z{\mapsto}c * \emp
"><g data-mml-node="mi" data-latex="z"><use data-c="1D467" xlink:href="#MJX-233-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(493,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-233-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(1441,0)"><use data-c="1D44E" xlink:href="#MJX-233-STX-I-1D44E"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(1996,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-233-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(2716,0)"><use data-c="31" xlink:href="#MJX-233-STX-N-31"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(3433.2,0)"><use data-c="2217" xlink:href="#MJX-233-STX-N-2217"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(4191.4,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-233-STX-N-28"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(4548.4,0)"><use data-c="1D44E" xlink:href="#MJX-233-STX-I-1D44E"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(5103.4,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-233-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(5823.4,0)"><use data-c="31" xlink:href="#MJX-233-STX-N-31"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(6318.4,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-233-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(7038.4,0)"><use data-c="1D450" xlink:href="#MJX-233-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(7452.4,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-233-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\vdash" transform="translate(8087.2,0)"><use data-c="22A2" xlink:href="#MJX-233-STX-N-22A2"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(9085,0)"><use data-c="1D467" xlink:href="#MJX-233-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(9578,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-233-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(10526,0)"><use data-c="1D450" xlink:href="#MJX-233-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(11162.2,0)"><use data-c="2217" xlink:href="#MJX-233-STX-N-2217"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{emp}" data-mjx-texclass="ORD" transform="translate(11920.4,0)"><g data-mml-node="mi" data-latex="emp"><use data-c="65" xlink:href="#MJX-233-STX-MI-65"></use><use data-c="6D" xlink:href="#MJX-233-STX-MI-6D" transform="translate(412,0)"></use><use data-c="70" xlink:href="#MJX-233-STX-MI-70" transform="translate(1237,0)"></use></g></g></g></g></svg></mjx-container></div><p>We can thus transform <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.159ex" height="1.497ex" role="img" focusable="false" viewBox="0 -705 1992 717" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-234-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-234-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-234-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-234-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{hello}"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-234-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-234-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-234-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-234-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-234-STX-MI-6F" transform="translate(1507,0)"></use></g></g></g></g></svg></mjx-container> as follow.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -7.493ex;" xmlns="http://www.w3.org/2000/svg" width="31.862ex" height="16.029ex" role="img" focusable="false" viewBox="0 -4089 15262.1 7678" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-235-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-235-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-235-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-235-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-235-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-235-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-235-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-235-STX-I-1D467" d="M438 172L405 172C373 88 351 72 280 72L126 72L126 75L477 440L481 467L115 467L79 313L110 313C130 380 141 398 205 398L368 398L368 395L17 29L13 0L393 0Z"></path><path id="MJX-235-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-235-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-235-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-235-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-235-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-235-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-235-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-235-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-235-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-235-STX-N-A0" d=""></path><path id="MJX-235-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-235-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-235-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-235-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-235-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-235-STX-I-1D450" d="M358 123C327 85 288 57 219 57C161 57 109 77 109 184C109 300 170 446 280 446C312 446 329 434 329 419C329 403 310 375 310 349C310 327 324 314 348 314C385 314 404 346 404 386C404 451 353 479 290 479C146 479 26 335 26 169C26 68 71-12 179-12C269-12 334 44 375 108Z"></path><path id="MJX-235-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-235-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-235-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-235-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-235-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-235-STX-MI-70" d="M225-11C376-11 488 119 488 307C488 423 428 479 353 479C303 479 261 450 215 396L215 397L211 397L225 474L206 474L63 459L63 434C63 434 80 436 95 436C121 436 132 427 132 407C132 400 131 394 130 388L5-220L201-220L208-193C128-193 107-166 107-143C107-129 109-111 111-101L135 15C155 3 194-11 225-11M146 65L196 307C223 368 262 423 324 423C352 423 400 402 400 307C400 131 334 32 232 32C191 32 163 50 146 65Z"></path><path id="MJX-235-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-235-STX-N-30" d="M468 317C468 523 378 642 249 642C104 642 27 510 27 320C27 143 86-11 247-11C404-11 468 146 468 317M371 311C371 119 326 25 247 25C167 25 123 121 123 315C123 513 167 608 246 608C328 608 371 514 371 311Z"></path><path id="MJX-235-STX-I-1D44F" d="M198 402L257 705L235 705L97 694L97 668C97 668 116 670 127 670C147 670 163 663 163 641C163 629 160 610 159 606L46 25C95 0 146-12 204-12C382-12 483 140 483 304C483 424 421 479 342 479C289 479 246 450 203 402M184 316C205 363 249 423 313 423C358 423 395 390 395 300C395 148 338 30 219 30C177 30 148 54 135 66Z"></path><path id="MJX-235-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-235-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-235-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-235-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{l}
\m{hello}(f, z, y, res) = \\
\quad \exists a.\ \boxed{\req{z{\mapsto}a}; \exists c.\ \req{a{+}1{=}c}} \\
\quad \exists r.\ \boxed{\ens{\emp}; \ens{z{\mapsto}c{\wedge}r{=}0}} \\
\quad \exists b.\ \req{z{\mapsto}b * y{\mapsto}\_}; \\
\quad \phantom{\exists b.\ } \ens{z{\mapsto}b * y{\mapsto}\m{res}{\wedge}\m{res}{=}b{+}r} \\
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res}{=}b{+}r \\
\end{array}
"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,3214)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-235-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-235-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-235-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-235-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-235-STX-MI-6F" transform="translate(1507,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(1992,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-235-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2349,0)"><use data-c="1D453" xlink:href="#MJX-235-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2926,0)"><use data-c="2C" xlink:href="#MJX-235-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(3337.7,0)"><use data-c="1D467" xlink:href="#MJX-235-STX-I-1D467"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3830.7,0)"><use data-c="2C" xlink:href="#MJX-235-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4242.3,0)"><use data-c="1D466" xlink:href="#MJX-235-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4752.3,0)"><use data-c="2C" xlink:href="#MJX-235-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5164,0)"><use data-c="1D45F" xlink:href="#MJX-235-STX-I-1D45F"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(5576,0)"><use data-c="1D452" xlink:href="#MJX-235-STX-I-1D452"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(6000,0)"><use data-c="1D460" xlink:href="#MJX-235-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(6386,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-235-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(7020.8,0)"><use data-c="3D" xlink:href="#MJX-235-STX-N-3D"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,1619)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-235-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(1573,0)"><use data-c="1D44E" xlink:href="#MJX-235-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2128,0)"><use data-c="2E" xlink:href="#MJX-235-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2539.7,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="menclose" data-latex="\fbox{$\displaystyle{\req{z{\mapsto}a}; \exists c.\ \req{a{+}1{=}c}}$}" transform="translate(2774.7,0)"><g transform="translate(267, 0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle" data-latex="\mathbf{req}\ a{+}1{=}c}"><g data-mml-node="TeXAtom" data-latex="{\mathbf{req}z{\mapsto}a;\exists c.\mathbf{req}a{+}1{=}c}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-235-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-235-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-235-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1507,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(1742,0)"><use data-c="1D467" xlink:href="#MJX-235-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(2235,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-235-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(3183,0)"><use data-c="1D44E" xlink:href="#MJX-235-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(3738,0)"><use data-c="3B" xlink:href="#MJX-235-STX-N-3B"></use></g><g data-mml-node="mi" data-latex="\exists" transform="translate(4149.7,0)"><use data-c="2203" xlink:href="#MJX-235-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="c" transform="translate(4722.7,0)"><use data-c="1D450" xlink:href="#MJX-235-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex="." transform="translate(5136.7,0)"><use data-c="2E" xlink:href="#MJX-235-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(5548.3,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(5783.3,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-235-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-235-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-235-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(7290.3,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(7525.3,0)"><use data-c="1D44E" xlink:href="#MJX-235-STX-I-1D44E"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(8080.3,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-235-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(8800.3,0)"><use data-c="31" xlink:href="#MJX-235-STX-N-31"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(9295.3,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-235-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(10015.3,0)"><use data-c="1D450" xlink:href="#MJX-235-STX-I-1D450"></use></g></g></g></g></g><rect x="33.5" y="-453.5" width="10896.3" height="1365" fill="none" stroke-width="67"></rect></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-177)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-235-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(1573,0)"><use data-c="1D45F" xlink:href="#MJX-235-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1985,0)"><use data-c="2E" xlink:href="#MJX-235-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2396.7,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="menclose" data-latex="\fbox{$\displaystyle{\ens{\emp}; \ens{z{\mapsto}c{\wedge}r{=}0}}$}" transform="translate(2631.7,0)"><g transform="translate(267, 0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle" data-latex="\mathbf{ens}\ z{\mapsto}c{\wedge}r{=}0}"><g data-mml-node="TeXAtom" data-latex="{\mathbf{ens}\mathit{emp};\mathbf{ens}z{\mapsto}c{\wedge}r{=}0}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-235-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-235-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-235-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1562,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{emp}" data-mjx-texclass="ORD" transform="translate(1797,0)"><g data-mml-node="mi" data-latex="emp"><use data-c="65" xlink:href="#MJX-235-STX-MI-65"></use><use data-c="6D" xlink:href="#MJX-235-STX-MI-6D" transform="translate(412,0)"></use><use data-c="70" xlink:href="#MJX-235-STX-MI-70" transform="translate(1237,0)"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(3555,0)"><use data-c="3B" xlink:href="#MJX-235-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(3966.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-235-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-235-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-235-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(5528.7,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(5763.7,0)"><use data-c="1D467" xlink:href="#MJX-235-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(6256.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-235-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(7204.7,0)"><use data-c="1D450" xlink:href="#MJX-235-STX-I-1D450"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(7618.7,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-235-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(8254.7,0)"><use data-c="1D45F" xlink:href="#MJX-235-STX-I-1D45F"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(8666.7,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-235-STX-N-3D"></use></g></g><g data-mml-node="mn" data-latex="0" transform="translate(9386.7,0)"><use data-c="30" xlink:href="#MJX-235-STX-N-30"></use></g></g></g></g></g><rect x="33.5" y="-453.5" width="10348.7" height="1329" fill="none" stroke-width="67"></rect></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-1814)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-235-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="b" transform="translate(1573,0)"><use data-c="1D44F" xlink:href="#MJX-235-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2091,0)"><use data-c="2E" xlink:href="#MJX-235-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2502.7,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-235-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-235-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-235-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4244.7,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(4479.7,0)"><use data-c="1D467" xlink:href="#MJX-235-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(4972.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-235-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(5920.7,0)"><use data-c="1D44F" xlink:href="#MJX-235-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6660.9,0)"><use data-c="2217" xlink:href="#MJX-235-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7419.1,0)"><use data-c="1D466" xlink:href="#MJX-235-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(7929.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-235-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="\_" transform="translate(8877.1,0)"><use data-c="5F" xlink:href="#MJX-235-STX-N-5F"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(9389.1,0)"><use data-c="3B" xlink:href="#MJX-235-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-3214)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="TeXAtom" data-latex="\phantom{\exists b.\ }" data-mjx-texclass="ORD" transform="translate(1000,0)"><g data-mml-node="mphantom"></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-235-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-235-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-235-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4299.7,0)"><use data-c="A0" xlink:href="#MJX-235-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(4534.7,0)"><use data-c="1D467" xlink:href="#MJX-235-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5027.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-235-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(5975.7,0)"><use data-c="1D44F" xlink:href="#MJX-235-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6715.9,0)"><use data-c="2217" xlink:href="#MJX-235-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7474.1,0)"><use data-c="1D466" xlink:href="#MJX-235-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(7984.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-235-STX-N-21A6"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(8932.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-235-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-235-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-235-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(10094.1,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-235-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(10730.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-235-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-235-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-235-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(11892.1,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-235-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(12612.1,0)"><use data-c="1D44F" xlink:href="#MJX-235-STX-I-1D44F"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(13130.1,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-235-STX-N-2B"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(13850.1,0)"><use data-c="1D45F" xlink:href="#MJX-235-STX-I-1D45F"></use></g></g></g></g></g></g></svg></mjx-container></div><p>Now we have two consecutive <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="3.146ex" height="1.478ex" role="img" focusable="false" viewBox="0 -488 1507 708" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-236-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-236-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-236-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{req}"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-236-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-236-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-236-STX-B-1D42A" transform="translate(933,0)"></use></g></g></g></g></svg></mjx-container> and <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.261ex" height="1.038ex" role="img" focusable="false" viewBox="0 -485 1562 497" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-237-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-237-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-237-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{ens}"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-237-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-237-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-237-STX-B-1D42C" transform="translate(1134,0)"></use></g></g></g></g></svg></mjx-container> stages.
We can normalize them using the following rules.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -3.027ex;" xmlns="http://www.w3.org/2000/svg" width="28.141ex" height="4.593ex" role="img" focusable="false" viewBox="0 -750 13479.7 2200" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-238-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-238-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-238-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-238-STX-N-A0" d=""></path><path id="MJX-238-STX-I-1D437" d="M118 657L112 627C184 627 204 616 190 543L103 124C87 43 69 30-7 30L-13 0L241 0C496 0 680 115 680 398C680 554 586 657 378 657M294 614C312 616 321 617 338 617C535 617 580 511 580 389C580 142 456 39 241 39C215 39 195 39 176 42Z"></path><path id="MJX-238-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-238-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-238-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path><path id="MJX-238-STX-N-21D2" d="M826 264C702 358 571 445 451 564L429 543C454 515 480 486 506 460C520 444 529 438 529 418C529 409 520 395 502 395L0 395L0 327L649 327C683 308 710 283 710 259C710 234 683 213 650 190L0 190L0 123L502 123C520 123 529 108 529 100C529 84 522 75 505 57C494 46 454 3 429-26L451-46C571 72 700 159 826 254Z"></path><path id="MJX-238-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-238-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-238-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-238-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-238-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\req{D_1}; \req{D_2} \Rightarrow \req{(D_1 * D_2)} \\
\ens{D_1}; \ens{D_2} \Rightarrow \ens{(D_1 * D_2)}
"><g data-mjx-linestack="true"><g data-mjx-linebox="true" data-mjx-lineno="0" transform="translate(82.5,0)"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-238-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-238-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-238-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1507,0)"><use data-c="A0" xlink:href="#MJX-238-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="D_1" transform="translate(1742,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-238-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-238-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(2877,0)"><use data-c="3B" xlink:href="#MJX-238-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(3288.7,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-238-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-238-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-238-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4795.7,0)"><use data-c="A0" xlink:href="#MJX-238-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="D_2" transform="translate(5030.7,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-238-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-238-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="\Rightarrow" transform="translate(6443.5,0)"><use data-c="21D2" xlink:href="#MJX-238-STX-N-21D2"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(7608.3,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-238-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-238-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-238-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(9115.3,0)"><use data-c="A0" xlink:href="#MJX-238-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(9350.3,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-238-STX-N-28"></use></g><g data-mml-node="msub" data-latex="D_1" transform="translate(9707.3,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-238-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-238-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex="*" transform="translate(11064.5,0)"><use data-c="2217" xlink:href="#MJX-238-STX-N-2217"></use></g><g data-mml-node="msub" data-latex="D_2" transform="translate(11822.7,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-238-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-238-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(12957.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-238-STX-N-29"></use></g><g data-mml-node="mspace" data-latex="\\" transform="translate(13314.7,0)"></g></g><g data-mjx-linebox="true" data-mjx-lineno="1" transform="translate(0,-1200)"><g data-mml-node="mspace" data-latex="\\"></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-238-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-238-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-238-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1562,0)"><use data-c="A0" xlink:href="#MJX-238-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="D_1" transform="translate(1797,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-238-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-238-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(2932,0)"><use data-c="3B" xlink:href="#MJX-238-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(3343.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-238-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-238-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-238-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4905.7,0)"><use data-c="A0" xlink:href="#MJX-238-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="D_2" transform="translate(5140.7,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-238-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-238-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="\Rightarrow" transform="translate(6553.5,0)"><use data-c="21D2" xlink:href="#MJX-238-STX-N-21D2"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(7718.3,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-238-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-238-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-238-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(9280.3,0)"><use data-c="A0" xlink:href="#MJX-238-STX-N-A0"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(9515.3,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-238-STX-N-28"></use></g><g data-mml-node="msub" data-latex="D_1" transform="translate(9872.3,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-238-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-238-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex="*" transform="translate(11229.5,0)"><use data-c="2217" xlink:href="#MJX-238-STX-N-2217"></use></g><g data-mml-node="msub" data-latex="D_2" transform="translate(11987.7,0)"><g data-mml-node="mi" data-latex="D"><use data-c="1D437" xlink:href="#MJX-238-STX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(735,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-238-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(13122.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-238-STX-N-29"></use></g></g></g></g></g></svg></mjx-container></div><p>Now we have this, and again we have another <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.261ex" height="1.038ex" role="img" focusable="false" viewBox="0 -485 1562 497" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-239-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-239-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-239-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{ens}"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-239-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-239-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-239-STX-B-1D42C" transform="translate(1134,0)"></use></g></g></g></g></svg></mjx-container>/<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="3.146ex" height="1.478ex" role="img" focusable="false" viewBox="0 -488 1507 708" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-240-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-240-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-240-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\mathbf{req}"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-240-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-240-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-240-STX-B-1D42A" transform="translate(933,0)"></use></g></g></g></g></svg></mjx-container> pair.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -7.323ex;" xmlns="http://www.w3.org/2000/svg" width="31.862ex" height="15.689ex" role="img" focusable="false" viewBox="0 -4007.5 15262.1 7515" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-241-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-241-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-241-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-241-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-241-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-241-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-241-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-241-STX-I-1D467" d="M438 172L405 172C373 88 351 72 280 72L126 72L126 75L477 440L481 467L115 467L79 313L110 313C130 380 141 398 205 398L368 398L368 395L17 29L13 0L393 0Z"></path><path id="MJX-241-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-241-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-241-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-241-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-241-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-241-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-241-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-241-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-241-STX-I-1D450" d="M358 123C327 85 288 57 219 57C161 57 109 77 109 184C109 300 170 446 280 446C312 446 329 434 329 419C329 403 310 375 310 349C310 327 324 314 348 314C385 314 404 346 404 386C404 451 353 479 290 479C146 479 26 335 26 169C26 68 71-12 179-12C269-12 334 44 375 108Z"></path><path id="MJX-241-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-241-STX-N-A0" d=""></path><path id="MJX-241-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-241-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-241-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-241-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-241-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-241-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-241-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-241-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-241-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-241-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-241-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-241-STX-N-30" d="M468 317C468 523 378 642 249 642C104 642 27 510 27 320C27 143 86-11 247-11C404-11 468 146 468 317M371 311C371 119 326 25 247 25C167 25 123 121 123 315C123 513 167 608 246 608C328 608 371 514 371 311Z"></path><path id="MJX-241-STX-I-1D44F" d="M198 402L257 705L235 705L97 694L97 668C97 668 116 670 127 670C147 670 163 663 163 641C163 629 160 610 159 606L46 25C95 0 146-12 204-12C382-12 483 140 483 304C483 424 421 479 342 479C289 479 246 450 203 402M184 316C205 363 249 423 313 423C358 423 395 390 395 300C395 148 338 30 219 30C177 30 148 54 135 66Z"></path><path id="MJX-241-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-241-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-241-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{l}
\m{hello}(f, z, y, res) = \\
\quad \exists a,c.\ \req{z{\mapsto}a * a{+}1{=}c}; \\
\quad \exists r.\ \boxed{\ens{z{\mapsto}c{\wedge}r{=}0}} \\
\quad \exists b.\ \boxed{\req{z{\mapsto}b * y{\mapsto}\_}}; \\
\quad \phantom{\exists b.\ } \ens{z{\mapsto}b * y{\mapsto}\m{res}{\wedge}\m{res}{=}b{+}r} \\
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res}{=}b{+}r \\
\end{array}
"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,3132.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-241-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-241-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-241-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-241-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-241-STX-MI-6F" transform="translate(1507,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(1992,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-241-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2349,0)"><use data-c="1D453" xlink:href="#MJX-241-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2926,0)"><use data-c="2C" xlink:href="#MJX-241-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(3337.7,0)"><use data-c="1D467" xlink:href="#MJX-241-STX-I-1D467"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3830.7,0)"><use data-c="2C" xlink:href="#MJX-241-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4242.3,0)"><use data-c="1D466" xlink:href="#MJX-241-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4752.3,0)"><use data-c="2C" xlink:href="#MJX-241-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5164,0)"><use data-c="1D45F" xlink:href="#MJX-241-STX-I-1D45F"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(5576,0)"><use data-c="1D452" xlink:href="#MJX-241-STX-I-1D452"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(6000,0)"><use data-c="1D460" xlink:href="#MJX-241-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(6386,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-241-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(7020.8,0)"><use data-c="3D" xlink:href="#MJX-241-STX-N-3D"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,1732.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-241-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(1573,0)"><use data-c="1D44E" xlink:href="#MJX-241-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2128,0)"><use data-c="2C" xlink:href="#MJX-241-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="c" transform="translate(2539.7,0)"><use data-c="1D450" xlink:href="#MJX-241-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2953.7,0)"><use data-c="2E" xlink:href="#MJX-241-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(3365.3,0)"><use data-c="A0" xlink:href="#MJX-241-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(3600.3,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-241-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-241-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-241-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(5107.3,0)"><use data-c="A0" xlink:href="#MJX-241-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(5342.3,0)"><use data-c="1D467" xlink:href="#MJX-241-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5835.3,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-241-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(6783.3,0)"><use data-c="1D44E" xlink:href="#MJX-241-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(7560.6,0)"><use data-c="2217" xlink:href="#MJX-241-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(8318.8,0)"><use data-c="1D44E" xlink:href="#MJX-241-STX-I-1D44E"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(8873.8,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-241-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(9593.8,0)"><use data-c="31" xlink:href="#MJX-241-STX-N-31"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(10088.8,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-241-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(10808.8,0)"><use data-c="1D450" xlink:href="#MJX-241-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(11222.8,0)"><use data-c="3B" xlink:href="#MJX-241-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,173.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-241-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(1573,0)"><use data-c="1D45F" xlink:href="#MJX-241-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1985,0)"><use data-c="2E" xlink:href="#MJX-241-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2396.7,0)"><use data-c="A0" xlink:href="#MJX-241-STX-N-A0"></use></g><g data-mml-node="menclose" data-latex="\fbox{$\displaystyle{\ens{z{\mapsto}c{\wedge}r{=}0}}$}" transform="translate(2631.7,0)"><g transform="translate(267, 0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle" data-latex="\mathbf{ens}\ z{\mapsto}c{\wedge}r{=}0}"><g data-mml-node="TeXAtom" data-latex="{\mathbf{ens}z{\mapsto}c{\wedge}r{=}0}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-241-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-241-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-241-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1562,0)"><use data-c="A0" xlink:href="#MJX-241-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(1797,0)"><use data-c="1D467" xlink:href="#MJX-241-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(2290,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-241-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(3238,0)"><use data-c="1D450" xlink:href="#MJX-241-STX-I-1D450"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(3652,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-241-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(4288,0)"><use data-c="1D45F" xlink:href="#MJX-241-STX-I-1D45F"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(4700,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-241-STX-N-3D"></use></g></g><g data-mml-node="mn" data-latex="0" transform="translate(5420,0)"><use data-c="30" xlink:href="#MJX-241-STX-N-30"></use></g></g></g></g></g><rect x="33.5" y="-263.5" width="6382" height="1139" fill="none" stroke-width="67"></rect></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-1495.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-241-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="b" transform="translate(1573,0)"><use data-c="1D44F" xlink:href="#MJX-241-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2091,0)"><use data-c="2E" xlink:href="#MJX-241-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2502.7,0)"><use data-c="A0" xlink:href="#MJX-241-STX-N-A0"></use></g><g data-mml-node="menclose" data-latex="\fbox{$\displaystyle{\req{z{\mapsto}b * y{\mapsto}\_}}$}" transform="translate(2737.7,0)"><g transform="translate(267, 0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle" data-latex="\mathbf{req}\ z{\mapsto}b * y{\mapsto}\_}"><g data-mml-node="TeXAtom" data-latex="{\mathbf{req}z{\mapsto}b*y{\mapsto}\_}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-241-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-241-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-241-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1507,0)"><use data-c="A0" xlink:href="#MJX-241-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(1742,0)"><use data-c="1D467" xlink:href="#MJX-241-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(2235,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-241-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(3183,0)"><use data-c="1D44F" xlink:href="#MJX-241-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(3923.2,0)"><use data-c="2217" xlink:href="#MJX-241-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4681.4,0)"><use data-c="1D466" xlink:href="#MJX-241-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5191.4,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-241-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="\_" transform="translate(6139.4,0)"><use data-c="5F" xlink:href="#MJX-241-STX-N-5F"></use></g></g></g></g></g><rect x="33.5" y="-453.5" width="7118.4" height="1392" fill="none" stroke-width="67"></rect></g><g data-mml-node="mo" data-latex=";" transform="translate(9923.1,0)"><use data-c="3B" xlink:href="#MJX-241-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-3132.5)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="TeXAtom" data-latex="\phantom{\exists b.\ }" data-mjx-texclass="ORD" transform="translate(1000,0)"><g data-mml-node="mphantom"></g></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-241-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-241-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-241-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4299.7,0)"><use data-c="A0" xlink:href="#MJX-241-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(4534.7,0)"><use data-c="1D467" xlink:href="#MJX-241-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5027.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-241-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(5975.7,0)"><use data-c="1D44F" xlink:href="#MJX-241-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6715.9,0)"><use data-c="2217" xlink:href="#MJX-241-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7474.1,0)"><use data-c="1D466" xlink:href="#MJX-241-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(7984.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-241-STX-N-21A6"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(8932.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-241-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-241-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-241-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(10094.1,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-241-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(10730.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-241-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-241-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-241-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(11892.1,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-241-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(12612.1,0)"><use data-c="1D44F" xlink:href="#MJX-241-STX-I-1D44F"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(13130.1,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-241-STX-N-2B"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(13850.1,0)"><use data-c="1D45F" xlink:href="#MJX-241-STX-I-1D45F"></use></g></g></g></g></g></g></svg></mjx-container></div><p>Here's the solution...</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="44.453ex" height="1.954ex" role="img" focusable="false" viewBox="0 -716 21292.9 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-242-STX-I-1D467" d="M438 172L405 172C373 88 351 72 280 72L126 72L126 75L477 440L481 467L115 467L79 313L110 313C130 380 141 398 205 398L368 398L368 395L17 29L13 0L393 0Z"></path><path id="MJX-242-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-242-STX-I-1D450" d="M358 123C327 85 288 57 219 57C161 57 109 77 109 184C109 300 170 446 280 446C312 446 329 434 329 419C329 403 310 375 310 349C310 327 324 314 348 314C385 314 404 346 404 386C404 451 353 479 290 479C146 479 26 335 26 169C26 68 71-12 179-12C269-12 334 44 375 108Z"></path><path id="MJX-242-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-242-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-242-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-242-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-242-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-242-STX-N-30" d="M468 317C468 523 378 642 249 642C104 642 27 510 27 320C27 143 86-11 247-11C404-11 468 146 468 317M371 311C371 119 326 25 247 25C167 25 123 121 123 315C123 513 167 608 246 608C328 608 371 514 371 311Z"></path><path id="MJX-242-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-242-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-242-STX-I-1D44F" d="M198 402L257 705L235 705L97 694L97 668C97 668 116 670 127 670C147 670 163 663 163 641C163 629 160 610 159 606L46 25C95 0 146-12 204-12C382-12 483 140 483 304C483 424 421 479 342 479C289 479 246 450 203 402M184 316C205 363 249 423 313 423C358 423 395 390 395 300C395 148 338 30 219 30C177 30 148 54 135 66Z"></path><path id="MJX-242-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-242-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-242-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-242-STX-N-22A2" d="M646 305L646 372L145 372L145 678L75 678L75 0L145 0L145 305Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="z{\mapsto}c{+}1{\wedge}r{=}0 * (c{+}1{=}b{\wedge}y{\mapsto}\_) \vdash z{\mapsto}b * y{\mapsto}\_ * r{=}0
"><g data-mml-node="mi" data-latex="z"><use data-c="1D467" xlink:href="#MJX-242-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(493,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-242-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(1441,0)"><use data-c="1D450" xlink:href="#MJX-242-STX-I-1D450"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(1855,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-242-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(2575,0)"><use data-c="31" xlink:href="#MJX-242-STX-N-31"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(3070,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-242-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="r" transform="translate(3706,0)"><use data-c="1D45F" xlink:href="#MJX-242-STX-I-1D45F"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(4118,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-242-STX-N-3D"></use></g></g><g data-mml-node="mn" data-latex="0" transform="translate(4838,0)"><use data-c="30" xlink:href="#MJX-242-STX-N-30"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(5555.2,0)"><use data-c="2217" xlink:href="#MJX-242-STX-N-2217"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(6313.4,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-242-STX-N-28"></use></g><g data-mml-node="mi" data-latex="c" transform="translate(6670.4,0)"><use data-c="1D450" xlink:href="#MJX-242-STX-I-1D450"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(7084.4,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-242-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(7804.4,0)"><use data-c="31" xlink:href="#MJX-242-STX-N-31"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(8299.4,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-242-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(9019.4,0)"><use data-c="1D44F" xlink:href="#MJX-242-STX-I-1D44F"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(9537.4,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-242-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="y" transform="translate(10173.4,0)"><use data-c="1D466" xlink:href="#MJX-242-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(10683.4,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-242-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="\_" transform="translate(11631.4,0)"><use data-c="5F" xlink:href="#MJX-242-STX-N-5F"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(12143.4,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-242-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\vdash" transform="translate(12778.2,0)"><use data-c="22A2" xlink:href="#MJX-242-STX-N-22A2"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(13776,0)"><use data-c="1D467" xlink:href="#MJX-242-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(14269,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-242-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(15217,0)"><use data-c="1D44F" xlink:href="#MJX-242-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(15957.2,0)"><use data-c="2217" xlink:href="#MJX-242-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(16715.4,0)"><use data-c="1D466" xlink:href="#MJX-242-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(17225.4,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-242-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="\_" transform="translate(18173.4,0)"><use data-c="5F" xlink:href="#MJX-242-STX-N-5F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(18907.7,0)"><use data-c="2217" xlink:href="#MJX-242-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(19665.9,0)"><use data-c="1D45F" xlink:href="#MJX-242-STX-I-1D45F"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(20077.9,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-242-STX-N-3D"></use></g></g><g data-mml-node="mn" data-latex="0" transform="translate(20797.9,0)"><use data-c="30" xlink:href="#MJX-242-STX-N-30"></use></g></g></g></svg></mjx-container></div><p>... and final state, after one more round of simplification (not shown).</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -3.706ex;" xmlns="http://www.w3.org/2000/svg" width="39.71ex" height="8.455ex" role="img" focusable="false" viewBox="0 -2275 19021.2 4050" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-243-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-243-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-243-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-243-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-243-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-243-STX-I-1D453" d="M190 467L186 426L270 426L205 37C194-29 168-193 115-193C77-193 110-104 50-104C24-104 10-125 10-153C10-188 35-225 99-225C236-225 282-1 296 85L353 426L447 426L453 467L358 467L370 538C385 623 410 682 461 682C485 682 487 658 491 633C494 612 504 594 531 594C552 594 571 609 571 638C571 681 537 711 476 711C390 711 349 665 323 618C300 577 288 523 276 467Z"></path><path id="MJX-243-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-243-STX-I-1D467" d="M438 172L405 172C373 88 351 72 280 72L126 72L126 75L477 440L481 467L115 467L79 313L110 313C130 380 141 398 205 398L368 398L368 395L17 29L13 0L393 0Z"></path><path id="MJX-243-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-243-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-243-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-243-STX-I-1D460" d="M378 479L359 479L333 452L330 452C318 459 281 479 228 479C137 479 92 425 92 357C92 295 139 260 180 221C218 185 254 150 254 96C254 44 222 23 176 23C108 23 82 69 72 156L47 156L21-11L43-11L67 16L70 16C84 10 122-11 185-11C298-11 337 55 337 113C337 177 301 214 258 260C214 307 163 343 163 385C163 414 184 449 236 449C295 449 328 400 331 323L355 323Z"></path><path id="MJX-243-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-243-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-243-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-243-STX-I-1D44E" d="M502 472L449 472L413 426L409 426C388 456 358 479 305 479C174 479 49 341 49 159C49 43 100-12 172-12C229-12 288 22 339 85L346 85C343 67 339 53 339 38C339 5 359-10 395-10C455-10 497 33 539 97L519 112C506 95 477 60 445 60C429 60 425 68 425 81C425 96 430 118 430 118M389 344C389 313 378 240 358 181C329 96 285 54 218 54C168 54 138 77 138 169C138 303 202 441 302 441C358 441 389 397 389 344Z"></path><path id="MJX-243-STX-I-1D450" d="M358 123C327 85 288 57 219 57C161 57 109 77 109 184C109 300 170 446 280 446C312 446 329 434 329 419C329 403 310 375 310 349C310 327 324 314 348 314C385 314 404 346 404 386C404 451 353 479 290 479C146 479 26 335 26 169C26 68 71-12 179-12C269-12 334 44 375 108Z"></path><path id="MJX-243-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-243-STX-N-A0" d=""></path><path id="MJX-243-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-243-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-243-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-243-STX-N-21A6" d="M877 264C779 305 701 384 635 461L614 441C637 407 668 369 698 341C708 331 712 324 712 315C712 305 704 293 686 293L123 293L123 461L71 461L71 58L123 58L123 225L685 225C703 225 711 215 711 205C711 196 706 185 697 176C666 144 637 111 613 78L634 58C701 136 779 212 877 254Z"></path><path id="MJX-243-STX-N-2217" d="M468 345C468 366 452 388 431 388C424 388 417 386 408 382C381 365 353 311 279 272C279 343 309 415 309 447C309 469 289 482 270 482C251 482 231 469 231 447C231 415 261 342 261 271C203 302 157 364 128 382C120 386 112 388 105 388C84 388 68 366 68 345C68 334 76 322 89 314C118 297 196 286 250 256C196 225 121 215 93 199C78 190 71 174 71 159C71 142 85 127 109 127C119 127 128 130 137 135C159 147 208 212 261 242C261 172 231 103 231 72C231 50 251 34 270 34C289 34 309 50 309 72C309 103 279 172 279 242C358 197 384 126 426 126C451 126 466 145 466 166C466 178 459 190 444 198C417 215 351 218 286 256C360 298 420 298 445 313C460 321 468 334 468 345Z"></path><path id="MJX-243-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-243-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-243-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path><path id="MJX-243-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-243-STX-I-1D44F" d="M198 402L257 705L235 705L97 694L97 668C97 668 116 670 127 670C147 670 163 663 163 641C163 629 160 610 159 606L46 25C95 0 146-12 204-12C382-12 483 140 483 304C483 424 421 479 342 479C289 479 246 450 203 402M184 316C205 363 249 423 313 423C358 423 395 390 395 300C395 148 338 30 219 30C177 30 148 54 135 66Z"></path><path id="MJX-243-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-243-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-243-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-243-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-243-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{l}
\m{hello}(f, z, y, res) = \\
\quad \exists a,c.\ \req{z{\mapsto}a * y{\mapsto}\_ \wedge a{+}1{=}c{\wedge}c{+}1{=}b}; \\
\quad \exists b.\ \ens{z{\mapsto}b * y{\mapsto}\m{res}{\wedge}\m{res}{=}b}
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res}{=}b
\end{array}
"><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-243-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-243-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-243-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-243-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-243-STX-MI-6F" transform="translate(1507,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(1992,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-243-STX-N-28"></use></g><g data-mml-node="mi" data-latex="f" transform="translate(2349,0)"><use data-c="1D453" xlink:href="#MJX-243-STX-I-1D453"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2926,0)"><use data-c="2C" xlink:href="#MJX-243-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(3337.7,0)"><use data-c="1D467" xlink:href="#MJX-243-STX-I-1D467"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3830.7,0)"><use data-c="2C" xlink:href="#MJX-243-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(4242.3,0)"><use data-c="1D466" xlink:href="#MJX-243-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="," transform="translate(4752.3,0)"><use data-c="2C" xlink:href="#MJX-243-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(5164,0)"><use data-c="1D45F" xlink:href="#MJX-243-STX-I-1D45F"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(5576,0)"><use data-c="1D452" xlink:href="#MJX-243-STX-I-1D452"></use></g><g data-mml-node="mi" data-latex="s" transform="translate(6000,0)"><use data-c="1D460" xlink:href="#MJX-243-STX-I-1D460"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(6386,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-243-STX-N-29"></use></g><g data-mml-node="mo" data-latex="=" transform="translate(7020.8,0)"><use data-c="3D" xlink:href="#MJX-243-STX-N-3D"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-243-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(1573,0)"><use data-c="1D44E" xlink:href="#MJX-243-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2128,0)"><use data-c="2C" xlink:href="#MJX-243-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="c" transform="translate(2539.7,0)"><use data-c="1D450" xlink:href="#MJX-243-STX-I-1D450"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2953.7,0)"><use data-c="2E" xlink:href="#MJX-243-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(3365.3,0)"><use data-c="A0" xlink:href="#MJX-243-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(3600.3,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-243-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-243-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-243-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(5107.3,0)"><use data-c="A0" xlink:href="#MJX-243-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(5342.3,0)"><use data-c="1D467" xlink:href="#MJX-243-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5835.3,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-243-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="a" transform="translate(6783.3,0)"><use data-c="1D44E" xlink:href="#MJX-243-STX-I-1D44E"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(7560.6,0)"><use data-c="2217" xlink:href="#MJX-243-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(8318.8,0)"><use data-c="1D466" xlink:href="#MJX-243-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(8828.8,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-243-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="\_" transform="translate(9776.8,0)"><use data-c="5F" xlink:href="#MJX-243-STX-N-5F"></use></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(10511,0)"><use data-c="2227" xlink:href="#MJX-243-STX-N-2227"></use></g><g data-mml-node="mi" data-latex="a" transform="translate(11369.2,0)"><use data-c="1D44E" xlink:href="#MJX-243-STX-I-1D44E"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(11924.2,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-243-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(12644.2,0)"><use data-c="31" xlink:href="#MJX-243-STX-N-31"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(13139.2,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-243-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(13859.2,0)"><use data-c="1D450" xlink:href="#MJX-243-STX-I-1D450"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(14273.2,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-243-STX-N-2227"></use></g></g><g data-mml-node="mi" data-latex="c" transform="translate(14909.2,0)"><use data-c="1D450" xlink:href="#MJX-243-STX-I-1D450"></use></g><g data-mml-node="TeXAtom" data-latex="{+}" data-mjx-texclass="ORD" transform="translate(15323.2,0)"><g data-mml-node="mo" data-latex="+"><use data-c="2B" xlink:href="#MJX-243-STX-N-2B"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(16043.2,0)"><use data-c="31" xlink:href="#MJX-243-STX-N-31"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(16538.2,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-243-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(17258.2,0)"><use data-c="1D44F" xlink:href="#MJX-243-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(17776.2,0)"><use data-c="3B" xlink:href="#MJX-243-STX-N-3B"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{l}" data-latex="{l}" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mspace" data-latex="\quad"></g><g data-mml-node="mi" data-latex="\exists" transform="translate(1000,0)"><use data-c="2203" xlink:href="#MJX-243-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="b" transform="translate(1573,0)"><use data-c="1D44F" xlink:href="#MJX-243-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2091,0)"><use data-c="2E" xlink:href="#MJX-243-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(2502.7,0)"><use data-c="A0" xlink:href="#MJX-243-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(2737.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-243-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-243-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-243-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4299.7,0)"><use data-c="A0" xlink:href="#MJX-243-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="z" transform="translate(4534.7,0)"><use data-c="1D467" xlink:href="#MJX-243-STX-I-1D467"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(5027.7,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-243-STX-N-21A6"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(5975.7,0)"><use data-c="1D44F" xlink:href="#MJX-243-STX-I-1D44F"></use></g><g data-mml-node="mo" data-latex="*" transform="translate(6715.9,0)"><use data-c="2217" xlink:href="#MJX-243-STX-N-2217"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(7474.1,0)"><use data-c="1D466" xlink:href="#MJX-243-STX-I-1D466"></use></g><g data-mml-node="TeXAtom" data-latex="{\mapsto}" data-mjx-texclass="ORD" transform="translate(7984.1,0)"><g data-mml-node="mo" data-latex="\mapsto"><use data-c="21A6" xlink:href="#MJX-243-STX-N-21A6"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(8932.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-243-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-243-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-243-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(10094.1,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-243-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(10730.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-243-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-243-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-243-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(11892.1,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-243-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="b" transform="translate(12612.1,0)"><use data-c="1D44F" xlink:href="#MJX-243-STX-I-1D44F"></use></g></g></g></g></g></g></svg></mjx-container></div><p>Now the specification for this call to <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.159ex" height="1.497ex" role="img" focusable="false" viewBox="0 -705 1992 717" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-244-STX-MI-68" d="M384-10C456-10 496 60 522 97L501 112C486 93 462 60 426 60C413 60 407 68 407 79C407 91 411 103 411 103L467 334C470 348 476 382 476 408C476 444 461 479 411 479C296 479 206 334 165 259L157 259L182 377L253 705L230 705L93 694L93 668C93 668 114 670 127 670C147 670 159 659 159 644C159 629 156 610 156 610L31 0L113 0L148 160C179 230 290 407 361 407C383 407 390 390 390 367C390 347 383 319 383 319L324 88C322 83 319 65 319 49C319 19 334-10 384-10Z"></path><path id="MJX-244-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-244-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-244-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{hello}"><g data-mml-node="TeXAtom" data-latex="\mathit{hello}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="hello"><use data-c="68" xlink:href="#MJX-244-STX-MI-68"></use><use data-c="65" xlink:href="#MJX-244-STX-MI-65" transform="translate(549,0)"></use><use data-c="6C" xlink:href="#MJX-244-STX-MI-6C" transform="translate(961,0)"></use><use data-c="6C" xlink:href="#MJX-244-STX-MI-6C" transform="translate(1234,0)"></use><use data-c="6F" xlink:href="#MJX-244-STX-MI-6F" transform="translate(1507,0)"></use></g></g></g></g></svg></mjx-container> is in normal form, and we can use it for subsequent reasoning.
We see also that it precisely captures the aggregate behavior of this call, including the state changes.</p>
<h1 id="solutions-to-problematic-examples">Solutions to problematic examples</h1>
<p>Going back to the problematic clients we highlighted previously,
how can we tackle them using staged logic,
and how does the approach differ from the invariant-based way of writing specifications given in the introduction?</p>
<p>All the following assume the specification for <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.47ex;" xmlns="http://www.w3.org/2000/svg" width="4.188ex" height="1.954ex" role="img" focusable="false" viewBox="0 -711 2006 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-245-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-245-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-245-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-245-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-245-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\foldr"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="foldr"><use data-c="66" xlink:href="#MJX-245-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-245-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-245-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-245-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-245-STX-MI-72" transform="translate(1590,0)"></use></g></g></g></g></svg></mjx-container> is as given in the previous section.
Crucially, none have to change it to solve all problems.</p>
<h2 id="example-1">Example 1</h2>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr_ex1 l <span class="token operator">=</span> foldr <span class="token punctuation">(</span><span class="token keyword">fun</span> x r <span class="token operator">-></span> <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token operator">!</span>x <span class="token keyword">in</span>
                                    x <span class="token operator">:=</span> v<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> v<span class="token operator">+</span>r<span class="token punctuation">)</span> l <span class="token number">0</span></code></pre>
<p>An invariant to tell us about the content of the list is not needed.
Instead, we describe the final content of the list in terms of the initial content using a pure function <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="6.537ex" height="1.848ex" role="img" focusable="false" viewBox="0 -665 3131 885" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-246-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-246-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-246-STX-MI-70" d="M225-11C376-11 488 119 488 307C488 423 428 479 353 479C303 479 261 450 215 396L215 397L211 397L225 474L206 474L63 459L63 434C63 434 80 436 95 436C121 436 132 427 132 407C132 400 131 394 130 388L5-220L201-220L208-193C128-193 107-166 107-143C107-129 109-111 111-101L135 15C155 3 194-11 225-11M146 65L196 307C223 368 262 423 324 423C352 423 400 402 400 307C400 131 334 32 232 32C191 32 163 50 146 65Z"></path><path id="MJX-246-STX-MI-69" d="M115-9C181-9 220 47 255 96L235 111C219 93 191 59 157 59C145 59 139 65 139 78C139 92 144 120 144 120L219 476L197 476L57 465L57 438C57 438 74 440 91 440C118 440 123 424 123 411C123 394 120 380 120 380L69 142C56 83 52 61 52 44C52 9 75-9 115-9M188 556C218 556 243 576 243 610C243 643 224 665 191 665C158 665 136 644 136 610C136 575 158 556 188 556Z"></path><path id="MJX-246-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-246-STX-MI-63" d="M183-13C273-13 336 46 376 108L359 123C329 85 290 57 225 57C150 57 117 95 117 183C117 300 176 446 282 446C313 446 330 434 330 419C330 403 311 375 311 349C311 327 325 314 349 314C386 314 405 346 405 386C405 451 354 479 292 479C152 479 34 337 34 167C34 58 85-13 183-13Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{mapinc}"><g data-mml-node="TeXAtom" data-latex="\mathit{mapinc}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="mapinc"><use data-c="6D" xlink:href="#MJX-246-STX-MI-6D"></use><use data-c="61" xlink:href="#MJX-246-STX-MI-61" transform="translate(825,0)"></use><use data-c="70" xlink:href="#MJX-246-STX-MI-70" transform="translate(1359,0)"></use><use data-c="69" xlink:href="#MJX-246-STX-MI-69" transform="translate(1880,0)"></use><use data-c="6E" xlink:href="#MJX-246-STX-MI-6E" transform="translate(2159,0)"></use><use data-c="63" xlink:href="#MJX-246-STX-MI-63" transform="translate(2723,0)"></use></g></g></g></g></svg></mjx-container>, alongside the result.
The list is described using a shape predicate.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -2.264ex;" xmlns="http://www.w3.org/2000/svg" width="62.79ex" height="5.572ex" role="img" focusable="false" viewBox="0 -1584.4 30076.3 2668.8" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-247-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-247-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-247-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-247-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-247-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-247-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-247-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-247-STX-MI-31" d="M371 0L377 28C299 28 272 41 272 75C272 81 273 88 274 95L390 639L361 639L170 584L163 551C196 561 234 567 254 567C272 567 280 560 280 543C280 536 278 528 276 518L186 95C176 45 152 28 58 28L52 0Z"></path><path id="MJX-247-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-247-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path><path id="MJX-247-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-247-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-247-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-247-STX-N-2291" d="M646 52L646 120L143 120L143 554L646 554L646 621L75 621L75 52M646-106L646-38L75-38L75-106Z"></path><path id="MJX-247-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-247-STX-MI-79" d="M2-220C69-220 126-139 234 15C244 29 348 175 398 268C429 325 441 365 441 401C441 457 411 482 377 482C349 482 334 464 334 442C334 403 383 383 383 346C383 330 374 303 350 264L235 79L229 79L220 179L198 325C186 405 179 437 157 475L142 475L8 464L8 435C17 436 26 437 35 437C94 437 100 393 108 343L165-9C137-51 57-163 35-163C19-163 4-109-37-109C-59-109-76-124-76-152C-76-193-38-220 2-220Z"></path><path id="MJX-247-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-247-STX-N-A0" d=""></path><path id="MJX-247-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-247-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-247-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-247-STX-MI-4C" d="M481 0L541 195L509 195C447 79 426 38 299 38L252 38C193 38 178 48 187 92L278 540C293 612 325 627 397 627L402 657L118 657L112 627C198 627 203 607 189 541L103 124C86 44 70 30-7 30L-13 0Z"></path><path id="MJX-247-STX-MI-69" d="M115-9C181-9 220 47 255 96L235 111C219 93 191 59 157 59C145 59 139 65 139 78C139 92 144 120 144 120L219 476L197 476L57 465L57 438C57 438 74 440 91 440C118 440 123 424 123 411C123 394 120 380 120 380L69 142C56 83 52 61 52 44C52 9 75-9 115-9M188 556C218 556 243 576 243 610C243 643 224 665 191 665C158 665 136 644 136 610C136 575 158 556 188 556Z"></path><path id="MJX-247-STX-MI-74" d="M115-9C194-9 236 65 265 104L245 119C210 74 189 59 160 59C146 59 143 69 143 80C143 97 150 130 150 130L211 428L310 428L318 467L219 467L245 593L215 593C165 506 140 482 76 449L72 428L129 428L61 101C59 91 54 61 54 44C54 13 73-9 115-9Z"></path><path id="MJX-247-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-247-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-247-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-247-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-247-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-247-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-247-STX-MI-70" d="M225-11C376-11 488 119 488 307C488 423 428 479 353 479C303 479 261 450 215 396L215 397L211 397L225 474L206 474L63 459L63 434C63 434 80 436 95 436C121 436 132 427 132 407C132 400 131 394 130 388L5-220L201-220L208-193C128-193 107-166 107-143C107-129 109-111 111-101L135 15C155 3 194-11 225-11M146 65L196 307C223 368 262 423 324 423C352 423 400 402 400 307C400 131 334 32 232 32C191 32 163 50 146 65Z"></path><path id="MJX-247-STX-MI-6E" d="M400-10C471-10 511 60 537 97L516 112C501 93 477 60 442 60C429 60 423 68 423 79C423 91 426 103 426 103L482 334C485 348 491 375 491 408C491 444 476 479 427 479C312 479 228 334 187 259L179 259L229 476L207 476L68 465L68 438C68 438 88 440 101 440C124 440 134 430 134 413C134 398 130 380 130 380L49 0L131 0L167 158C199 227 306 407 377 407C399 407 406 390 406 367C406 347 399 319 399 319L340 88C338 83 334 65 334 49C334 19 350-10 400-10Z"></path><path id="MJX-247-STX-MI-63" d="M183-13C273-13 336 46 376 108L359 123C329 85 290 57 225 57C150 57 117 95 117 183C117 300 176 446 282 446C313 446 330 434 330 419C330 403 311 375 311 349C311 327 325 314 349 314C386 314 405 346 405 386C405 451 354 479 292 479C152 479 34 337 34 167C34 58 85-13 183-13Z"></path><path id="MJX-247-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-247-STX-MI-75" d="M123-10C240-10 311 127 352 197L361 197C344 132 329 92 329 45C329 1 362-9 389-9C450-9 487 32 531 96L510 111C510 111 473 59 437 59C421 59 416 68 416 76C416 91 422 119 422 119L496 473L413 473L381 332C360 241 249 62 175 62C153 62 145 79 145 103C145 121 152 151 152 151L221 476L190 476L55 465L55 438C66 439 75 440 89 440C106 440 125 434 125 413C125 394 115 350 115 350L67 135C64 121 57 88 57 62C57 25 72-10 123-10Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{rl}
&amp; \m{foldr_ex1}(l,\res) \\
\sqsubseteq &amp; \exists \xs, \ys.\ \req{\list(l,\xs)}; \ens{\list(l,\ys){\wedge}\m{mapinc}(\xs){=}\ys{\wedge}\m{sum}(\xs){=}\res}
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\mathit{res}
\end{array}
"><g data-mml-node="mtr" data-latex-item="{rl}" data-latex="{rl}" transform="translate(0,709.4)"><g data-mml-node="mtd" transform="translate(1220,0)"></g><g data-mml-node="mtd" transform="translate(2220,0)"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr_ex1}" data-mjx-texclass="ORD"><g data-mml-node="msub" data-latex="oldr_x"><g data-mml-node="mi" data-latex="oldr"><use data-c="66" xlink:href="#MJX-247-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-247-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-247-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-247-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-247-STX-MI-72" transform="translate(1590,0)"></use></g><g data-mml-node="mi" transform="translate(2090.6,-260.4) scale(0.707)" data-latex="x"><use data-c="65" xlink:href="#MJX-247-STX-MI-65"></use><use data-c="78" xlink:href="#MJX-247-STX-MI-78" transform="translate(412,0)"></use></g></g><g data-mml-node="mn" data-latex="1" transform="translate(2771.4,0)"><use data-c="31" xlink:href="#MJX-247-STX-MI-31"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(3266.4,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-247-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(3623.4,0)"><use data-c="1D459" xlink:href="#MJX-247-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3901.4,0)"><use data-c="2C" xlink:href="#MJX-247-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(4313.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-247-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-247-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(5475.1,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-247-STX-N-29"></use></g></g></g><g data-mml-node="mtr" data-latex-item="{rl}" data-latex="{rl}" transform="translate(0,-709.4)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mo" data-latex="\sqsubseteq"><use data-c="2291" xlink:href="#MJX-247-STX-N-2291"></use></g></g><g data-mml-node="mtd" transform="translate(2220,0)"><g data-mml-node="mi" data-latex="\exists"><use data-c="2203" xlink:href="#MJX-247-STX-N-2203"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(573,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-247-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex="," transform="translate(1393,0)"><use data-c="2C" xlink:href="#MJX-247-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(1804.7,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-247-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(446,0)"></use></g></g><g data-mml-node="mo" data-latex="." transform="translate(2617.7,0)"><use data-c="2E" xlink:href="#MJX-247-STX-N-2E"></use></g><g data-mml-node="mtext" transform="translate(3029.3,0)"><use data-c="A0" xlink:href="#MJX-247-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(3264.3,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-247-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-247-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-247-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4771.3,0)"><use data-c="A0" xlink:href="#MJX-247-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{List}" data-mjx-texclass="ORD" transform="translate(5006.3,0)"><g data-mml-node="mi" data-latex="List"><use data-c="4C" xlink:href="#MJX-247-STX-MI-4C"></use><use data-c="69" xlink:href="#MJX-247-STX-MI-69" transform="translate(569,0)"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(848,0)"></use><use data-c="74" xlink:href="#MJX-247-STX-MI-74" transform="translate(1215,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(6539.3,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-247-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(6896.3,0)"><use data-c="1D459" xlink:href="#MJX-247-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(7174.3,0)"><use data-c="2C" xlink:href="#MJX-247-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(7586,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-247-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(8406,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-247-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(8763,0)"><use data-c="3B" xlink:href="#MJX-247-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(9174.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-247-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-247-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-247-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(10736.7,0)"><use data-c="A0" xlink:href="#MJX-247-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{List}" data-mjx-texclass="ORD" transform="translate(10971.7,0)"><g data-mml-node="mi" data-latex="List"><use data-c="4C" xlink:href="#MJX-247-STX-MI-4C"></use><use data-c="69" xlink:href="#MJX-247-STX-MI-69" transform="translate(569,0)"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(848,0)"></use><use data-c="74" xlink:href="#MJX-247-STX-MI-74" transform="translate(1215,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(12504.7,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-247-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(12861.7,0)"><use data-c="1D459" xlink:href="#MJX-247-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(13139.7,0)"><use data-c="2C" xlink:href="#MJX-247-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(13551.3,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-247-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(446,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(14364.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-247-STX-N-29"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(14721.3,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-247-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{mapinc}" data-mjx-texclass="ORD" transform="translate(15357.3,0)"><g data-mml-node="mi" data-latex="mapinc"><use data-c="6D" xlink:href="#MJX-247-STX-MI-6D"></use><use data-c="61" xlink:href="#MJX-247-STX-MI-61" transform="translate(825,0)"></use><use data-c="70" xlink:href="#MJX-247-STX-MI-70" transform="translate(1359,0)"></use><use data-c="69" xlink:href="#MJX-247-STX-MI-69" transform="translate(1880,0)"></use><use data-c="6E" xlink:href="#MJX-247-STX-MI-6E" transform="translate(2159,0)"></use><use data-c="63" xlink:href="#MJX-247-STX-MI-63" transform="translate(2723,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(18488.3,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-247-STX-N-28"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(18845.3,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-247-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(19665.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-247-STX-N-29"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(20022.3,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-247-STX-N-3D"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{ys}" data-mjx-texclass="ORD" transform="translate(20742.3,0)"><g data-mml-node="mi" data-latex="ys"><use data-c="79" xlink:href="#MJX-247-STX-MI-79"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(446,0)"></use></g></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(21555.3,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-247-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{sum}" data-mjx-texclass="ORD" transform="translate(22191.3,0)"><g data-mml-node="mi" data-latex="sum"><use data-c="73" xlink:href="#MJX-247-STX-MI-73"></use><use data-c="75" xlink:href="#MJX-247-STX-MI-75" transform="translate(367,0)"></use><use data-c="6D" xlink:href="#MJX-247-STX-MI-6D" transform="translate(924,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(23940.3,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-247-STX-N-28"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{xs}" data-mjx-texclass="ORD" transform="translate(24297.3,0)"><g data-mml-node="mi" data-latex="xs"><use data-c="78" xlink:href="#MJX-247-STX-MI-78"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(453,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(25117.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-247-STX-N-29"></use></g><g data-mml-node="TeXAtom" data-latex="{=}" data-mjx-texclass="ORD" transform="translate(25474.3,0)"><g data-mml-node="mo" data-latex="="><use data-c="3D" xlink:href="#MJX-247-STX-N-3D"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(26194.3,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-247-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-247-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-247-STX-MI-73" transform="translate(795,0)"></use></g></g></g></g></g></g></g></svg></mjx-container></div><!--

$$
\begin{array}{l}
\m{mapinc}(\xs, \ys) = \\
\quad \phantom{\vee\ } (\xs{=}[]{\wedge}\ys) \\
\quad \vee\ (\exists x, \xs_1, \ys.\ \xs{=}x{::}\xs_1{\wedge}\ys{=}(x{+}1){::}\ys_1) \wedge \m{mapinc}(\xs_1, \ys_1) \\ \\
\list(l, \m{rs}) = \\
\quad \phantom{\vee\ } (\emp{\wedge}l{=}[]) \\
\quad \vee\ (\exists x, \m{rs}_1, l_1.\ x{\mapsto}r * \list(l_1,\m{rs}_1){\wedge}l{=}x{::}l_1 {\wedge} \m{rs}{=}r{::}\m{rs}_1)
\end{array}
$$

-->
<h2 id="example-2">Example 2</h2>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr_ex2 l <span class="token operator">=</span> foldr <span class="token punctuation">(</span><span class="token keyword">fun</span> x r <span class="token operator">-></span> <span class="token keyword">assert</span><span class="token punctuation">(</span>x<span class="token operator">+</span>r<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> x<span class="token operator">+</span>r<span class="token punctuation">)</span> l <span class="token number">0</span></code></pre>
<p>To enable the assertion in the function argument to be proved, we explicate the assumption that all suffix-sums of the list are positive using a pure function of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.019ex;" xmlns="http://www.w3.org/2000/svg" width="0.58ex" height="1.491ex" role="img" focusable="false" viewBox="0 -705 278 714" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-248-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="l"><g data-mml-node="mi" data-latex="l"><use data-c="1D459" xlink:href="#MJX-248-STX-I-1D459"></use></g></g></g></svg></mjx-container>. This can be directly given as part of the user-provided specificaton on the right.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.561ex;" xmlns="http://www.w3.org/2000/svg" width="40.501ex" height="2.056ex" role="img" focusable="false" viewBox="0 -716 19399.9 984.8" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-249-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-249-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-249-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-249-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-249-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-249-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-249-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-249-STX-MI-32" d="M380 0L446 160L417 160C381 100 364 79 311 79L172 79L105 76L106 81L260 206C412 332 482 400 482 504C482 589 424 644 329 644C225 644 156 586 100 491L122 481C179 555 224 581 289 581C354 581 388 541 388 483C388 376 333 317 180 184L-3 34L-10 0Z"></path><path id="MJX-249-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-249-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path><path id="MJX-249-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-249-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-249-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-249-STX-N-2291" d="M646 52L646 120L143 120L143 554L646 554L646 621L75 621L75 52M646-106L646-38L75-38L75-106Z"></path><path id="MJX-249-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-249-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-249-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-249-STX-N-A0" d=""></path><path id="MJX-249-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-249-STX-MI-53" d="M54-15C58 5 73 18 87 18C110 18 140-12 244-12C368-12 476 64 476 191C476 287 405 327 332 375C267 415 211 456 211 517C211 589 260 631 343 631C444 631 472 583 476 473L505 473L539 667L515 667C505 646 493 638 476 638C454 638 431 667 344 667C232 667 126 604 126 488C126 396 181 358 247 316C248 316 248 315 249 315C319 270 384 229 383 144C382 67 321 30 238 30C137 29 103 63 94 201L66 201L24-15Z"></path><path id="MJX-249-STX-MI-50" d="M269 0L275 30C194 30 176 41 193 123L228 294C238 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657L122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0M235 331L293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 235 331Z"></path><path id="MJX-249-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-249-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-249-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-249-STX-MI-75" d="M123-10C240-10 311 127 352 197L361 197C344 132 329 92 329 45C329 1 362-9 389-9C450-9 487 32 531 96L510 111C510 111 473 59 437 59C421 59 416 68 416 76C416 91 422 119 422 119L496 473L413 473L381 332C360 241 249 62 175 62C153 62 145 79 145 103C145 121 152 151 152 151L221 476L190 476L55 465L55 438C66 439 75 440 89 440C106 440 125 434 125 413C125 394 115 350 115 350L67 135C64 121 57 88 57 62C57 25 72-10 123-10Z"></path><path id="MJX-249-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{foldr_ex2}(l,\res) \sqsubseteq \req{\m{allSPos}(l)}; \ens{\m{sum}(l,\res)}
"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr_ex2}" data-mjx-texclass="ORD"><g data-mml-node="msub" data-latex="oldr_x"><g data-mml-node="mi" data-latex="oldr"><use data-c="66" xlink:href="#MJX-249-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-249-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-249-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-249-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-249-STX-MI-72" transform="translate(1590,0)"></use></g><g data-mml-node="mi" transform="translate(2090.6,-260.4) scale(0.707)" data-latex="x"><use data-c="65" xlink:href="#MJX-249-STX-MI-65"></use><use data-c="78" xlink:href="#MJX-249-STX-MI-78" transform="translate(412,0)"></use></g></g><g data-mml-node="mn" data-latex="2" transform="translate(2771.4,0)"><use data-c="32" xlink:href="#MJX-249-STX-MI-32"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(3266.4,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-249-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(3623.4,0)"><use data-c="1D459" xlink:href="#MJX-249-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3901.4,0)"><use data-c="2C" xlink:href="#MJX-249-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(4313.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-249-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-249-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-249-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(5475.1,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-249-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\sqsubseteq" transform="translate(6109.8,0)"><use data-c="2291" xlink:href="#MJX-249-STX-N-2291"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD" transform="translate(7107.6,0)"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-249-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-249-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-249-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(8614.6,0)"><use data-c="A0" xlink:href="#MJX-249-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{allSPos}" data-mjx-texclass="ORD" transform="translate(8849.6,0)"><g data-mml-node="mi" data-latex="allSPos"><use data-c="61" xlink:href="#MJX-249-STX-MI-61"></use><use data-c="6C" xlink:href="#MJX-249-STX-MI-6C" transform="translate(534,0)"></use><use data-c="6C" xlink:href="#MJX-249-STX-MI-6C" transform="translate(807,0)"></use><use data-c="53" xlink:href="#MJX-249-STX-MI-53" transform="translate(1080,0)"></use><use data-c="50" xlink:href="#MJX-249-STX-MI-50" transform="translate(1614,0)"></use><use data-c="6F" xlink:href="#MJX-249-STX-MI-6F" transform="translate(2183,0)"></use><use data-c="73" xlink:href="#MJX-249-STX-MI-73" transform="translate(2668,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(11884.6,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-249-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(12241.6,0)"><use data-c="1D459" xlink:href="#MJX-249-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(12519.6,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-249-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(12876.6,0)"><use data-c="3B" xlink:href="#MJX-249-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(13288.3,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-249-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-249-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-249-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(14850.3,0)"><use data-c="A0" xlink:href="#MJX-249-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{sum}" data-mjx-texclass="ORD" transform="translate(15085.3,0)"><g data-mml-node="mi" data-latex="sum"><use data-c="73" xlink:href="#MJX-249-STX-MI-73"></use><use data-c="75" xlink:href="#MJX-249-STX-MI-75" transform="translate(367,0)"></use><use data-c="6D" xlink:href="#MJX-249-STX-MI-6D" transform="translate(924,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(16834.3,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-249-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(17191.3,0)"><use data-c="1D459" xlink:href="#MJX-249-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(17469.3,0)"><use data-c="2C" xlink:href="#MJX-249-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(17880.9,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-249-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-249-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-249-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(19042.9,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-249-STX-N-29"></use></g></g></g></svg></mjx-container></div><p>In this example, we are not concerned with shapes, and fittingly, shape predicates do not appear at all in the specification or lemma.</p>
<!--
$$
\begin{array}{l}
\m{allSPos}(l) = \\
\phantom{\vee\ } (l{=}[]) \\
\vee\ (\exists x, r, l_1.\ l=x{::}l_1 \wedge \m{allSPos}(l_1)\wedge \m{sum}(l,r) \wedge r{\geq}0)
\end{array}
$$
-->
<h2 id="example-3">Example 3</h2>
<pre class="language-ocaml" tabindex="0"><code class="language-ocaml"><span class="token keyword">let</span> foldr_ex3 l <span class="token operator">=</span> foldr <span class="token punctuation">(</span><span class="token keyword">fun</span> x r <span class="token operator">-></span> <span class="token keyword">if</span> x<span class="token operator">>=</span><span class="token number">0</span> <span class="token keyword">then</span> x<span class="token operator">+</span>r
                                    <span class="token keyword">else</span> raise Exc<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> l <span class="token number">0</span></code></pre>
<p>An exception can be modelled as an <em>interpreted</em> relation (more on the semantics of handlers in our ICFP 2024 paper<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup>).</p>
<!-- Given a pure function to describe lists containing only positive elements,

$$
\begin{array}{l}
\m{allPos}(l) = \\
\phantom{\vee\ } (l{=}[]) \\
\vee\ (\exists x, l_1.\ l=x{::}l_1 \wedge \m{allPos}(l_1)\wedge r{\geq}0)
\end{array}
$$

-->
<p>We can give a precise description of the conditions under which an exception is thrown via the following entailment.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.561ex;" xmlns="http://www.w3.org/2000/svg" width="56.45ex" height="2.056ex" role="img" focusable="false" viewBox="0 -716 27039.4 984.8" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-250-STX-MI-66" d="M-35-225C102-225 146-1 160 85L216 426L311 426L317 467L222 467L234 538C249 623 276 682 327 682C351 682 353 658 357 633C360 612 370 594 397 594C418 594 437 609 437 638C437 681 403 711 342 711C256 711 215 665 189 618C166 578 153 526 143 467L56 467L52 426L136 426L71 37C60-29 34-193-19-193C-57-193-24-104-84-104C-110-104-124-125-124-153C-124-188-99-225-35-225Z"></path><path id="MJX-250-STX-MI-6F" d="M206-10C345-10 453 125 453 284C453 389 400 479 281 479C139 479 35 340 35 180C35 66 95-10 206-10M216 25C141 25 123 94 123 169C123 292 170 445 274 445C345 445 363 378 363 297C363 178 312 25 216 25Z"></path><path id="MJX-250-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path><path id="MJX-250-STX-MI-64" d="M161-12C220-12 270 25 318 85L326 85C324 73 321 54 321 42C321 11 341-10 380-10C446-10 483 48 517 97L497 112C483 93 456 60 424 60C411 60 405 65 405 79C405 92 410 121 410 121L521 705L499 705L362 694L362 668C362 668 380 670 392 670C422 670 427 656 427 639C427 625 424 607 424 607L392 439L389 439C366 464 330 479 286 479C147 479 35 330 35 159C35 37 92-12 161-12M196 54C153 54 123 80 123 171C123 301 185 441 281 441C330 441 364 404 364 347C364 318 355 254 336 176C320 114 262 54 196 54Z"></path><path id="MJX-250-STX-MI-72" d="M134 0L165 143C204 238 277 395 318 395C321 395 331 358 363 358C389 358 416 377 416 421C416 460 392 479 361 479C280 479 219 326 188 259L178 259L229 476L207 476L68 465L68 438C68 438 88 440 99 440C127 440 132 429 132 410C132 392 127 366 123 348L49 0Z"></path><path id="MJX-250-STX-MI-65" d="M179-12C243-12 312 17 372 107L354 122C315 74 269 57 219 57C152 57 116 88 116 189C116 193 116 198 116 202C233 211 401 264 401 389C401 467 337 479 294 479C132 479 32 307 32 163C32 75 69-12 179-12M120 232C135 327 198 448 273 448C303 448 315 429 315 393C315 298 231 239 120 232Z"></path><path id="MJX-250-STX-MI-78" d="M323-10C388-10 432 59 460 102L439 118C415 86 394 62 368 62C334 62 316 101 288 191L267 259L328 356C345 384 360 398 381 398C398 398 416 388 435 388C458 388 480 402 480 436C480 463 466 479 431 479C368 479 330 427 304 382L255 298L252 298L240 349C227 403 207 447 183 475L168 475L32 459L32 429C45 431 54 432 65 432C125 432 144 405 170 322L198 230L126 126C87 70 69 69 65 69C49 69 23 82 3 82C-22 82-37 61-37 39C-37 16-22-9 21-9C81-9 114 38 146 90L210 194L214 194L239 93C255 28 274-10 323-10Z"></path><path id="MJX-250-STX-MI-33" d="M125-13C289-13 445 71 445 222C445 293 395 334 331 356L331 359C416 406 472 451 472 533C472 597 427 644 340 644C248 644 187 596 129 511L149 498C194 551 233 581 297 581C350 581 384 557 384 505C384 416 288 350 207 350L192 350L184 312L204 312C290 312 359 262 359 187C359 76 279 37 205 37C129 37 113 86 70 86C39 86 24 59 24 38C24 11 41-13 125-13Z"></path><path id="MJX-250-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-250-STX-I-1D459" d="M256 705L234 705L96 694L96 668C96 668 112 670 130 670C157 670 161 653 161 640C161 624 158 608 158 608L66 144C58 101 52 66 52 44C52 9 75-9 115-9C181-9 220 47 255 96L235 111C219 93 193 59 159 59C147 59 141 65 141 78C141 92 146 120 146 120Z"></path><path id="MJX-250-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-250-STX-MI-73" d="M164-11C277-11 316 55 316 113C316 177 280 214 237 260C193 307 142 343 142 385C142 414 163 449 215 449C274 449 307 400 310 323L334 323L357 479L338 479L312 452L309 452C297 459 260 479 207 479C116 479 71 425 71 357C71 295 118 260 159 221C197 185 233 150 233 96C233 44 201 23 155 23C87 23 61 69 51 156L26 156L0-11L22-11L46 16L49 16C63 10 101-11 164-11Z"></path><path id="MJX-250-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-250-STX-N-2291" d="M646 52L646 120L143 120L143 554L646 554L646 621L75 621L75 52M646-106L646-38L75-38L75-106Z"></path><path id="MJX-250-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-250-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-250-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-250-STX-N-A0" d=""></path><path id="MJX-250-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-250-STX-MI-50" d="M269 0L275 30C194 30 176 41 193 123L228 294C238 289 257 286 277 286C420 286 581 346 581 519C581 624 488 657 365 657L122 657L116 627C183 627 204 616 193 557L104 127C88 43 73 30-3 30L-9 0M235 331L293 614C315 616 326 618 347 618C448 618 484 573 484 507C484 379 399 327 282 327C261 327 247 329 235 331Z"></path><path id="MJX-250-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-250-STX-MI-75" d="M123-10C240-10 311 127 352 197L361 197C344 132 329 92 329 45C329 1 362-9 389-9C450-9 487 32 531 96L510 111C510 111 473 59 437 59C421 59 416 68 416 76C416 91 422 119 422 119L496 473L413 473L381 332C360 241 249 62 175 62C153 62 145 79 145 103C145 121 152 151 152 151L221 476L190 476L55 465L55 438C66 439 75 440 89 440C106 440 125 434 125 413C125 394 115 350 115 350L67 135C64 121 57 88 57 62C57 25 72-10 123-10Z"></path><path id="MJX-250-STX-MI-6D" d="M661-10C732-10 772 60 798 97L778 112C762 93 738 60 703 60C690 60 684 68 684 79C684 91 687 103 687 103L742 334C745 348 752 382 752 408C752 444 738 479 690 479C585 479 502 337 461 259L456 259L475 334C476 339 484 379 484 408C484 444 471 479 422 479C311 479 228 338 187 259L179 259L228 476L205 476L68 465L68 438C68 438 87 440 100 440C124 440 132 430 132 413C132 398 129 380 129 380L49 0L131 0L162 137C211 249 307 407 371 407C393 407 400 390 400 367C400 351 395 326 395 326C371 214 344 107 315 0L398 0L425 126C454 211 574 407 638 407C660 407 667 390 667 367C667 346 658 308 651 282L600 88C599 83 595 65 595 49C595 19 610-10 661-10Z"></path><path id="MJX-250-STX-N-2228" d="M604 549L531 549L319 106L105 549L32 549L314-30L324-30Z"></path><path id="MJX-250-STX-N-AC" d="M638 83L638 416L62 416L62 348L566 348L566 83Z"></path><path id="MJX-250-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-250-STX-MI-45" d="M506 0L560 186L528 186L528 185C464 65 450 38 296 39L175 39L232 320L342 320C434 320 452 309 436 226L467 226L514 458L482 458C466 377 442 358 350 358L240 358L293 618L432 618C555 618 577 593 572 493L603 493L630 657L118 657L112 627C194 627 204 611 188 535L100 112C86 42 62 30-7 30L-13 0Z"></path><path id="MJX-250-STX-MI-63" d="M183-13C273-13 336 46 376 108L359 123C329 85 290 57 225 57C150 57 117 95 117 183C117 300 176 446 282 446C313 446 330 434 330 419C330 403 311 375 311 349C311 327 325 314 349 314C386 314 405 346 405 386C405 451 354 479 292 479C152 479 34 337 34 167C34 58 85-13 183-13Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\m{foldr_ex3}(l,\res) \sqsubseteq \ens{\m{allPos}(l){\wedge}\m{sum}(l,\res) \vee \ens{\neg\m{allPos}(l)}; \m{Exc}()}
"><g data-mml-node="TeXAtom" data-latex="\mathit{foldr_ex3}" data-mjx-texclass="ORD"><g data-mml-node="msub" data-latex="oldr_x"><g data-mml-node="mi" data-latex="oldr"><use data-c="66" xlink:href="#MJX-250-STX-MI-66"></use><use data-c="6F" xlink:href="#MJX-250-STX-MI-6F" transform="translate(291,0)"></use><use data-c="6C" xlink:href="#MJX-250-STX-MI-6C" transform="translate(776,0)"></use><use data-c="64" xlink:href="#MJX-250-STX-MI-64" transform="translate(1049,0)"></use><use data-c="72" xlink:href="#MJX-250-STX-MI-72" transform="translate(1590,0)"></use></g><g data-mml-node="mi" transform="translate(2090.6,-260.4) scale(0.707)" data-latex="x"><use data-c="65" xlink:href="#MJX-250-STX-MI-65"></use><use data-c="78" xlink:href="#MJX-250-STX-MI-78" transform="translate(412,0)"></use></g></g><g data-mml-node="mn" data-latex="3" transform="translate(2771.4,0)"><use data-c="33" xlink:href="#MJX-250-STX-MI-33"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(3266.4,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-250-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(3623.4,0)"><use data-c="1D459" xlink:href="#MJX-250-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(3901.4,0)"><use data-c="2C" xlink:href="#MJX-250-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(4313.1,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-250-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-250-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-250-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(5475.1,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-250-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\sqsubseteq" transform="translate(6109.8,0)"><use data-c="2291" xlink:href="#MJX-250-STX-N-2291"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(7107.6,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-250-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-250-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-250-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(8669.6,0)"><use data-c="A0" xlink:href="#MJX-250-STX-N-A0"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{allPos}" data-mjx-texclass="ORD" transform="translate(8904.6,0)"><g data-mml-node="mi" data-latex="allPos"><use data-c="61" xlink:href="#MJX-250-STX-MI-61"></use><use data-c="6C" xlink:href="#MJX-250-STX-MI-6C" transform="translate(534,0)"></use><use data-c="6C" xlink:href="#MJX-250-STX-MI-6C" transform="translate(807,0)"></use><use data-c="50" xlink:href="#MJX-250-STX-MI-50" transform="translate(1080,0)"></use><use data-c="6F" xlink:href="#MJX-250-STX-MI-6F" transform="translate(1649,0)"></use><use data-c="73" xlink:href="#MJX-250-STX-MI-73" transform="translate(2134,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(11405.6,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-250-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(11762.6,0)"><use data-c="1D459" xlink:href="#MJX-250-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(12040.6,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-250-STX-N-29"></use></g><g data-mml-node="TeXAtom" data-latex="{\wedge}" data-mjx-texclass="ORD" transform="translate(12397.6,0)"><g data-mml-node="mo" data-latex="\wedge"><use data-c="2227" xlink:href="#MJX-250-STX-N-2227"></use></g></g><g data-mml-node="TeXAtom" data-latex="\mathit{sum}" data-mjx-texclass="ORD" transform="translate(13033.6,0)"><g data-mml-node="mi" data-latex="sum"><use data-c="73" xlink:href="#MJX-250-STX-MI-73"></use><use data-c="75" xlink:href="#MJX-250-STX-MI-75" transform="translate(367,0)"></use><use data-c="6D" xlink:href="#MJX-250-STX-MI-6D" transform="translate(924,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(14782.6,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-250-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(15139.6,0)"><use data-c="1D459" xlink:href="#MJX-250-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex="," transform="translate(15417.6,0)"><use data-c="2C" xlink:href="#MJX-250-STX-N-2C"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{res}" data-mjx-texclass="ORD" transform="translate(15829.3,0)"><g data-mml-node="mi" data-latex="res"><use data-c="72" xlink:href="#MJX-250-STX-MI-72"></use><use data-c="65" xlink:href="#MJX-250-STX-MI-65" transform="translate(383,0)"></use><use data-c="73" xlink:href="#MJX-250-STX-MI-73" transform="translate(795,0)"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(16991.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-250-STX-N-29"></use></g><g data-mml-node="mo" data-latex="\vee" transform="translate(17570.5,0)"><use data-c="2228" xlink:href="#MJX-250-STX-N-2228"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(18428.7,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-250-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-250-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-250-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(19990.7,0)"><use data-c="A0" xlink:href="#MJX-250-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\neg" transform="translate(20225.7,0)"><use data-c="AC" xlink:href="#MJX-250-STX-N-AC"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{allPos}" data-mjx-texclass="ORD" transform="translate(20945.7,0)"><g data-mml-node="mi" data-latex="allPos"><use data-c="61" xlink:href="#MJX-250-STX-MI-61"></use><use data-c="6C" xlink:href="#MJX-250-STX-MI-6C" transform="translate(534,0)"></use><use data-c="6C" xlink:href="#MJX-250-STX-MI-6C" transform="translate(807,0)"></use><use data-c="50" xlink:href="#MJX-250-STX-MI-50" transform="translate(1080,0)"></use><use data-c="6F" xlink:href="#MJX-250-STX-MI-6F" transform="translate(1649,0)"></use><use data-c="73" xlink:href="#MJX-250-STX-MI-73" transform="translate(2134,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(23446.7,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-250-STX-N-28"></use></g><g data-mml-node="mi" data-latex="l" transform="translate(23803.7,0)"><use data-c="1D459" xlink:href="#MJX-250-STX-I-1D459"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(24081.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-250-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(24438.7,0)"><use data-c="3B" xlink:href="#MJX-250-STX-N-3B"></use></g><g data-mml-node="TeXAtom" data-latex="\mathit{Exc}" data-mjx-texclass="ORD" transform="translate(24850.4,0)"><g data-mml-node="mi" data-latex="Exc"><use data-c="45" xlink:href="#MJX-250-STX-MI-45"></use><use data-c="78" xlink:href="#MJX-250-STX-MI-78" transform="translate(614,0)"></use><use data-c="63" xlink:href="#MJX-250-STX-MI-63" transform="translate(1067,0)"></use></g></g><g data-mml-node="mo" data-latex="(" transform="translate(26325.4,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-250-STX-N-28"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(26682.4,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-250-STX-N-29"></use></g></g></g></svg></mjx-container></div><p>The underlying logic is still symbolic-heap separation logic; we do not delegate effects to it.
Staged logic may thus be seen as a behavioral layer on top of separation logic, which excels when one is describing individual program states.</p>
<h1 id="conclusion">Conclusion</h1>
<p>We have described <em>staged logic</em>, a generalization of Hoare triples for specifying effectful higher-order programs and verifying them in an automated setting.</p>
<p>It fits well into the standard workflow of automated program verifiers:
given a program and a property it should satisfy,
a staged formula is derived from the program,
and the resulting entailment is automatically proved,
with lemmas and induction hypotheses provided by the user.</p>
<p>Since staged logic generalizes Hoare logic,
one can easily &quot;fall back&quot; to triples in cases where the expressiveness of stages is not needed,
and employ abstraction, invariants, and all the other techniques which have been developed for program proofs.
There is no need to always specify programs as disjunctions of paths, or always capture the ordering of every function call and effect,
however the crucial thing is that <em>the option to do so is available</em> where it makes specifications more natural.</p>
<p>Check out our paper<sup class="footnote-ref"><a href="#fn2" id="fnref2:3">2</a></sup> for the details.</p>
<p>These ideas have been implemented in a prototype verifier called <a href="https://github.com/hipsleek/heifer">Heifer</a>, which we hope will grow into a practical verification tool for real programs.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Taken from the <a href="https://iris-project.org/tutorial-pdfs/iris-lecture-notes.pdf">Iris lecture notes</a>, pg 32 <a href="#fnref1" class="footnote-backref"></a> <a href="#fnref1:1" class="footnote-backref"></a></p>
</li>
<li id="fn2" class="footnote-item"><p>Our FM24 paper may be found <a href="https://raw.githubusercontent.com/hipsleek/Heifer/StagedSL/docs/FM2024_TR.pdf">here</a> <a href="#fnref2" class="footnote-backref"></a> <a href="#fnref2:1" class="footnote-backref"></a> <a href="#fnref2:2" class="footnote-backref"></a> <a href="#fnref2:3" class="footnote-backref"></a></p>
</li>
<li id="fn3" class="footnote-item"><p>Our ICFP24 paper may be found <a href="https://www.comp.nus.edu.sg/~yahuis/ICFP24/ICFP2024.pdf">here</a> <a href="#fnref3" class="footnote-backref"></a></p>
</li>
</ol>
</section>

</div>

		</main>

		<footer>
			
		</footer>

		<!-- This page `/blog/staged-logic/` was built on 2025-10-29T09:40:23.874Z -->
		
	</body>
</html>
