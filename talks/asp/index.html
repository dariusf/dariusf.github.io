<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Answer Set Programming: Into the Multiverse</title>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/css/reveal.css"/>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/css/theme/simple.css" id="theme"/>

<link rel="stylesheet" href="default.css"/>
<link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/solarized-light.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide">
<h1 class="title">Answer Set Programming: Into the Multiverse</h1>
</section>

<section>
<section id="slide-org5564a94">
<h2 id="org5564a94">What? Why?</h2>
<ul>
<li>Practical logic programming</li>
<li>Expressive; easy to model search problems</li>
<li>Fast enough to be used in the Real World</li>

</ul>
</section>
<section id="slide-org582a183">
<h3 id="org582a183">Search problems?</h3>
<p>
Abstractly,
</p>
<ul>
<li>A search space</li>
<li>A goal</li>

</ul>
</section>
<section id="slide-org3515374">
<h3 id="org3515374">e.g. solving puzzles</h3>
<ul>
<li>Search space: game states</li>
<li>Goal: winning state</li>

</ul>
<img class="stretch" style="float: right" src="8puzzle.png">
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://people.cs.pitt.edu/~milos/courses/cs1571/Lectures/Class3.pdf">Milos Hauskrecht</a></p>
</section>
<section id="slide-orged645ad">
<h3 id="orged645ad">e.g. procedural generation</h3>
<ul>
<li>Search space: all fully-connected maps</li>
<li>Goal: a map traversable in n steps</li>

</ul>

<img class="stretch" style="float: right" src="map1.png">

<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://eis-blog.soe.ucsc.edu/2011/10/map-generation-speedrun/">A Map Generation Speedrun with Answer Set Programming, 2011</a></p>
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://course.ccs.neu.edu/cs5150f13/readings/smith_asp4pcg.pdf">Answer Set Programming for Procedural Content Generation: A Design Space Approach, 2011</a></p>
</section>
<section id="slide-org751aec6">
<h3 id="org751aec6">e.g. high-quality procedural generation</h3>
<ol>
<li>generate a puzzle</li>
<li>generate a puzzle that is solvable (i.e. generator is a solver)</li>
<li>generate a puzzle where there exists a solution of length n</li>
<li>generate a puzzle where <i>all solutions are of length n</i></li>

</ol>
<img class="stretch" style="float: right" src="https://ayumilove.files.wordpress.com/2010/09/refraction-2-1.jpg">
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://www.ericbutler.net/assets/papers/fdg2013_shortcuts.pdf">Quantifying over Play: Constraining Undesirable Solutions in Puzzle Design, 2013</a></p>
</section>
<section id="slide-org559c312">
<h3 id="org559c312">e.g. algorithmic composition</h3>
<ul>
<li>Search space: all sequences of notes</li>
<li>Goal: melodies which abide by the so-called &ldquo;Palestrina rules&rdquo; for Renaissance music</li>

</ul>
<blockquote>The composition of most styles of music is governed by rules... by formalising these rules in a suitable logical language, powerful and expressive intelligent composition tools can be easily built.</blockquote>
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://arxiv.org/abs/1006.4948">Automatic Music Composition using Answer Set Programming, 2010</a></p>
</section>
<section id="slide-org6d6dcde">
<h3 id="org6d6dcde">e.g. dependency resolution</h3>
<ul>
<li>Search space: all possible package configurations</li>
<li>Goal: a set of package versions which satisfies all dependency constraints</li>

</ul>
<img class="stretch" style="float: right" src="https://miro.medium.com/max/1072/0*micRkkPRrafLdQNF.png">
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://potassco.org/aspcud/">aspcud</a></p>
</section>
<section id="slide-orga8a1e36">
<h3 id="orga8a1e36">e.g. PI Planning</h3>
<ul>
<li>Search space: all possible plans (ticket-sprint assignments)</li>
<li>Goal: a plan subject to lots of unspoken constraints&#x2026;</li>

</ul>
<img class="stretch" style="float: right" src="tool.png">
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://asankhaya.github.io/pdf/Automating-Continuous-Planning-in-SAFe.pdf">Automating Continuous Planning in SAFe, 2020</a></p>
</section>
<section id="slide-org8888dd3">
<h3 id="org8888dd3">&ldquo;Optimized brute force&rdquo;</h3>
<p>
Appropriate when:
</p>

<ul>
<li>brute force is the best one can do (NP-hard)</li>
<li>domain isn&rsquo;t fully understood; rapid prototyping &gt; asymptotics</li>
<li>constraints are nontrivial and would eventually require search</li>

</ul>
</section>
</section>
<section>
<section id="slide-orgbc5afac">
<h2 id="orgbc5afac">Programming</h2>
<p>
&ldquo;Generate and test&rdquo;
</p>

<ul>
<li>Define search space</li>
<li>Remove unwanted parts</li>

</ul>
</section>
<section id="slide-orgd5d9043">
<h3 id="orgd5d9043">&ldquo;Generate and Test&rdquo;</h3>
<blockquote>Trial and error is also a heuristic method of problem solving, repair, tuning, or obtaining knowledge. In the field of computer science, the method is called <b>generate and test</b> (Brute force). In elementary algebra, when solving equations, it is <b>guess and check</b>.</blockquote>
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://en.wikipedia.org/wiki/Trial_and_error">Trial and error, Wikipedia</a></p>
</section>
<section id="slide-org7ebb468">
<h3 id="org7ebb468">&ldquo;Guess and Check&rdquo;</h3>
<blockquote>There are 15 puppies and birds at a pet shop. There are 42 legs altogether. How many puppies are there?</blockquote>
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://practicle.sg/guess-and-check/">Learn Guess and Check, practicle.sg</a></p>
</section>
<section id="slide-org000ae90">
<h3 id="org000ae90">Facts</h3>
<div class="org-src-container">

<pre><code class=" erlang" >animal(puppy).
animal(bird).

legs(puppy,4).
legs(bird,2).

animal_n(1..15).
</code></pre>
</div>
</section>
<section id="slide-orgb9e8934">
<h3 id="orgb9e8934">Rules</h3>
<div class="org-src-container">

<pre><code class=" erlang" >bipedal(A) :- animal(A), legs(A,2).
</code></pre>
</div>
<p>
&ldquo;A thing A is bipedal if it is a two-legged animal.&rdquo;
</p>
</section>
<section id="slide-orgffa5d50">
<h3 id="orgffa5d50">Answer Sets</h3>
<div class="org-src-container">

<pre><code class=" erlang" >bipedal(A) :- animal(A), legs(A,2).
</code></pre>
</div>

<pre  class="example">
$ clingo animals.lp
clingo version 5.4.0
Reading from animals.lp
Solving...
Answer: 1
animal_n(1) animal_n(2) animal_n(3) animal_n(4) animal_n(5) animal_n(6) animal_n(7) animal_n(8) animal_n(9) animal_n(10) animal_n(11) animal_n(12) animal_n(13) animal_n(14) animal_n(15) legs(puppy,4) legs(bird,2) animal(puppy) animal(bird) bipedal(bird)
SATISFIABLE

Models       : 1
Calls        : 1
Time         : 0.024s (Solving: 0.00s 1st Model: 0.00s Unsat: 0.00s)
CPU Time     : 0.001s
</pre>
</section>
<section id="slide-org0bbdf94">
<h3 id="org0bbdf94">Choice Rules</h3>
<p>
Define search space, or &ldquo;possible worlds&rdquo;:
</p>
<div class="org-src-container">

<pre><code class=" erlang" >animal(bird).
{ animal(puppy) }.
</code></pre>
</div>

<pre  class="example">
$ clingo animals.lp
clingo version 5.4.0
Reading from animals.lp
Solving...
Answer: 1
animal(bird)
Answer: 2
animal(bird) animal(puppy)
SATISFIABLE

Models       : 2
Calls        : 1
Time         : 0.021s (Solving: 0.00s 1st Model: 0.00s Unsat: 0.00s)
CPU Time     : 0.001s
</pre>

<img style="position: absolute; height: 20%; top: 50%; left: 50%;" src="dog.png">
</section>
<section id="slide-org5c0f983">
<h3 id="org5c0f983">Choice Rules</h3>
<p>
Generate every possible pet shop&#x2026; all \(2^{15}\) of them:
</p>
<div class="org-src-container">

<pre><code class=" erlang" >{ animal_at_shop(A, N) : animal(A) } = 1 :- animal_n(N).
</code></pre>
</div>

<pre  class="example">
SATISFIABLE
Models       : 32768
Calls        : 1
Time         : 3.294s (Solving: 3.27s 1st Model: 0.00s Unsat: 0.00s)
CPU Time     : 0.249s
</pre>
</section>
<section id="slide-org3339cf7">
<h3 id="org3339cf7">Integrity Constraints</h3>
<p>
Remove possible worlds:
</p>
<div class="org-src-container">

<pre><code class=" erlang" >animal(bird).
{ animal(puppy) }.
:- animal(puppy).
</code></pre>
</div>

<pre  class="example">
$ clingo -n 0 animals.lp
clingo version 5.4.0
Reading from animals.lp
Solving...
Answer: 1
animal(bird)
SATISFIABLE

Models       : 1
Calls        : 1
Time         : 0.013s (Solving: 0.00s 1st Model: 0.00s Unsat: 0.00s)
CPU Time     : 0.001s
</pre>
</section>
<section id="slide-org47e03a1">
<h3 id="org47e03a1">Integrity Constraints</h3>
<p>
Remove every world without the right number of legs:
</p>
<div class="org-src-container">

<pre><code class=" erlang" >correct_number_of_legs :- legs_total(42).
:- not correct_number_of_legs.
</code></pre>
</div>
</section>
<section id="slide-orgcd05aa4">
<h3 id="orgcd05aa4">Aggregates</h3>
<div class="org-src-container">

<pre><code class=" erlang" >legs_total(L) :-
  L = #sum { N,M : animal_at_shop(A, M), legs(A, N) }.

animal_count(A,N) :-
  N = #count { M : animal_at_shop(A, M) }, animal(A).
</code></pre>
</div>
</section>
<section id="slide-orga994c01">
<h3 id="orga994c01">Directives</h3>
<div class="org-src-container">

<pre><code class=" erlang" >#show animal_count/2.
#project animal_count(A,N).
</code></pre>
</div>
</section>
<section id="slide-orgfdab24b">
<h3 id="orgfdab24b">Putting it all together</h3>
<div class="org-src-container">

<pre><code class=" erlang" >animal(puppy;bird).
legs(puppy,4).
legs(bird,2).
animal_n(1..15).
{ animal_at_shop(A, N) : animal(A) } = 1 :- animal_n(N).
correct_number_of_legs :- legs_total(42).
:- not correct_number_of_legs.
legs_total(L) :- L = #sum { N,M : animal_at_shop(A, M), legs(A, N) }.
animal_count(A,N) :- N = #count { M : animal_at_shop(A, M) }, animal(A).
#show animal_count/2.
#project animal_count(A,N).
</code></pre>
</div>
</section>
<section id="slide-orgf97a0db">
<h3 id="orgf97a0db">Running</h3>
<pre  class="example">
$ clingo -n 0 animals.lp --project
clingo version 5.4.0
Reading from animals.lp
Solving...
Answer: 1
animal_count(puppy,6) animal_count(bird,9)
SATISFIABLE

Models       : 1
Calls        : 1
Time         : 0.271s (Solving: 0.26s 1st Model: 0.00s Unsat: 0.26s)
CPU Time     : 0.268s
</pre>
</section>
<section id="slide-orgb50448e">
<h3 id="orgb50448e">&ldquo;Generate and Test&rdquo;</h3>
<ul>
<li>Define search space using facts, rules, and aggregates</li>
<li>Remove unwanted parts using integrity constraints</li>

</ul>
</section>
</section>
<section>
<section id="slide-org8c8c0d3">
<h2 id="org8c8c0d3">PI Planning + ASP</h2>
<img class="stretch" style="float: right" src="tool.png">
</section>
<section id="slide-org83534bb">
<h3 id="org83534bb">Facts</h3>
<div class="org-src-container">

<pre><code class=" erlang" >sprint(1..1).
task(1..2).

task_weight(2,1).
task_depends_on(1,2).
sprint_capacity(1,1).
</code></pre>
</div>
<img class="stretch" style="float: right" src="tool.png">
</section>
<section id="slide-org86256c7">
<h3 id="org86256c7">Sprint Capacity</h3>
<div class="org-src-container">

<pre><code class=" erlang" >sprint(unassigned).

{ assign(T,S) : sprint(S) } = 1 :- task(T).

sprint_total(S,To) :-
  To = #sum { W,T : task_weight(T,W), assign(T,S) }, sprint(S).

:- sprint_total(S,A), sprint(S),
  sprint_capacity(S,E), A &gt; E, S != unassigned.

unassigned_count(D) :- D = #count { T : assign(T,unassigned) }.
#minimize { D : unassigned_count(D) }.
</code></pre>
</div>
</section>
<section id="slide-org1f7393f">
<h3 id="org1f7393f">Dependencies</h3>
<div class="org-src-container">

<pre><code class=" erlang" >:- assign(T1,S1), assign(T2,S2), task_depends_on(T1,T2), S1 &lt; S2.
</code></pre>
</div>
</section>
<section id="slide-orgdcb7f68">
<h3 id="orgdcb7f68">Pins</h3>
<div class="org-src-container">

<pre><code class=" erlang" >:- not assign(1,2).
</code></pre>
</div>
</section>
<section id="slide-orgd63f41f">
<h3 id="orgd63f41f">Design Choices</h3>
<ul>
<li>Don&rsquo;t solve for assignments globally</li>
<li>Don&rsquo;t solve on keypress&#x2026;</li>
<li>Where to run solver?</li>
<li>Intuitiveness of assignments?</li>

</ul>
</section>
</section>
<section>
<section id="slide-orgfa26e10">
<h2 id="orgfa26e10">Potpourri</h2>
<ul>
<li>Performance</li>
<li>Random sampling</li>
<li>Debugging</li>
<li>Ecosystem</li>

</ul>
</section>
<section id="slide-orga486f77">
<h3 id="orga486f77">clingo runs forever!</h3>
<ul>
<li>Variables are replaced with concrete values before any solving starts (&ldquo;grounding&rdquo;)</li>
<li>Wide relations will cause blowup</li>
<li>Denormalize</li>
<li>More efficient encodings</li>

</ul>
</section>
<section id="slide-org810e984">
<h3 id="org810e984">Random sampling</h3>
<pre  class="example">
--rand-freq=1 --seed=39403
</pre>
</section>
<section id="slide-org29f4106">
<h3 id="org29f4106">Debugging</h3>
<pre  class="example">
Solving...
UNSATISFIABLE

Models       : 0
</pre>
</section>
<section id="slide-org94d6fd9">
<h3 id="org94d6fd9">Debugging</h3>
<blockquote>Removing a goal can make a predicate at most more general, never more specific.</blockquote>
<p style="font-size: 0.5em; clear:right; text-align:right;"><a href="https://www.metalevel.at/prolog/debugging">Declarative Debugging, The Power of Prolog</a></p>
</section>
<section id="slide-orgd8b4281">
<h3 id="orgd8b4281">Debugging</h3>
<ul>
<li>Bisect program!</li>
<li>Give names to integrity constraints so invalid worlds can be inspected</li>
<li>Unfortunately, have to modify program</li>

</ul>
</section>
<section id="slide-org731dffe">
<h3 id="org731dffe">Ecosystem</h3>
<ul>
<li>Unit tests: <a href="https://github.com/rndmcnlly/ansunit">AnsUnit</a></li>
<li>ORM: <a href="https://github.com/potassco/clorm">clorm</a></li>
<li>IDE: <a href="http://www.sealion.at/">SeaLion</a></li>
<li>Visualization toolkit: <a href="https://github.com/idaks/PW-explorer">Possible Worlds Explorer</a></li>
<li>PCG: <a href="https://github.com/dariusf/exnihilo">Ex Nihilo</a></li>

</ul>
<img class="stretch" src="sealion.png">
</section>
</section>
<section>
<section id="slide-org9b133aa">
<h2 id="org9b133aa">Limitations</h2>
<div class="outline-text-2" id="text-org9b133aa">
</div>
</section>
<section id="slide-org6c86004">
<h3 id="org6c86004">&ldquo;Declarative&rdquo;</h3>
<ul>
<li>Small changes can drastically affect performance</li>
<li>Correctness is not obvious</li>
<li>Translations of imperative concepts can be difficult</li>
<li>Unfamiliar</li>

</ul>
</section>
<section id="slide-orgfbe1394">
<h3 id="orgfbe1394">Black box</h3>
<ul>
<li>By design</li>
<li>Efficient encodings are hard for non-experts</li>
<li>No e.g. global constraints</li>

</ul>
</section>
</section>
<section>
<section id="slide-org6e9089d">
<h2 id="org6e9089d">Conclusion</h2>
<ul>
<li>Useful for a class of problems</li>
<li>Rapid prototyping</li>
<li>Nice formalism that works in practice</li>

</ul>
</section>
<section id="slide-orgd06859f">
<h3 id="orgd06859f">Further Reading</h3>
<ul>
<li><a href="https://www.cs.utexas.edu/users/vl/teaching/378/ASP.pdf">Answer Set Programming, Lifschitz</a></li>
<li><a href="http://ceur-ws.org/Vol-546/49-63.pdf">A Pragmatic Programmer&rsquo;s Guide to Answer Set Programming</a></li>
<li><a href="https://github.com/potassco/guide">Clingo user guide</a></li>

</ul>
</section>
</section>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/lib/js/head.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: false,
slideNumber: false,
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: false,
hashOneBasedIndex: false,
pdfSeparateFragments: true,

overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'linear', // see README of reveal.js for options
transitionSpeed: 'default',

// Optional libraries used to extend reveal.js
dependencies: [
 { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
 { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } }]

});
</script>
</body>
</html>
