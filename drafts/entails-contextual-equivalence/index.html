<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">

		<meta property="og:title" content="Darius Foo">
		<meta property="og:type" content="article">
		<meta property="og:url" content="https://dariusf.github.io">
		<meta property="og:image" content="https://dariusf.github.io/avatar.png">

		<title>From entailment to contextual refinement</title>
		<meta name="description" content="PhD student, programming languages and formal verification">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Darius Foo">


		

		

		

		

		
		
		<style>@media (prefers-color-scheme: light) { /**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
 }
@media (prefers-color-scheme: dark) { /**
 * prism.js tomorrow night eighties for JavaScript, CoffeeScript, CSS and HTML
 * Based on https://github.com/chriskempson/tomorrow-theme
 * @author Rose Pritchard
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #ccc;
	background: none;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;

}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #2d2d2d;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.block-comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #999;
}

.token.punctuation {
	color: #ccc;
}

.token.tag,
.token.attr-name,
.token.namespace,
.token.deleted {
	color: #e2777a;
}

.token.function-name {
	color: #6196cc;
}

.token.boolean,
.token.number,
.token.function {
	color: #f08d49;
}

.token.property,
.token.class-name,
.token.constant,
.token.symbol {
	color: #f8c555;
}

.token.selector,
.token.important,
.token.atrule,
.token.keyword,
.token.builtin {
	color: #cc99cd;
}

.token.string,
.token.char,
.token.attr-value,
.token.regex,
.token.variable {
	color: #7ec699;
}

.token.operator,
.token.entity,
.token.url {
	color: #67cdcc;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}

.token.inserted {
	color: green;
}
 }
/* This is an arbitrary CSS string added to the bundle */
:root {
	/* --font-family: -apple-system, system-ui, sans-serif; */
	/* --font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
	*/

    --font-family-monospace: Fira Code, Menlo, Consolas, Monaco, Liberation Mono, Lucida Console, monospace;


  /*    --text-font: Crimson Text, serif;*/
  /*    --text-font: Poppins, Verdana, sans-serif;*/
  /*    --heading-font: Quicksand, sans-serif;*/
  /*    --text-font: Open Sans, sans-serif;*/
  /*    --text-font-size: 16px;*/
  /*    --heading-font: Open Sans, sans-serif;*/
  /*    --text-font: Cabin, sans-serif;*/
  /*    --text-font-size: 16px;*/
  /*    --text-font: Roboto, sans-serif;*/

  /*    --heading-font: Roboto, sans-serif;*/
  /*    --heading-font: Cabin, sans-serif;*/
  /*    --heading-font: Dosis, sans-serif;*/

  /*    --heading-font: Work Sans, sans-serif;*/
  /*    --text-font: Open Sans, sans-serif;*/

      /* --heading-font: Nunito, sans-serif; */
      --heading-font: ui-rounded, 'Hiragino Maru Gothic ProN', Quicksand, Comfortaa, Manjari, 'Arial Rounded MT', 'Arial Rounded MT Bold', Calibri, source-sans-pro, sans-serif;
  /*    --text-font: PT Sans, sans-serif;*/

  /*    --heading-font: Varela Round, sans-serif;*/
  /*    --text-font: Noto Serif, serif;*/

  /*    --text-font: Lato, sans-serif;*/
      --text-font-size: 17px;

  /*    --text-font: Merriweather, sans-serif;*/
  /*    --text-font-size: 16px;*/

  /* https://css-tricks.com/snippets/css/system-font-stack/ */
  /* https://systemfontstack.com/ */

    /* system font on all platforms */
  /*    --heading-font: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu;*/
      /* --text-font: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu; */
      --text-font: -apple-system, system-ui, sans-serif;
			/* system-ui, sans-serif; */


/* Theme colors */

	/* --color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333; */

	--background-color: #fff;

	/* --text-color: var(--color-gray-90); */
	/* --text-color-link: #082840; */

	/* --text-color-link: #ff0000; */
	/* --text-color-link-active: #5f2b48; */
	/* --text-color-link-visited: #17050F; */


	/* --syntax-tab-size: 2; */

	--bright-text-color: #222;
	--link-color: #3273dc;
	/* --link-color: #ff5e6c; */
	--link-visited-color: #6e4bbe;
	--background-color: #fff;
	--text-color: #444;
	--faded-text-color: #777;
	--blockquote-text-color: var(--bright-text-color);
	--faint-color: #ccc;
}

@media (prefers-color-scheme: dark) {
	:root {
		/* --color-gray-20: #e0e0e0; */
		/* --color-gray-50: #C0C0C0; */
		/* --color-gray-90: #dad8d8; */

		/* --text-color is assigned to --color-gray-_ above */
		/* --text-color-link: #1493fb; */
		/* --text-color-link-active: #6969f7; */
		/* --text-color-link-visited: #a6a6f8; */

		--background-color: #15202b;

		--bright-text-color: #eee;
		--link-color: #8cc2dd;
		--link-visited-color: #b9a9e0;
		--background-color: #333;
		--text-color: #ddd;
		--faded-text-color: #aaa;
		--slightly-dimmer-text-color: #ccc;
		--blockquote-text-color: var(--slightly-dimmer-text-color);
		--faint-color: #666;

		color-scheme: dark; /* sets scrollbar colour */
	}

	.theme-affected {
		filter: invert(.8);
	}
}

body {
	box-sizing: border-box;

	/* https://github.com/sindresorhus/github-markdown-css */
	min-width: 200px;
	/* max from old blog */
	/* max-width: 40em; */
	/* tiny bit wider because prism adds some padding */
	max-width: 726px;

	margin: 0 auto;
	padding: 0 20px;

	/* enable ligatures */
	text-rendering: optimizeLegibility;

	font-family: var(--text-font);
	font-size: var(--text-font-size);
	color: var(--text-color);
	background-color: var(--background-color);

	/*
	text-align: left;
	word-wrap: break-word;
	overflow-wrap: break-word;
	*/
	/* line-height: 1.5; */
}

@media (max-width: 767px) {
	body {
		padding: 0px 1em;
	}
}

@view-transition {
	navigation: auto;
}

html {
	overflow-y: scroll;
}

/* https://github.com/Kimeiga/bahunya/blob/master/src/parts/_typography.css */
ul, ol {
  padding-left: 2em;
}

li {
	line-height: 1.5;
}

h1, h2, h3, h4, h5, h6 {
	font-family: var(--heading-font);
	color: var(--bright-text-color);
	font-weight: normal;
	line-height: 1.25;
}

footer {
	padding: 35px;
}

/* header {
	border-bottom: 1px dashed var(--color-gray-20);
} */


/* misc changes from here on */

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

p:has(img) {
	text-align: center;
}
/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
/* img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
} */
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

a[href] {
	color: var(--link-color);
	text-decoration: none;
}

/* a[href]:visited {
	color: var(--link-visited-color);
} */

/* a[href]:hover,
a[href]:active { */
	/* color: var(--text-color-link-active); */
	/* text-decoration: underline; */
	/* text-decoration-thickness: 2px; */
/* } */

/* main :first-child {
	margin-top: 0;
} */

/* .links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
} */

table {
	margin: 1em 0;
	border-collapse: collapse;
}
table td,
table th {
	padding-right: 1em;
}
/* table thead tr th {
  border-bottom: solid var(--text-color) 2px;
  border-top: solid var(--text-color) 2px;
} */

.table-lines td {
  border-bottom: solid var(--text-color) 1px;
  border-top: solid var(--text-color) 1px;
}

/* pre,
code {
	font-family: var(--font-family-monospace) !important;
	font-size: 14px !important;
} */

/* override prism */
/* https://github.com/orgs/PrismJS/discussions/2859 */
code[class*="language-"],
pre[class*="language-"] {
	font-family: var(--font-family-monospace);
	font-size: 14px;
}

pre[class*="language-"] {
	margin-top: 0;
	margin-bottom: 1em;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	/* -moz-tab-size: var(--syntax-tab-size); */
	/* -o-tab-size: var(--syntax-tab-size); */
	/* tab-size: var(--syntax-tab-size); */
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}

.scroll-when-overflowing, pre {
	overflow-x: scroll;
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}

.scroll-when-overflowing::-webkit-scrollbar, pre::-webkit-scrollbar {
  display: none;
}

/* mathjax v4, where display math is not centered */
mjx-container {
	margin: auto;
}
header {
			/* display: flex; */
			/* gap: 2em; */
			border-right: 10px;
			/* flex-wrap: wrap; */
			/* justify-content: space-between; */
			/* align-items: center; */
			align-items: end;
			padding-top: 1em;
			/* padding: 1em; */
		}
.nav-item {
				font-family: var(--heading-font);
				padding-right: 5px;
				display: inline-block;
			}
			
			.nav-item a[href][aria-current="page"] {
				text-decoration: underline;
				text-decoration-thickness: 2px;
			}</style>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		

		<header>

			
			
			
			<a href="/" style="padding-right: 10px; color: var(--text-color); font-family: var(--heading-font); font-size: 1.5em;">Darius Foo</a>
			
				
				
				
				
				
				
			
			
			<nav style="display: inline-block">
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul style="list-style: none; padding: 0; margin: 0;">
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/research/">Research</a></li>
					<li class="nav-item"><a href="/work/">Work</a></li>
					<li class="nav-item"><a href="/games/">Games</a></li>
				</ul>
			</nav>
		</header>

		<main id="skip">
			

<h1 style="margin-top: 1rem; margin-bottom: 0.2em" id="from-entailment-to-contextual-refinement">From entailment to contextual refinement</h1>



<div class="post-metadata">
	
	<time style="font-size: 0.9em;" datetime="2025-10-29">29 Oct 2025</time>
	
	
</div>

<div class="blog-content">
<div style="display:none">
<p><mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\m}[1]{\mathit{#1}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\flow}{\varphi}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\sreq}[1]{\mathbf{req}\ #1}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\sens}[1]{\mathbf{ens}\ #1}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\sensr}[2]{\mathbf{ens}\ #1. #2}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\defeq}{\triangleq}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\entails}{\sqsubseteq}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\implies}{\Rightarrow}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\ctxrefines}{\preceq}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\ctxequiv}{\equiv^{ctx}}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\app}[2]{#1\ #2}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\vlambda}[2]{\lambda #1. #2}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\bigstep}[4]{\langle #1, #2 \rangle \to \langle #3, #4 \rangle}"></g></g></svg></mjx-container>
<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="0.033ex" height="0.033ex" role="img" focusable="false" viewBox="0 0 16 16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\newcommand{\bind}[1]{; #1.}"></g></g></svg></mjx-container></p>
</div>
<p>This post is about one particularly thorny obstacle on the journey to developing a mechanisation of staged logic for my PhD thesis.</p>
<p>First, some background on staged logic.
It is a specification logic for higher-order programs with effects.</p>
<p>Here is the syntax of its formulae. It is an untyped lambda calculus with specifications and logical connectives. <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.029ex;" xmlns="http://www.w3.org/2000/svg" width="1.19ex" height="1.017ex" role="img" focusable="false" viewBox="0 -473 570 487" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-269-STX-I-1D70E" d="M568 473C533 472 489 469 443 469C395 469 345 472 300 472C139 472 41 350 41 165C41 92 68-14 194-14C337-14 442 87 443 246C444 310 412 361 399 381C398 382 398 383 397 384L397 388C423 387 437 387 460 387C536 387 563 429 570 459M359 390C375 355 387 319 387 268C387 115 292 69 208 69C143 69 89 105 90 192C90 331 190 391 286 391C310 391 335 390 359 390Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\sigma"><g data-mml-node="mi" data-latex="\sigma"><use data-c="1D70E" xlink:href="#MJX-269-STX-I-1D70E"></use></g></g></g></svg></mjx-container> is some formula for describing program states, like a heap formula from separation logic.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -3.706ex;" xmlns="http://www.w3.org/2000/svg" width="50.056ex" height="8.455ex" role="img" focusable="false" viewBox="0 -2275 23976.7 4050" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-270-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-270-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-270-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-270-STX-N-A0" d=""></path><path id="MJX-270-STX-B-1D42B" d="M327 0L327 40C256 40 230 51 230 116L230 322C253 348 274 367 296 367C312 367 335 325 379 325C409 325 440 348 440 406C440 457 415 488 363 488C300 488 285 448 232 378L228 378L228 482L175 482L18 451L18 408C18 408 29 410 49 410C84 410 91 390 91 354L91 109C91 53 82 40 17 40L17 0Z"></path><path id="MJX-270-STX-B-1D41E" d="M254-11C402-11 442 68 484 146L458 164C425 123 385 97 307 97C222 97 174 140 174 257L478 257C476 408 393 485 267 485C137 485 27 406 27 234C27 75 108-11 254-11M173 304C177 401 197 441 253 441C306 441 321 386 321 304Z"></path><path id="MJX-270-STX-B-1D42A" d="M564-220L564-179C508-179 500-160 500-110L500 480L429 480L391 449C343 476 301 485 260 485C109 485 30 384 30 221C30 93 87-10 199-10C266-10 313 23 353 56L356 56L356-101C356-160 346-179 262-179L262-220M266 73C199 73 185 153 185 261C185 371 217 426 270 426C311 426 336 403 356 364L356 109C333 92 308 73 266 73Z"></path><path id="MJX-270-STX-I-1D70E" d="M568 473C533 472 489 469 443 469C395 469 345 472 300 472C139 472 41 350 41 165C41 92 68-14 194-14C337-14 442 87 443 246C444 310 412 361 399 381C398 382 398 383 397 384L397 388C423 387 437 387 460 387C536 387 563 429 570 459M359 390C375 355 387 319 387 268C387 115 292 69 208 69C143 69 89 105 90 192C90 331 190 391 286 391C310 391 335 390 359 390Z"></path><path id="MJX-270-STX-N-2223" d="M170-194L170 706L102 706L102-194Z"></path><path id="MJX-270-STX-B-1D427" d="M298 0L298 40C232 40 227 57 227 112L227 345C255 372 289 389 327 389C377 389 405 362 405 268L405 112C405 56 398 40 339 40L339 0L614 0L614 40C556 40 545 57 545 112L545 290C545 422 487 485 390 485C322 485 279 450 228 400L224 400L224 482L172 482L18 453L18 412C18 412 28 414 45 414C73 414 86 406 86 369L86 112C86 57 83 40 17 40L17 0Z"></path><path id="MJX-270-STX-B-1D42C" d="M69-12L91 16L93 16C130 0 152-12 214-12C316-12 408 21 408 133C408 221 352 252 258 296C188 329 150 346 150 389C150 418 168 438 216 438C269 438 310 413 339 313L383 313L383 476L339 476L324 451L322 451C297 466 264 485 201 485C91 485 31 428 31 341C31 258 86 226 164 188C243 149 278 130 278 89C278 51 247 37 204 37C129 37 97 80 77 177L33 177L33-12Z"></path><path id="MJX-270-STX-I-1D45F" d="M161 259L212 476L190 476L51 465L51 438C51 438 71 440 82 440C110 440 115 429 115 410C115 392 110 366 106 348L32 0L117 0L147 140C163 180 253 395 301 395C304 395 314 358 346 358C372 358 399 377 399 421C399 460 375 479 343 479C263 479 203 326 171 259Z"></path><path id="MJX-270-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-270-STX-N-53" d="M440 467L433 667L407 667C402 646 392 638 376 638C352 638 330 669 239 669C135 668 49 612 49 507C49 402 130 354 210 308C292 261 376 226 376 138C376 62 329 32 254 32C152 31 101 63 66 201L35 201L44-15L75-15C76 5 88 18 102 18C125 18 164-12 268-12C384-12 471 51 471 167C471 286 372 331 283 381C208 424 136 460 136 535C136 597 175 629 243 629C344 630 382 577 410 467Z"></path><path id="MJX-270-STX-N-70" d="M176 482L151 482L25 454L25 425C25 425 44 427 57 427C90 427 95 414 95 376L95-119C95-175 85-192 22-192L22-220L275-220L275-191C197-191 178-178 178-113L178 18L182 18C211-2 245-10 283-10C403-10 502 91 502 261C502 392 433 485 334 485C275 485 227 454 179 398L176 398M178 356C197 381 240 417 293 417C367 417 411 359 411 233C411 94 358 29 288 29C232 29 197 74 178 95Z"></path><path id="MJX-270-STX-N-65" d="M415 143C383 101 352 65 271 65C191 65 115 128 115 266L431 266C426 406 354 485 245 485C128 485 34 405 34 238C34 77 127-10 247-10C350-10 398 53 434 129M114 303C122 396 162 445 230 445C301 445 334 377 337 303Z"></path><path id="MJX-270-STX-N-63" d="M408 148C363 90 329 65 264 65C161 65 112 151 112 273C112 388 161 448 242 448C328 448 295 334 369 334C397 334 411 350 411 379C411 437 353 485 259 485C115 485 33 383 33 226C33 87 108-10 233-10C340-10 389 53 427 134Z"></path><path id="MJX-270-STX-N-69" d="M257 28C190 28 185 43 185 101L185 482L159 482L33 454L33 425C33 425 44 427 58 427C87 427 102 423 102 380L102 101C102 44 99 28 32 28L32 0L257 0M145 673C110 673 88 647 88 617C88 586 111 560 145 560C180 560 202 586 202 617C202 647 180 673 145 673Z"></path><path id="MJX-270-STX-N-66" d="M26 468L26 426L102 426L102 119C102 41 91 29 18 29L18 0L287 0L287 29C204 29 185 41 185 119L185 426L307 426L307 468L185 468L185 562C185 646 196 676 233 676C283 676 288 600 338 600C361 600 379 614 379 643C379 688 332 713 267 713C197 713 161 686 134 640C108 594 102 549 102 468Z"></path><path id="MJX-270-STX-N-61" d="M308 62C314 18 324-5 368-5C419-5 443 16 476 64L461 80C447 65 433 55 414 55C393 55 384 63 384 104L384 331C384 435 343 485 234 485C125 485 58 431 58 375C58 342 80 327 100 327C128 327 144 342 144 373C144 433 154 454 211 454C271 454 301 421 301 334L301 290C215 263 38 237 38 105C38 41 80-7 157-7C221-7 257 21 304 62M301 92C267 64 231 48 198 48C155 48 126 79 126 129C126 207 210 234 301 257Z"></path><path id="MJX-270-STX-N-74" d="M293 90C268 62 255 49 223 49C184 49 175 73 175 144L175 426L288 426L288 468L175 468L176 610L150 610C114 525 84 478 37 449L37 426L92 426L92 116C92 26 121-10 188-10C252-10 273 20 312 74Z"></path><path id="MJX-270-STX-N-6F" d="M258 485C123 485 34 387 34 242C34 80 118-10 258-10C388-10 480 78 480 246C480 394 395 485 258 485M254 447C343 447 388 364 388 241C388 78 344 30 262 30C176 29 127 96 127 255C127 383 178 447 254 447Z"></path><path id="MJX-270-STX-N-6E" d="M481 307C481 422 438 485 347 485C284 485 240 449 186 401L182 401L183 482L160 482L33 453L33 424C33 424 43 426 60 426C87 426 102 418 102 382L102 101C102 45 99 28 32 28L32 0L261 0L261 28C189 28 185 45 185 101L185 358C215 385 252 421 306 421C351 421 398 402 398 282L398 101C398 45 395 28 324 28L324 0L555 0L555 28C488 28 481 45 481 101Z"></path><path id="MJX-270-STX-N-73" d="M39 164L42-8L63-8L84 15L86 15C112 4 142-11 200-11C290-11 368 25 368 119C368 193 319 230 228 278C144 321 111 346 111 385C111 430 146 451 192 451C253 451 290 422 312 327L339 327L336 480L316 480L299 459L298 459C273 471 243 485 193 485C107 485 40 441 40 359C40 285 81 250 172 204C265 158 284 139 284 92C284 45 248 26 198 26C124 26 86 61 65 164Z"></path><path id="MJX-270-STX-N-2200" d="M571 678L498 678L423 474L150 474L75 678L2 678L253 0L320 0M400 412L286 105L173 412Z"></path><path id="MJX-270-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-270-STX-N-2203" d="M498 0L498 678L75 678L75 610L431 610L431 372L87 372L87 305L431 305L431 67L75 67L75 0Z"></path><path id="MJX-270-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path><path id="MJX-270-STX-N-2228" d="M604 549L531 549L319 106L105 549L32 549L314-30L324-30Z"></path><path id="MJX-270-STX-N-4C" d="M568 195L536 195C497 79 481 42 347 42L301 42C242 42 225 51 225 95L225 529C225 607 242 627 323 627L323 657L42 657L42 627C122 627 133 607 133 530L133 123C133 45 122 30 42 30L42 0L538 0Z"></path><path id="MJX-270-STX-N-67" d="M128 184C81 148 46 106 46 70C46 42 68 15 102-2L102-6C48-58 21-92 21-125C21-180 60-235 191-235C317-235 465-189 465-55C465 60 369 64 243 64C151 64 125 74 125 104C125 121 141 157 151 171C177 162 205 156 237 156C342 156 414 215 414 308C414 358 392 391 378 411L378 416L472 413L472 467L343 460C343 460 298 485 232 485C126 485 51 422 51 322C51 257 80 214 128 186M127-10C141-10 160-11 240-12C243-12 246-12 249-12C316-13 414-14 414-83C414-126 367-178 249-178C147-178 99-149 99-91C99-70 106-47 127-10M225 449C289 449 325 395 325 314C325 219 288 191 238 191C173 191 139 240 139 326C139 410 173 449 225 449Z"></path><path id="MJX-270-STX-N-6C" d="M260 29C188 29 183 43 183 101L183 706L158 706L26 671L26 644C26 644 41 646 58 646C83 646 100 644 100 603L100 101C100 45 96 29 30 29L30 0L260 0Z"></path><path id="MJX-270-STX-N-20" d=""></path><path id="MJX-270-STX-N-76" d="M498 473L323 473L323 444C359 444 380 439 380 417C380 401 374 389 373 384L287 158L266 97L260 97L241 157L156 380C150 394 146 406 146 419C146 435 159 444 198 444L198 473L-13 473L-13 444C30 444 42 433 68 371L217-6L265-6L423 378C443 430 459 444 498 444Z"></path><path id="MJX-270-STX-I-1D706" d="M376 558C376 637 373 705 301 705C238 705 195 665 163 609L184 594C210 618 233 628 266 628C308 628 328 589 328 522C328 491 328 490 327 469C224 330 94 156-9 16L-9 0L91 0C148 100 289 330 320 374L326 374C319 279 304 201 304 111C304 35 325-12 380-12C430-12 481 30 512 87L495 103C469 76 448 68 422 68C379 68 363 130 363 214C363 324 376 436 376 558Z"></path><path id="MJX-270-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-270-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path><path id="MJX-270-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-270-STX-N-2026" d="M221 50C221 84 199 114 160 114C123 114 100 85 100 51C100 17 119-8 159-8C199-8 221 19 221 50M504 50C504 84 482 114 443 114C406 114 383 85 383 51C383 17 402-8 442-8C482-8 504 19 504 50M787 50C787 84 765 114 726 114C689 114 666 85 666 51C666 17 685-8 725-8C765-8 787 19 787 50Z"></path><path id="MJX-270-STX-N-50" d="M48 657L48 627C112 627 133 616 133 557L133 127C133 43 122 30 44 30L44 0L326 0L326 30C245 30 225 41 225 123L225 294C236 289 262 286 282 286C413 286 544 335 544 491C544 624 425 657 297 657M225 614C246 616 265 618 285 618C393 618 445 567 445 477C445 361 387 327 279 327C259 327 236 329 225 331Z"></path><path id="MJX-270-STX-N-72" d="M183 482L159 482L35 452L35 424C35 424 46 426 66 426C102 426 102 408 102 372L102 97C102 41 95 29 29 29L29 0L279 0L279 29C204 29 185 39 185 102L185 330C209 370 241 412 264 412C276 412 296 378 329 378C351 378 373 394 373 432C373 466 354 488 315 488C267 488 237 453 186 379L183 379Z"></path><path id="MJX-270-STX-N-6D" d="M185 357C214 384 258 421 310 421C356 421 390 399 390 314L390 116C390 46 384 29 313 29L313 0L550 0L550 29C478 29 473 47 473 116L473 359C506 387 547 421 588 421C635 421 674 399 674 308L674 116C674 55 671 29 603 29L603 0L829 0L829 29C760 29 757 53 757 116L757 320C757 441 706 485 628 485C575 485 524 456 469 402L465 402C445 450 411 485 354 485C286 485 240 448 186 401L182 401L182 482L158 482L33 453L33 424C33 424 45 426 60 426C88 426 102 417 102 381L102 101C102 41 95 29 32 29L32 0L260 0L260 29C198 29 185 41 185 97Z"></path><path id="MJX-270-STX-N-78" d="M482 0L482 29C445 29 430 47 402 87L279 261L385 397C408 426 431 444 465 444L465 473L300 473L300 445C332 445 341 436 341 421C341 405 332 390 305 353L258 285L254 285L230 329C196 385 178 406 178 422C178 437 194 445 226 445L226 473L11 473L11 444C52 444 64 434 99 384L203 235L83 79C50 40 32 29-2 29L-2 0L165 0L165 29C132 29 120 33 120 44C120 52 134 70 144 86L226 204L230 204L250 169L313 72C318 64 320 58 320 51C320 34 308 29 273 29L273 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{array}{r@{\ }ll}
\flow ::= &amp; \sreq{\sigma} \mid \sensr{r}{\sigma} &amp; \text{Specifications} \\
\mid &amp; \forall x. \flow \mid \exists x. \flow \mid \flow \wedge \flow \mid \flow \vee \flow &amp; \text{Logical connectives} \\
\mid &amp; \vlambda{x}{\flow} \mid \app{\flow_1}{\flow_2} \mid \flow_1\bind{r}\flow_2 \mid \dots &amp; \text{Program contexts}
\end{array}
"><g data-mml-node="mtable" data-frame-styles="" data-latex-item="{array}" data-latex="\varphi_2  \mid \dots&amp; \text{Program contexts}
\end{array}
"><g data-mml-node="mtr" transform="translate(0,1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="::=" transform="translate(884.8,0)"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-270-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-270-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(490,0)"><use data-c="3D" xlink:href="#MJX-270-STX-N-3D"></use></g></g></g><g data-mml-node="mtd" transform="translate(2594.8,0)"><g data-mml-node="mtext"><use data-c="A0" xlink:href="#MJX-270-STX-N-A0"></use></g></g><g data-mml-node="mtd" transform="translate(2829.8,0)"><g data-mml-node="TeXAtom" data-latex="\mathbf{req}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="req"><use data-c="1D42B" xlink:href="#MJX-270-STX-B-1D42B"></use><use data-c="1D41E" xlink:href="#MJX-270-STX-B-1D41E" transform="translate(430,0)"></use><use data-c="1D42A" xlink:href="#MJX-270-STX-B-1D42A" transform="translate(933,0)"></use></g></g><g data-mml-node="mtext" transform="translate(1507,0)"><use data-c="A0" xlink:href="#MJX-270-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(1742,0)"><use data-c="1D70E" xlink:href="#MJX-270-STX-I-1D70E"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(2589.8,0)"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g><g data-mml-node="TeXAtom" data-latex="\mathbf{ens}" data-mjx-texclass="ORD" transform="translate(3139.6,0)"><g data-mml-node="mi" data-latex="ens"><use data-c="1D41E" xlink:href="#MJX-270-STX-B-1D41E"></use><use data-c="1D427" xlink:href="#MJX-270-STX-B-1D427" transform="translate(503,0)"></use><use data-c="1D42C" xlink:href="#MJX-270-STX-B-1D42C" transform="translate(1134,0)"></use></g></g><g data-mml-node="mtext" transform="translate(4701.6,0)"><use data-c="A0" xlink:href="#MJX-270-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(4936.6,0)"><use data-c="1D45F" xlink:href="#MJX-270-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(5348.6,0)"><use data-c="2E" xlink:href="#MJX-270-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="\sigma" transform="translate(5760.2,0)"><use data-c="1D70E" xlink:href="#MJX-270-STX-I-1D70E"></use></g></g><g data-mml-node="mtd" transform="translate(15202.7,0)"><g data-mml-node="mtext" data-latex="\text{Specifications}"><use data-c="53" xlink:href="#MJX-270-STX-N-53"></use><use data-c="70" xlink:href="#MJX-270-STX-N-70" transform="translate(504,0)"></use><use data-c="65" xlink:href="#MJX-270-STX-N-65" transform="translate(1041,0)"></use><use data-c="63" xlink:href="#MJX-270-STX-N-63" transform="translate(1505,0)"></use><use data-c="69" xlink:href="#MJX-270-STX-N-69" transform="translate(1951,0)"></use><use data-c="66" xlink:href="#MJX-270-STX-N-66" transform="translate(2236,0)"></use><use data-c="69" xlink:href="#MJX-270-STX-N-69" transform="translate(2543,0)"></use><use data-c="63" xlink:href="#MJX-270-STX-N-63" transform="translate(2828,0)"></use><use data-c="61" xlink:href="#MJX-270-STX-N-61" transform="translate(3274,0)"></use><use data-c="74" xlink:href="#MJX-270-STX-N-74" transform="translate(3754,0)"></use><use data-c="69" xlink:href="#MJX-270-STX-N-69" transform="translate(4069,0)"></use><use data-c="6F" xlink:href="#MJX-270-STX-N-6F" transform="translate(4354,0)"></use><use data-c="6E" xlink:href="#MJX-270-STX-N-6E" transform="translate(4868,0)"></use><use data-c="73" xlink:href="#MJX-270-STX-N-73" transform="translate(5444,0)"></use></g></g></g><g data-mml-node="mtr"><g data-mml-node="mtd" transform="translate(2322.8,0)"><g data-mml-node="mo" data-latex="\mid"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g></g><g data-mml-node="mtd" transform="translate(2594.8,0)"><g data-mml-node="mtext"><use data-c="A0" xlink:href="#MJX-270-STX-N-A0"></use></g></g><g data-mml-node="mtd" transform="translate(2829.8,0)"><g data-mml-node="mi" data-latex="\forall"><use data-c="2200" xlink:href="#MJX-270-STX-N-2200"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(573,0)"><use data-c="1D465" xlink:href="#MJX-270-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1132,0)"><use data-c="2E" xlink:href="#MJX-270-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(1543.7,0)"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(2428.4,0)"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="\exists" transform="translate(2978.2,0)"><use data-c="2203" xlink:href="#MJX-270-STX-N-2203"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(3551.2,0)"><use data-c="1D465" xlink:href="#MJX-270-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(4110.2,0)"><use data-c="2E" xlink:href="#MJX-270-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(4521.9,0)"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(5406.7,0)"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(5956.4,0)"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(6785.7,0)"><use data-c="2227" xlink:href="#MJX-270-STX-N-2227"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(7643.9,0)"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(8528.7,0)"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(9078.4,0)"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\vee" transform="translate(9907.7,0)"><use data-c="2228" xlink:href="#MJX-270-STX-N-2228"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(10765.9,0)"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g></g><g data-mml-node="mtd" transform="translate(15202.7,0)"><g data-mml-node="mtext" data-latex="\text{Logical connectives}"><use data-c="4C" xlink:href="#MJX-270-STX-N-4C"></use><use data-c="6F" xlink:href="#MJX-270-STX-N-6F" transform="translate(585,0)"></use><use data-c="67" xlink:href="#MJX-270-STX-N-67" transform="translate(1099,0)"></use><use data-c="69" xlink:href="#MJX-270-STX-N-69" transform="translate(1583,0)"></use><use data-c="63" xlink:href="#MJX-270-STX-N-63" transform="translate(1868,0)"></use><use data-c="61" xlink:href="#MJX-270-STX-N-61" transform="translate(2314,0)"></use><use data-c="6C" xlink:href="#MJX-270-STX-N-6C" transform="translate(2794,0)"></use><use data-c="20" xlink:href="#MJX-270-STX-N-20" transform="translate(3077,0)"></use><use data-c="63" xlink:href="#MJX-270-STX-N-63" transform="translate(3312,0)"></use><use data-c="6F" xlink:href="#MJX-270-STX-N-6F" transform="translate(3758,0)"></use><use data-c="6E" xlink:href="#MJX-270-STX-N-6E" transform="translate(4272,0)"></use><use data-c="6E" xlink:href="#MJX-270-STX-N-6E" transform="translate(4848,0)"></use><use data-c="65" xlink:href="#MJX-270-STX-N-65" transform="translate(5424,0)"></use><use data-c="63" xlink:href="#MJX-270-STX-N-63" transform="translate(5888,0)"></use><use data-c="74" xlink:href="#MJX-270-STX-N-74" transform="translate(6334,0)"></use><use data-c="69" xlink:href="#MJX-270-STX-N-69" transform="translate(6649,0)"></use><use data-c="76" xlink:href="#MJX-270-STX-N-76" transform="translate(6934,0)"></use><use data-c="65" xlink:href="#MJX-270-STX-N-65" transform="translate(7415,0)"></use><use data-c="73" xlink:href="#MJX-270-STX-N-73" transform="translate(7879,0)"></use></g></g></g><g data-mml-node="mtr" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(2322.8,0)"><g data-mml-node="mo" data-latex="\mid"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g></g><g data-mml-node="mtd" transform="translate(2594.8,0)"><g data-mml-node="mtext"><use data-c="A0" xlink:href="#MJX-270-STX-N-A0"></use></g></g><g data-mml-node="mtd" transform="translate(2829.8,0)"><g data-mml-node="mi" data-latex="\lambda"><use data-c="1D706" xlink:href="#MJX-270-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(525,0)"><use data-c="1D465" xlink:href="#MJX-270-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1084,0)"><use data-c="2E" xlink:href="#MJX-270-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="\varphi" transform="translate(1495.7,0)"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(2380.4,0)"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g><g data-mml-node="msub" data-latex="\varphi_1" transform="translate(2930.2,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-270-STX-N-31"></use></g></g><g data-mml-node="mtext" transform="translate(3970.2,0)"><use data-c="A0" xlink:href="#MJX-270-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="\varphi_2" transform="translate(4205.2,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-270-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="\mid" transform="translate(5523,0)"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g><g data-mml-node="msub" data-latex="\varphi_1" transform="translate(6072.8,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-270-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(7112.8,0)"><use data-c="3B" xlink:href="#MJX-270-STX-N-3B"></use></g><g data-mml-node="mi" data-latex="r" transform="translate(7524.5,0)"><use data-c="1D45F" xlink:href="#MJX-270-STX-I-1D45F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(7936.5,0)"><use data-c="2E" xlink:href="#MJX-270-STX-N-2E"></use></g><g data-mml-node="msub" data-latex="\varphi_2" transform="translate(8348.2,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-270-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-270-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="\mid" transform="translate(9666,0)"><use data-c="2223" xlink:href="#MJX-270-STX-N-2223"></use></g><g data-mml-node="mo" transform="translate(10215.7,0)"><use data-c="2026" xlink:href="#MJX-270-STX-N-2026"></use></g></g><g data-mml-node="mtd" transform="translate(15202.7,0)"><g data-mml-node="mtext" data-latex="\text{Program contexts}"><use data-c="50" xlink:href="#MJX-270-STX-N-50"></use><use data-c="72" xlink:href="#MJX-270-STX-N-72" transform="translate(569,0)"></use><use data-c="6F" xlink:href="#MJX-270-STX-N-6F" transform="translate(949,0)"></use><use data-c="67" xlink:href="#MJX-270-STX-N-67" transform="translate(1463,0)"></use><use data-c="72" xlink:href="#MJX-270-STX-N-72" transform="translate(1947,0)"></use><use data-c="61" xlink:href="#MJX-270-STX-N-61" transform="translate(2327,0)"></use><use data-c="6D" xlink:href="#MJX-270-STX-N-6D" transform="translate(2807,0)"></use><use data-c="20" xlink:href="#MJX-270-STX-N-20" transform="translate(3659,0)"></use><use data-c="63" xlink:href="#MJX-270-STX-N-63" transform="translate(3894,0)"></use><use data-c="6F" xlink:href="#MJX-270-STX-N-6F" transform="translate(4340,0)"></use><use data-c="6E" xlink:href="#MJX-270-STX-N-6E" transform="translate(4854,0)"></use><use data-c="74" xlink:href="#MJX-270-STX-N-74" transform="translate(5430,0)"></use><use data-c="65" xlink:href="#MJX-270-STX-N-65" transform="translate(5745,0)"></use><use data-c="78" xlink:href="#MJX-270-STX-N-78" transform="translate(6209,0)"></use><use data-c="74" xlink:href="#MJX-270-STX-N-74" transform="translate(6688,0)"></use><use data-c="73" xlink:href="#MJX-270-STX-N-73" transform="translate(7003,0)"></use></g></g></g></g></g></g></svg></mjx-container></div><p>Like other logics, it comes with an entailment relation, initially defined as follows, where <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.021ex;" xmlns="http://www.w3.org/2000/svg" width="1.733ex" height="1.021ex" role="img" focusable="false" viewBox="0 -479 830 489" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-271-STX-I-1D45A" d="M403 0L435 138C472 228 587 407 649 407C672 407 679 390 679 367C679 346 670 308 663 282L612 88C611 83 607 65 607 49C607 19 622-10 673-10C744-10 784 60 810 97L790 112C774 93 750 60 715 60C702 60 696 68 696 79C696 91 699 103 699 103L754 334C757 348 764 382 764 408C764 444 750 479 700 479C596 479 514 346 471 270L463 270L480 334C481 339 489 379 489 408C489 444 476 479 426 479C312 479 227 338 185 259L177 259L227 476L204 476L66 465L66 438C66 438 85 440 98 440C122 440 130 430 130 413C130 398 127 380 127 380L47 0L129 0L160 137C210 250 309 407 375 407C398 407 405 390 405 367C405 351 400 328 399 325C375 215 349 107 320 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="m"><g data-mml-node="mi" data-latex="m"><use data-c="1D45A" xlink:href="#MJX-271-STX-I-1D45A"></use></g></g></g></svg></mjx-container> is a model of the logic.
The symmetric version, <em>equivalence</em>, is typically defined in terms of entailment.</p>
<span style="color: red; border: solid red 1px;">Rendering error due to Error: MathJax retry -- an asynchronous action is required; try using one of the promise-based functions and await its resolution.</span><p>This definition is known under many names in different communities.</p>
<ul>
<li>In other logics, such as <a href="https://softwarefoundations.cis.upenn.edu/slf-current/Himpl.html">separation logic</a>, it is written <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.503ex" height="1.415ex" role="img" focusable="false" viewBox="0 -678 720 678" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-272-STX-N-22A2" d="M646 305L646 372L145 372L145 678L75 678L75 0L145 0L145 305Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\vdash"><g data-mml-node="mo" data-latex="\vdash"><use data-c="22A2" xlink:href="#MJX-272-STX-N-22A2"></use></g></g></g></svg></mjx-container> and called <em>entailment</em>, as a lifting of metalogic implication</li>
<li>In TLA<mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.236ex" height="1.582ex" role="img" focusable="false" viewBox="0 -757.6 592.1 757.6" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-273-STX-N-2B" d="M658 225L658 293L396 293L396 558L324 558L324 293L62 293L62 225L324 225L324-40L396-40L396 225Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="^+"><g data-mml-node="msup" data-latex="^+"><g data-mml-node="mi"></g><g data-mml-node="mo" transform="translate(33,363) scale(0.707)" data-latex="+"><use data-c="2B" xlink:href="#MJX-273-STX-N-2B"></use></g></g></g></g></svg></mjx-container>, where the two objects are temporal formulae representing state machines, it is written <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.221ex;" xmlns="http://www.w3.org/2000/svg" width="1.503ex" height="1.518ex" role="img" focusable="false" viewBox="0 -621 720 727" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-274-STX-N-2291" d="M646 52L646 120L143 120L143 554L646 554L646 621L75 621L75 52M646-106L646-38L75-38L75-106Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\sqsubseteq"><g data-mml-node="mo" data-latex="\sqsubseteq"><use data-c="2291" xlink:href="#MJX-274-STX-N-2291"></use></g></g></g></svg></mjx-container> and called <a href="https://www.hillelwayne.com/post/refinement/">refinement</a></li>
<li>When the two objects are programs, it is called <a href="https://softwarefoundations.cis.upenn.edu/plf-current/Equiv.html">program approximation</a>, with the symmetric version called <em>behavioural equivalence</em>. In the context of compiler correctness, it is also a simple form of forward (or backward, <a href="https://sel4.discourse.group/t/forward-vs-backward-simulation-in-the-refinement-proof/490">depending on who you ask</a>) simulation</li>
<li>When the two objects are <a href="https://songyahui.github.io/ICFEM20.pdf">languages</a>, it is called <em>inclusion</em> and written <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.221ex;" xmlns="http://www.w3.org/2000/svg" width="1.503ex" height="1.518ex" role="img" focusable="false" viewBox="0 -621 720 727" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-275-STX-N-2286" d="M646 52L646 120L353 120C209 120 153 228 153 338C153 447 208 554 352 554L646 554L646 621L347 621C183 621 75 489 75 338C75 186 181 52 344 52M646-106L646-38L85-38L85-106Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\subseteq"><g data-mml-node="mo" data-latex="\subseteq"><use data-c="2286" xlink:href="#MJX-275-STX-N-2286"></use></g></g></g></svg></mjx-container></li>
<li>When the two objects are <a href="https://www.cs.princeton.edu/~appel/papers/funspec_sub.pdf">specifications</a>, the relation is written <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.052ex;" xmlns="http://www.w3.org/2000/svg" width="2.015ex" height="1.194ex" role="img" focusable="false" viewBox="0 -547 965 572" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-276-STX-N-3C" d="M650-25L650 42L207 260L650 478L650 547L71 265L71 255Z"></path><path id="MJX-276-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="<:"><g data-mml-node="mo" data-latex="<:"><g data-mml-node="text"><use data-c="3C" xlink:href="#MJX-276-STX-N-3C"></use></g><g data-mml-node="text" transform="translate(720,0)"><use data-c="3A" xlink:href="#MJX-276-STX-N-3A"></use></g></g></g></g></svg></mjx-container> and called <em>subsumption</em></li>
<li>When the two objects are <a href="https://www.irif.fr/~gc/papers/icalp-ppdp05.pdf">types</a>, <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.052ex;" xmlns="http://www.w3.org/2000/svg" width="2.015ex" height="1.194ex" role="img" focusable="false" viewBox="0 -547 965 572" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-277-STX-N-3C" d="M650-25L650 42L207 260L650 478L650 547L71 265L71 255Z"></path><path id="MJX-277-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="<:"><g data-mml-node="mo" data-latex="<:"><g data-mml-node="text"><use data-c="3C" xlink:href="#MJX-277-STX-N-3C"></use></g><g data-mml-node="text" transform="translate(720,0)"><use data-c="3A" xlink:href="#MJX-277-STX-N-3A"></use></g></g></g></g></svg></mjx-container> is instead called <em>subtyping</em></li>
</ul>
<p>Entailment intuitively means that the models or behaviours of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.453ex;" xmlns="http://www.w3.org/2000/svg" width="2.171ex" height="1.476ex" role="img" focusable="false" viewBox="0 -490 1040 707" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-278-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-278-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\flow_1"><g data-mml-node="msub" data-latex="\varphi_1 "><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-278-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-278-STX-N-31"></use></g></g></g></g></svg></mjx-container> are somehow &quot;contained in&quot; those of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.453ex;" xmlns="http://www.w3.org/2000/svg" width="2.171ex" height="1.476ex" role="img" focusable="false" viewBox="0 -490 1040 707" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-279-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-279-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\flow_2"><g data-mml-node="msub" data-latex="\varphi_2 "><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-279-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-279-STX-N-32"></use></g></g></g></g></svg></mjx-container>.
When the operands are some kind of program, <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.453ex;" xmlns="http://www.w3.org/2000/svg" width="2.171ex" height="1.476ex" role="img" focusable="false" viewBox="0 -490 1040 707" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-280-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-280-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\flow_2"><g data-mml-node="msub" data-latex="\varphi_2 "><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-280-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-280-STX-N-32"></use></g></g></g></g></svg></mjx-container> can be seen as a <em>specification</em> of <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.453ex;" xmlns="http://www.w3.org/2000/svg" width="2.171ex" height="1.476ex" role="img" focusable="false" viewBox="0 -490 1040 707" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-281-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-281-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\flow_1"><g data-mml-node="msub" data-latex="\varphi_1 "><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-281-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-281-STX-N-31"></use></g></g></g></g></svg></mjx-container>, as it &quot;bounds&quot; the behaviours the latter can have.
When the operands are logical formulae, <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.453ex;" xmlns="http://www.w3.org/2000/svg" width="2.171ex" height="1.476ex" role="img" focusable="false" viewBox="0 -490 1040 707" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-282-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-282-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\flow_1"><g data-mml-node="msub" data-latex="\varphi_1 "><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-282-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-282-STX-N-31"></use></g></g></g></g></svg></mjx-container> is called <em>stronger</em> or <em>more precise</em>, in that it describes fewer models, since every model satisfying it will satisfy <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.453ex;" xmlns="http://www.w3.org/2000/svg" width="2.171ex" height="1.476ex" role="img" focusable="false" viewBox="0 -490 1040 707" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-283-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-283-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\flow_2"><g data-mml-node="msub" data-latex="\varphi_2 "><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-283-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-283-STX-N-32"></use></g></g></g></g></svg></mjx-container>.</p>
<p>We started with this and it <a href="/MechanizingStagedLogic.pdf">worked great</a> for interactive proofs in Rocq for a while.</p>
<h2 id="delimited-continuations-and-the-bubble-up-semantics">Delimited continuations and the bubble-up semantics</h2>
<p><a href="/drafts/delimited-control">other blog post</a>.</p>
<p>However, there were problems with shift and the bubble-up semantics.
We had shift results and no way to relate them.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.453ex;" xmlns="http://www.w3.org/2000/svg" width="22.109ex" height="1.948ex" role="img" focusable="false" viewBox="0 -716 10590.3 933" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-284-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-284-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-284-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-284-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-284-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path><path id="MJX-284-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-284-STX-N-33" d="M86 498C120 551 157 579 217 579C279 579 319 545 319 486C319 405 248 350 180 350L161 350L161 312L181 312C277 312 362 253 362 164C362 66 301 37 238 37C214 37 200 41 157 63C122 81 114 86 98 86C72 86 59 63 59 42C59 16 81-13 171-13C317-13 444 57 444 194C444 283 377 336 297 361L297 364C360 404 405 441 405 510C405 586 346 644 244 644C162 644 100 598 63 511Z"></path><path id="MJX-284-STX-N-2261" d="M658 28L658 96L62 96L62 28M658 225L658 293L62 293L62 225M658 422L658 489L62 489L62 422Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="(\flow_1; \flow_2); \flow_3 \equiv \flow_1; (\flow_2; \flow_3)
"><g data-mml-node="mo" data-latex="(" transform="translate(0 -20)"><use data-c="28" xlink:href="#MJX-284-STX-N-28"></use></g><g data-mml-node="msub" data-latex="\varphi_1" transform="translate(357,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-284-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-284-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(1397,0)"><use data-c="3B" xlink:href="#MJX-284-STX-N-3B"></use></g><g data-mml-node="msub" data-latex="\varphi_2" transform="translate(1808.7,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-284-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-284-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(2848.7,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-284-STX-N-29"></use></g><g data-mml-node="mo" data-latex=";" transform="translate(3205.7,0)"><use data-c="3B" xlink:href="#MJX-284-STX-N-3B"></use></g><g data-mml-node="msub" data-latex="\varphi_3" transform="translate(3617.4,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-284-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="3"><use data-c="33" xlink:href="#MJX-284-STX-N-33"></use></g></g><g data-mml-node="mo" data-latex="\equiv" transform="translate(4935.2,0)"><use data-c="2261" xlink:href="#MJX-284-STX-N-2261"></use></g><g data-mml-node="msub" data-latex="\varphi_1" transform="translate(5932.9,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-284-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-284-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(6973,0)"><use data-c="3B" xlink:href="#MJX-284-STX-N-3B"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(7384.6,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-284-STX-N-28"></use></g><g data-mml-node="msub" data-latex="\varphi_2" transform="translate(7741.6,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-284-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-284-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(8781.6,0)"><use data-c="3B" xlink:href="#MJX-284-STX-N-3B"></use></g><g data-mml-node="msub" data-latex="\varphi_3" transform="translate(9193.3,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-284-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="3"><use data-c="33" xlink:href="#MJX-284-STX-N-33"></use></g></g><g data-mml-node="mo" data-latex=")" transform="translate(10233.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-284-STX-N-29"></use></g></g></g></svg></mjx-container></div><p>where sequencing is defined as <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="5.202ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 2491.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\flow_1; \flow_2 \defeq \flow_1 \bind{\_} \flow_2"><g data-mml-node="msub" data-latex="\varphi_1"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-285-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-285-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(1040,0)"><use data-c="3B" xlink:href="#MJX-285-STX-N-3B"></use></g><g data-mml-node="msub" data-latex="\varphi_2" transform="translate(1451.7,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-285-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-285-STX-N-32"></use></g></g></g></g><defs><path id="MJX-285-STX-I-1D711" d="M225 76C158 78 78 111 78 207C78 320 179 385 277 407C298 413 310 431 310 462C310 475 306 486 300 490C101 466 36 321 36 181C36 67 94 5 201-9L146-214L161-217C261-217 257-117 268-7C435 16 572 104 572 304C572 413 528 470 459 470C354 470 283 345 247 173M305 187C322 278 362 383 447 383C492 383 523 356 523 287C523 122 376 83 283 78Z"></path><path id="MJX-285-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-285-STX-N-3B" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-285-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path><path id="MJX-285-STX-N-5F" d="M512-128L512-77L0-77L0-128Z"></path><path id="MJX-285-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path></defs></svg><mjx-break size="4"> </mjx-break><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="8.963ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 4293.1 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\flow_1; \flow_2 \defeq \flow_1 \bind{\_} \flow_2"><g data-mml-node="mo" data-latex="\triangleq"><text data-variant="normal" transform="scale(1,-1)" font-size="958px" font-family="serif">≜</text></g><g data-mml-node="msub" data-latex="\varphi_1" transform="translate(877.8,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-285-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-285-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex=";" transform="translate(1917.8,0)"><use data-c="3B" xlink:href="#MJX-285-STX-N-3B"></use></g><g data-mml-node="mi" data-latex="\_" transform="translate(2329.5,0)"><use data-c="5F" xlink:href="#MJX-285-STX-N-5F"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2841.5,0)"><use data-c="2E" xlink:href="#MJX-285-STX-N-2E"></use></g><g data-mml-node="msub" data-latex="\varphi_2" transform="translate(3253.1,0)"><g data-mml-node="mi" data-latex="\varphi"><use data-c="1D711" xlink:href="#MJX-285-STX-I-1D711"></use></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-285-STX-N-32"></use></g></g></g></g></svg></mjx-container>.</p>
<p>Associativity broke.
Rewriting wouldn't work because proper instances</p>
<h2 id="many-indexed-non-solutions">Many indexed non-solutions</h2>
<p><em>gentails</em>, for &quot;generalised entails&quot;.
It also autocorrects poorly.</p>
<h2 id="a-similar-problem-in-the-lambda-calculus">A similar problem in the lambda calculus</h2>
<p>It turns out that this issue shows up in the lambda calculus.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.405ex;" xmlns="http://www.w3.org/2000/svg" width="17.27ex" height="1.879ex" role="img" focusable="false" viewBox="0 -706 8272.4 900" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-286-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-286-STX-N-3A" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50M183 414C183 448 161 478 122 478C85 478 62 449 62 415C62 381 81 356 121 356C161 356 183 383 183 414Z"></path><path id="MJX-286-STX-N-3D" d="M658 327L658 395L62 395L62 327M658 123L658 190L62 190L62 123Z"></path><path id="MJX-286-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-286-STX-N-2223" d="M170-194L170 706L102 706L102-194Z"></path><path id="MJX-286-STX-I-1D706" d="M376 558C376 637 373 705 301 705C238 705 195 665 163 609L184 594C210 618 233 628 266 628C308 628 328 589 328 522C328 491 328 490 327 469C224 330 94 156-9 16L-9 0L91 0C148 100 289 330 320 374L326 374C319 279 304 201 304 111C304 35 325-12 380-12C430-12 481 30 512 87L495 103C469 76 448 68 422 68C379 68 363 130 363 214C363 324 376 436 376 558Z"></path><path id="MJX-286-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-286-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-286-STX-N-A0" d=""></path><path id="MJX-286-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="e ::= x \mid \lambda x. e \mid \app{e_1}{e_2}
"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-286-STX-I-1D452"></use></g><g data-mml-node="mo" data-latex="::=" transform="translate(701.8,0)"><g data-mml-node="text"><use data-c="3A" xlink:href="#MJX-286-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(245,0)"><use data-c="3A" xlink:href="#MJX-286-STX-N-3A"></use></g><g data-mml-node="text" transform="translate(490,0)"><use data-c="3D" xlink:href="#MJX-286-STX-N-3D"></use></g></g><g data-mml-node="mi" data-latex="x" transform="translate(2189.6,0)"><use data-c="1D465" xlink:href="#MJX-286-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(3026.3,0)"><use data-c="2223" xlink:href="#MJX-286-STX-N-2223"></use></g><g data-mml-node="mi" data-latex="\lambda" transform="translate(3576.1,0)"><use data-c="1D706" xlink:href="#MJX-286-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4101.1,0)"><use data-c="1D465" xlink:href="#MJX-286-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(4660.1,0)"><use data-c="2E" xlink:href="#MJX-286-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(5071.8,0)"><use data-c="1D452" xlink:href="#MJX-286-STX-I-1D452"></use></g><g data-mml-node="mo" data-latex="\mid" transform="translate(5773.6,0)"><use data-c="2223" xlink:href="#MJX-286-STX-N-2223"></use></g><g data-mml-node="msub" data-latex="e_1" transform="translate(6323.3,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-286-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-286-STX-N-31"></use></g></g><g data-mml-node="mtext" transform="translate(7180.4,0)"><use data-c="A0" xlink:href="#MJX-286-STX-N-A0"></use></g><g data-mml-node="msub" data-latex="e_2" transform="translate(7415.4,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-286-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-286-STX-N-32"></use></g></g></g></g></svg></mjx-container></div><p>Consider how to prove that these two expressions are equivalent.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="17.308ex" height="1.954ex" role="img" focusable="false" viewBox="0 -716 8290.6 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-287-STX-I-1D706" d="M376 558C376 637 373 705 301 705C238 705 195 665 163 609L184 594C210 618 233 628 266 628C308 628 328 589 328 522C328 491 328 490 327 469C224 330 94 156-9 16L-9 0L91 0C148 100 289 330 320 374L326 374C319 279 304 201 304 111C304 35 325-12 380-12C430-12 481 30 512 87L495 103C469 76 448 68 422 68C379 68 363 130 363 214C363 324 376 436 376 558Z"></path><path id="MJX-287-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-287-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-287-STX-N-2261" d="M658 28L658 96L62 96L62 28M658 225L658 293L62 293L62 225M658 422L658 489L62 489L62 422Z"></path><path id="MJX-287-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-287-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-287-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-287-STX-N-A0" d=""></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\vlambda{x}{x} \equiv \vlambda{x}{\app{(\vlambda{y}{y})}{x}}
"><g data-mml-node="mi" data-latex="\lambda"><use data-c="1D706" xlink:href="#MJX-287-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(525,0)"><use data-c="1D465" xlink:href="#MJX-287-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1084,0)"><use data-c="2E" xlink:href="#MJX-287-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(1495.7,0)"><use data-c="1D465" xlink:href="#MJX-287-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="\equiv" transform="translate(2332.4,0)"><use data-c="2261" xlink:href="#MJX-287-STX-N-2261"></use></g><g data-mml-node="mi" data-latex="\lambda" transform="translate(3330.2,0)"><use data-c="1D706" xlink:href="#MJX-287-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(3855.2,0)"><use data-c="1D465" xlink:href="#MJX-287-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(4414.2,0)"><use data-c="2E" xlink:href="#MJX-287-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(4825.9,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-287-STX-N-28"></use></g><g data-mml-node="mi" data-latex="\lambda" transform="translate(5182.9,0)"><use data-c="1D706" xlink:href="#MJX-287-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(5707.9,0)"><use data-c="1D466" xlink:href="#MJX-287-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="." transform="translate(6217.9,0)"><use data-c="2E" xlink:href="#MJX-287-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(6629.6,0)"><use data-c="1D466" xlink:href="#MJX-287-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(7139.6,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-287-STX-N-29"></use></g><g data-mml-node="mtext" transform="translate(7496.6,0)"><use data-c="A0" xlink:href="#MJX-287-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(7731.6,0)"><use data-c="1D465" xlink:href="#MJX-287-STX-I-1D465"></use></g></g></g></svg></mjx-container></div><p>According to the definition above, given that we know how <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.289ex" height="1.497ex" role="img" focusable="false" viewBox="0 -705 2054.7 717" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-288-STX-I-1D706" d="M376 558C376 637 373 705 301 705C238 705 195 665 163 609L184 594C210 618 233 628 266 628C308 628 328 589 328 522C328 491 328 490 327 469C224 330 94 156-9 16L-9 0L91 0C148 100 289 330 320 374L326 374C319 279 304 201 304 111C304 35 325-12 380-12C430-12 481 30 512 87L495 103C469 76 448 68 422 68C379 68 363 130 363 214C363 324 376 436 376 558Z"></path><path id="MJX-288-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-288-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\vlambda{x}{x}"><g data-mml-node="mi" data-latex="\lambda"><use data-c="1D706" xlink:href="#MJX-288-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(525,0)"><use data-c="1D465" xlink:href="#MJX-288-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1084,0)"><use data-c="2E" xlink:href="#MJX-288-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(1495.7,0)"><use data-c="1D465" xlink:href="#MJX-288-STX-I-1D465"></use></g></g></g></svg></mjx-container> evaluates, we have to show that <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="10.356ex" height="1.954ex" role="img" focusable="false" viewBox="0 -716 4960.3 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-289-STX-I-1D706" d="M376 558C376 637 373 705 301 705C238 705 195 665 163 609L184 594C210 618 233 628 266 628C308 628 328 589 328 522C328 491 328 490 327 469C224 330 94 156-9 16L-9 0L91 0C148 100 289 330 320 374L326 374C319 279 304 201 304 111C304 35 325-12 380-12C430-12 481 30 512 87L495 103C469 76 448 68 422 68C379 68 363 130 363 214C363 324 376 436 376 558Z"></path><path id="MJX-289-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-289-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-289-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-289-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-289-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-289-STX-N-A0" d=""></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\vlambda{x}{\app{(\vlambda{y}{y})}{x}}"><g data-mml-node="mi" data-latex="\lambda"><use data-c="1D706" xlink:href="#MJX-289-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(525,0)"><use data-c="1D465" xlink:href="#MJX-289-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1084,0)"><use data-c="2E" xlink:href="#MJX-289-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(1495.7,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-289-STX-N-28"></use></g><g data-mml-node="mi" data-latex="\lambda" transform="translate(1852.7,0)"><use data-c="1D706" xlink:href="#MJX-289-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(2377.7,0)"><use data-c="1D466" xlink:href="#MJX-289-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2887.7,0)"><use data-c="2E" xlink:href="#MJX-289-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(3299.3,0)"><use data-c="1D466" xlink:href="#MJX-289-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(3809.3,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-289-STX-N-29"></use></g><g data-mml-node="mtext" transform="translate(4166.3,0)"><use data-c="A0" xlink:href="#MJX-289-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(4401.3,0)"><use data-c="1D465" xlink:href="#MJX-289-STX-I-1D465"></use></g></g></g></svg></mjx-container> evaluates to the same value.</p>
<p>Suppose we have a big-step semantics <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="4.348ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 2082.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\bigstep{h}{e}{h}{v}"><g data-mml-node="mo" data-latex="\langle" transform="translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-290-STX-N-27E8"></use></g><g data-mml-node="mi" data-latex="h" transform="translate(339,0)"><use data-c="210E" xlink:href="#MJX-290-STX-I-210E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(908,0)"><use data-c="2C" xlink:href="#MJX-290-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(1319.7,0)"><use data-c="1D452" xlink:href="#MJX-290-STX-I-1D452"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(1743.7,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-290-STX-N-27E9"></use></g></g></g><defs><path id="MJX-290-STX-N-27E8" d="M299 736L262 736L40 280L40 260L262-196L299-196L112 270Z"></path><path id="MJX-290-STX-I-210E" d="M528 112C513 93 489 60 453 60C440 60 434 68 434 79C434 91 438 103 438 103L494 334C497 348 503 382 503 408C503 444 488 479 437 479C319 479 227 334 185 259L177 259L278 706L255 706L117 695L117 668C117 668 137 670 150 670C173 670 182 660 182 644C182 629 179 610 179 610L47 0L129 0L165 158C197 227 313 407 387 407C410 407 417 390 417 367C417 347 410 319 410 319L351 88C349 83 346 65 346 49C346 19 361-10 411-10C483-10 523 60 549 97Z"></path><path id="MJX-290-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-290-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-290-STX-N-27E9" d="M227 270L40-196L77-196L299 260L299 280L77 736L40 736Z"></path><path id="MJX-290-STX-N-2192" d="M876 264C778 305 700 382 634 459L613 439C636 405 667 369 697 341C707 331 711 324 711 315C711 305 695 293 685 293L71 293L71 225L684 225C702 225 710 215 710 205C710 196 705 185 696 176C665 144 636 111 612 78L633 58C700 136 778 212 876 254Z"></path><path id="MJX-290-STX-I-1D463" d="M200 476L53 465L53 437C53 437 83 440 99 440C117 440 123 426 123 409C123 389 116 365 113 354L93 278C82 236 71 183 71 135C71 58 100-9 200-9C380-9 479 206 479 358C479 429 448 479 403 479C382 479 365 464 365 437C365 393 426 369 426 299C426 206 368 55 231 55C170 55 153 99 153 151C153 196 166 249 175 284L222 476Z"></path></defs></svg><mjx-break size="4"> </mjx-break><svg style="vertical-align: -0.522ex;" xmlns="http://www.w3.org/2000/svg" width="7.074ex" height="2.088ex" role="img" focusable="false" viewBox="0 -750 3388.4 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\bigstep{h}{e}{h}{v}"><g data-mml-node="mo" data-latex="\to"><use data-c="2192" xlink:href="#MJX-290-STX-N-2192"></use></g><g data-mml-node="mo" data-latex="\langle" transform="translate(1225.8,0) translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-290-STX-N-27E8"></use></g><g data-mml-node="mi" data-latex="h" transform="translate(1564.8,0)"><use data-c="210E" xlink:href="#MJX-290-STX-I-210E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(2133.8,0)"><use data-c="2C" xlink:href="#MJX-290-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="v" transform="translate(2545.4,0)"><use data-c="1D463" xlink:href="#MJX-290-STX-I-1D463"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(3049.4,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-290-STX-N-27E9"></use></g></g></g></svg></mjx-container>.
A lambda expression is a value, and the rule for values just says:</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -1.921ex;" xmlns="http://www.w3.org/2000/svg" width="22.019ex" height="3.392ex" role="img" focusable="false" viewBox="0 -705 10547.2 1625" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-291-STX-N-27E8" d="M299 736L262 736L40 280L40 260L262-196L299-196L112 270Z"></path><path id="MJX-291-STX-I-210E" d="M528 112C513 93 489 60 453 60C440 60 434 68 434 79C434 91 438 103 438 103L494 334C497 348 503 382 503 408C503 444 488 479 437 479C319 479 227 334 185 259L177 259L278 706L255 706L117 695L117 668C117 668 137 670 150 670C173 670 182 660 182 644C182 629 179 610 179 610L47 0L129 0L165 158C197 227 313 407 387 407C410 407 417 390 417 367C417 347 410 319 410 319L351 88C349 83 346 65 346 49C346 19 361-10 411-10C483-10 523 60 549 97Z"></path><path id="MJX-291-STX-N-2C" d="M70-132C110-114 194-80 194 33C194 88 167 121 117 121C77 121 55 94 55 62C55 33 71 8 110 8C121 8 130 10 141 14C141-67 95-91 58-107Z"></path><path id="MJX-291-STX-I-1D706" d="M376 558C376 637 373 705 301 705C238 705 195 665 163 609L184 594C210 618 233 628 266 628C308 628 328 589 328 522C328 491 328 490 327 469C224 330 94 156-9 16L-9 0L91 0C148 100 289 330 320 374L326 374C319 279 304 201 304 111C304 35 325-12 380-12C430-12 481 30 512 87L495 103C469 76 448 68 422 68C379 68 363 130 363 214C363 324 376 436 376 558Z"></path><path id="MJX-291-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-291-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-291-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-291-STX-N-27E9" d="M227 270L40-196L77-196L299 260L299 280L77 736L40 736Z"></path><path id="MJX-291-STX-N-2192" d="M876 264C778 305 700 382 634 459L613 439C636 405 667 369 697 341C707 331 711 324 711 315C711 305 695 293 685 293L71 293L71 225L684 225C702 225 710 215 710 205C710 196 705 185 696 176C665 144 636 111 612 78L633 58C700 136 778 212 876 254Z"></path><path id="MJX-291-STX-MI-56" d="M235-5L602 520C663 611 683 627 737 627L739 657L523 657L521 627C566 627 581 621 581 601C581 585 568 562 550 535L335 213L277 125L272 125L265 242L235 527C235 534 232 556 232 563C229 608 261 627 312 627L315 657L70 657L68 627C121 627 138 603 146 536L202-5Z"></path><path id="MJX-291-STX-MI-61" d="M153-12C208-12 259 21 309 85L315 85C313 69 309 52 309 37C309 5 328-10 363-10C425-10 466 38 505 97L485 112C472 95 444 60 412 60C397 60 393 68 393 81C393 96 398 118 398 118L472 472L421 472L386 426L382 426C361 456 333 479 282 479C154 479 31 334 31 156C31 38 85-12 153-12M189 54C147 54 119 80 119 169C119 304 184 441 276 441C330 441 359 394 359 349C359 311 338 220 328 180C310 108 250 54 189 54Z"></path><path id="MJX-291-STX-MI-6C" d="M109-9C175-9 214 47 249 96L229 111C213 93 187 59 153 59C141 59 134 65 134 78C134 85 136 104 139 120L255 705L233 705L95 694L95 668C95 668 111 670 129 670C156 670 160 653 160 640C160 624 157 608 157 608L60 144C55 118 46 70 46 44C46 9 69-9 109-9Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\frac{ }{\bigstep{h}{\vlambda{x}{e}}{h}{\vlambda{x}{e}}}\m{Val}
"><g data-mml-node="mfrac" data-latex="\frac{ }{\bigstep{h}{\vlambda{x}{e}}{h}{\vlambda{x}{e}}}"><g data-mml-node="mrow" data-latex=" " transform="translate(4550.1,676)"></g><g data-mml-node="mrow" data-latex="\lambda x. e \rangle" transform="translate(220,-704)"><g data-mml-node="mo" data-latex="\langle" transform="translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-291-STX-N-27E8"></use></g><g data-mml-node="mi" data-latex="h" transform="translate(339,0)"><use data-c="210E" xlink:href="#MJX-291-STX-I-210E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(908,0)"><use data-c="2C" xlink:href="#MJX-291-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="\lambda" transform="translate(1319.7,0)"><use data-c="1D706" xlink:href="#MJX-291-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(1844.7,0)"><use data-c="1D465" xlink:href="#MJX-291-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2403.7,0)"><use data-c="2E" xlink:href="#MJX-291-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(2815.3,0)"><use data-c="1D452" xlink:href="#MJX-291-STX-I-1D452"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(3239.3,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-291-STX-N-27E9"></use></g><g data-mml-node="mo" data-latex="\to" transform="translate(3856.1,0)"><use data-c="2192" xlink:href="#MJX-291-STX-N-2192"></use></g><g data-mml-node="mo" data-latex="\langle" transform="translate(5081.9,0) translate(0 -20)"><use data-c="27E8" xlink:href="#MJX-291-STX-N-27E8"></use></g><g data-mml-node="mi" data-latex="h" transform="translate(5420.9,0)"><use data-c="210E" xlink:href="#MJX-291-STX-I-210E"></use></g><g data-mml-node="mo" data-latex="," transform="translate(5989.9,0)"><use data-c="2C" xlink:href="#MJX-291-STX-N-2C"></use></g><g data-mml-node="mi" data-latex="\lambda" transform="translate(6401.6,0)"><use data-c="1D706" xlink:href="#MJX-291-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(6926.6,0)"><use data-c="1D465" xlink:href="#MJX-291-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(7485.6,0)"><use data-c="2E" xlink:href="#MJX-291-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="e" transform="translate(7897.2,0)"><use data-c="1D452" xlink:href="#MJX-291-STX-I-1D452"></use></g><g data-mml-node="mo" data-latex="\rangle" transform="translate(8321.2,0) translate(0 -20)"><use data-c="27E9" xlink:href="#MJX-291-STX-N-27E9"></use></g></g><rect width="8860.2" height="68" x="120" y="216"></rect></g><g data-mml-node="TeXAtom" data-latex="\mathit{Val}" data-mjx-texclass="ORD" transform="translate(9100.2,0)"><g data-mml-node="mi" data-latex="Val"><use data-c="56" xlink:href="#MJX-291-STX-MI-56"></use><use data-c="61" xlink:href="#MJX-291-STX-MI-61" transform="translate(640,0)"></use><use data-c="6C" xlink:href="#MJX-291-STX-MI-6C" transform="translate(1174,0)"></use></g></g></g></g></svg></mjx-container></div><p>In other words, no more evaluation takes place.</p>
<p>If we try this for the two programs above, we end up with distinct syntactic objects that are not equal, though we can so clearly see that they behave the same.</p>
<p>The way I originally described it to people (with the view that staged logic was a logic) was that we had &quot;syntax in the model&quot;. Which led to a rabbit hole of looking into denotational approaches to interpret that syntax with.</p>
<p>However, staged logic is equally viewed as an abstract programming language, and though it seems obvious in hindsight, the problem we had with bubbles is exactly the one described here with the lambda calculus.</p>
<h2 id="contextual-equivalence">Contextual equivalence</h2>
<p>The solution is a stronger notion of equivalence: <em>contextual equivalence</em> (with the asymmetric version being called <em>contextual refinement</em>).</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -1.965ex;" xmlns="http://www.w3.org/2000/svg" width="26.195ex" height="4.974ex" role="img" focusable="false" viewBox="0 -1441.2 12547.4 2382.3" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-292-STX-I-1D452" d="M357 122C317 72 262 57 216 57C149 57 112 88 112 189L112 202C228 211 404 262 404 390C404 467 339 479 296 479C139 479 28 319 28 164C28 84 58-12 177-12C243-12 315 17 375 107M114 231C133 330 202 448 276 448C306 448 318 428 318 393C318 298 227 238 114 231Z"></path><path id="MJX-292-STX-N-31" d="M426 0L426 28C334 28 297 46 297 95L297 639L268 639L74 584L74 551C105 561 156 567 176 567C201 567 209 553 209 518L209 95C209 45 174 28 80 28L80 0Z"></path><path id="MJX-292-STX-N-2AAF" d="M645 131C593 219 429 302 303 338C429 374 593 456 645 545L645 623C522 459 282 388 74 371L74 304C282 287 522 217 645 52M645-106L645-38L74-38L74-106Z"></path><path id="MJX-292-STX-N-32" d="M464 160L435 160C412 100 399 79 346 79L207 79L137 76L137 81L269 206C375 313 432 382 432 471C432 576 353 644 240 644C143 644 75 588 44 491L68 481C105 556 149 579 214 579C291 579 339 531 339 456C339 351 289 288 190 186L38 34L38 0L432 0Z"></path><path id="MJX-292-STX-N-2200" d="M571 678L498 678L423 474L150 474L75 678L2 678L253 0L320 0M400 412L286 105L173 412Z"></path><path id="MJX-292-STX-I-1D436" d="M567 145C500 84 430 54 352 54C220 54 158 125 158 259C158 479 288 627 442 627C541 627 599 573 594 440L627 440L674 669L645 669C629 647 619 633 603 633C578 633 552 670 451 670C248 670 60 515 60 234C60 102 124-11 305-11C431-11 517 46 585 126Z"></path><path id="MJX-292-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-292-STX-N-5B" d="M299-196L299-164L169-164L169 704L299 704L299 736L90 736L90-196Z"></path><path id="MJX-292-STX-N-5D" d="M259-196L259 736L50 736L50 704L180 704L180-164L50-164L50-196Z"></path><path id="MJX-292-STX-N-2291" d="M646 52L646 120L143 120L143 554L646 554L646 621L75 621L75 52M646-106L646-38L75-38L75-106Z"></path><path id="MJX-292-STX-N-2261" d="M658 28L658 96L62 96L62 28M658 225L658 293L62 293L62 225M658 422L658 489L62 489L62 422Z"></path><path id="MJX-292-STX-I-1D450" d="M358 123C327 85 288 57 219 57C161 57 109 77 109 184C109 300 170 446 280 446C312 446 329 434 329 419C329 403 310 375 310 349C310 327 324 314 348 314C385 314 404 346 404 386C404 451 353 479 290 479C146 479 26 335 26 169C26 68 71-12 179-12C269-12 334 44 375 108Z"></path><path id="MJX-292-STX-I-1D461" d="M317 467L216 467L244 593L214 593C164 506 139 482 75 449L71 428L128 428L60 101C58 91 53 61 53 44C53 13 72-9 114-9C193-9 235 65 264 104L244 119C209 74 188 59 159 59C145 59 142 69 142 80C142 97 149 130 149 130L208 428L309 428Z"></path><path id="MJX-292-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-292-STX-N-2227" d="M604-30L322 549L312 549L32-30L105-30L317 412L531-30Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\begin{align}
e_1 \ctxrefines e_2 &amp; \defeq \forall C. C[e_1] \entails C[e_2] \\
e_1 \ctxequiv e_2 &amp; \defeq e_1 \ctxrefines e_2 \wedge e_2 \ctxrefines e_1
\end{align}
"><g data-mml-node="mtable" data-latex-item="{align}" data-latex="\preceq e_1 
\end{align}
"><g data-mml-node="mtr" transform="translate(0,691.2)"><g data-mml-node="mtd" transform="translate(1010,0)"><g data-mml-node="msub" data-latex="e_1"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-292-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex="\preceq" transform="translate(1134.8,0)"><use data-c="2AAF" xlink:href="#MJX-292-STX-N-2AAF"></use></g><g data-mml-node="msub" data-latex="e_2" transform="translate(2132.6,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-292-STX-N-32"></use></g></g></g><g data-mml-node="mtd" transform="translate(3999.6,0)"><g data-mml-node="mstyle"><g data-mml-node="mi"></g><g data-mml-node="mo" data-latex="\triangleq" transform="translate(277.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="958px" font-family="serif">≜</text></g><g data-mml-node="mi" data-latex="\forall" transform="translate(1155.6,0)"><use data-c="2200" xlink:href="#MJX-292-STX-N-2200"></use></g><g data-mml-node="mi" data-latex="C" transform="translate(1728.6,0)"><use data-c="1D436" xlink:href="#MJX-292-STX-I-1D436"></use></g><g data-mml-node="mo" data-latex="." transform="translate(2402.6,0)"><use data-c="2E" xlink:href="#MJX-292-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="C" transform="translate(2814.2,0)"><use data-c="1D436" xlink:href="#MJX-292-STX-I-1D436"></use></g><g data-mml-node="mo" data-latex="[" transform="translate(3488.2,0) translate(0 -20)"><use data-c="5B" xlink:href="#MJX-292-STX-N-5B"></use></g><g data-mml-node="msub" data-latex="e_1" transform="translate(3837.2,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-292-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex="]" transform="translate(4694.2,0) translate(0 -20)"><use data-c="5D" xlink:href="#MJX-292-STX-N-5D"></use></g><g data-mml-node="mo" data-latex="\sqsubseteq" transform="translate(5321,0)"><use data-c="2291" xlink:href="#MJX-292-STX-N-2291"></use></g><g data-mml-node="mi" data-latex="C" transform="translate(6318.8,0)"><use data-c="1D436" xlink:href="#MJX-292-STX-I-1D436"></use></g><g data-mml-node="mo" data-latex="[" transform="translate(6992.8,0) translate(0 -20)"><use data-c="5B" xlink:href="#MJX-292-STX-N-5B"></use></g><g data-mml-node="msub" data-latex="e_2" transform="translate(7341.8,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-292-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="]" transform="translate(8198.8,0) translate(0 -20)"><use data-c="5D" xlink:href="#MJX-292-STX-N-5D"></use></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-691.2)"><g data-mml-node="mtd"><g data-mml-node="msub" data-latex="e_1"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-292-STX-N-31"></use></g></g><g data-mml-node="msup" data-latex="\equiv^{c t x}" transform="translate(1134.8,0)"><g data-mml-node="mo" data-latex="\equiv"><use data-c="2261" xlink:href="#MJX-292-STX-N-2261"></use></g><g data-mml-node="TeXAtom" transform="translate(753,413) scale(0.707)" data-latex="{c t x}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="c"><use data-c="1D450" xlink:href="#MJX-292-STX-I-1D450"></use></g><g data-mml-node="mi" data-latex="t" transform="translate(414,0)"><use data-c="1D461" xlink:href="#MJX-292-STX-I-1D461"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(752,0)"><use data-c="1D465" xlink:href="#MJX-292-STX-I-1D465"></use></g></g></g><g data-mml-node="msub" data-latex="e_2" transform="translate(3142.6,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-292-STX-N-32"></use></g></g></g><g data-mml-node="mtd" transform="translate(3999.6,0)"><g data-mml-node="mstyle"><g data-mml-node="mi"></g><g data-mml-node="mo" data-latex="\triangleq" transform="translate(277.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="958px" font-family="serif">≜</text></g><g data-mml-node="msub" data-latex="e_1" transform="translate(1155.6,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-292-STX-N-31"></use></g></g><g data-mml-node="mo" data-latex="\preceq" transform="translate(2290.4,0)"><use data-c="2AAF" xlink:href="#MJX-292-STX-N-2AAF"></use></g><g data-mml-node="msub" data-latex="e_2" transform="translate(3288.1,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-292-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="\wedge" transform="translate(4367.4,0)"><use data-c="2227" xlink:href="#MJX-292-STX-N-2227"></use></g><g data-mml-node="msub" data-latex="e_2" transform="translate(5225.6,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="2"><use data-c="32" xlink:href="#MJX-292-STX-N-32"></use></g></g><g data-mml-node="mo" data-latex="\preceq" transform="translate(6360.4,0)"><use data-c="2AAF" xlink:href="#MJX-292-STX-N-2AAF"></use></g><g data-mml-node="msub" data-latex="e_1" transform="translate(7358.2,0)"><g data-mml-node="mi" data-latex="e"><use data-c="1D452" xlink:href="#MJX-292-STX-I-1D452"></use></g><g data-mml-node="mn" transform="translate(457,-150) scale(0.707)" data-latex="1"><use data-c="31" xlink:href="#MJX-292-STX-N-31"></use></g></g></g></g></g></g></g></g></svg></mjx-container></div><p>It seems <a href="https://www.google.com/search?q=%22contextual+equivalence%22+%22gold+standard%22">customary</a> to call it the &quot;gold standard&quot; for a notion of equivalence, so I will repeat that here.</p>
<p>Why does it solve the problem? Consider the statement again.</p>
<div style="display: flex; align-items: center;"><mjx-container class="MathJax" jax="SVG" overflow="overflow" display="true"><svg style="vertical-align: -0.459ex;" xmlns="http://www.w3.org/2000/svg" width="17.308ex" height="1.954ex" role="img" focusable="false" viewBox="0 -716 8290.6 936" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-293-STX-I-1D706" d="M376 558C376 637 373 705 301 705C238 705 195 665 163 609L184 594C210 618 233 628 266 628C308 628 328 589 328 522C328 491 328 490 327 469C224 330 94 156-9 16L-9 0L91 0C148 100 289 330 320 374L326 374C319 279 304 201 304 111C304 35 325-12 380-12C430-12 481 30 512 87L495 103C469 76 448 68 422 68C379 68 363 130 363 214C363 324 376 436 376 558Z"></path><path id="MJX-293-STX-I-1D465" d="M315 298L312 298L300 349C286 403 267 447 243 475L228 475L89 459L89 429C89 429 104 432 120 432C186 433 203 406 230 322L258 231L186 126C147 70 129 69 125 69C108 69 84 82 62 82C38 82 23 60 23 40C23 15 38-9 81-9C141-9 174 38 206 90L270 194L274 194L299 93C313 28 335-10 381-10C449-10 491 58 520 102L499 118C472 82 453 62 427 62C396 62 376 99 348 191L327 259L388 356C405 384 419 398 442 398C455 398 478 388 494 388C521 388 540 411 540 435C540 463 528 479 490 479C431 479 391 430 364 382Z"></path><path id="MJX-293-STX-N-2E" d="M183 50C183 84 161 114 122 114C85 114 62 85 62 51C62 17 81-8 121-8C161-8 183 19 183 50Z"></path><path id="MJX-293-STX-N-2261" d="M658 28L658 96L62 96L62 28M658 225L658 293L62 293L62 225M658 422L658 489L62 489L62 422Z"></path><path id="MJX-293-STX-N-28" d="M45 270C45 47 150-112 311-196L327-170C181-71 127 66 127 270C127 474 181 611 327 710L311 736C150 652 45 493 45 270Z"></path><path id="MJX-293-STX-I-1D466" d="M251 325C239 405 232 437 210 475L195 475L53 464L53 435C53 435 74 437 88 437C149 437 154 388 161 343L220-9C192-52 112-165 93-165C71-165 60-112 22-112C-1-112-17-125-17-155C-17-192 18-220 60-220C136-220 197-112 289 15C341 87 398 173 452 268C484 322 496 367 496 406C496 449 470 482 433 482C404 482 389 464 389 443C389 405 438 377 438 351C438 327 429 303 405 264L290 79L284 79L275 179Z"></path><path id="MJX-293-STX-N-29" d="M312 270C312 493 207 652 46 736L30 710C176 611 230 474 230 270C230 66 176-71 30-170L46-196C207-112 312 47 312 270Z"></path><path id="MJX-293-STX-N-A0" d=""></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\vlambda{x}{x} \equiv \vlambda{x}{\app{(\vlambda{y}{y})}{x}}
"><g data-mml-node="mi" data-latex="\lambda"><use data-c="1D706" xlink:href="#MJX-293-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(525,0)"><use data-c="1D465" xlink:href="#MJX-293-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(1084,0)"><use data-c="2E" xlink:href="#MJX-293-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(1495.7,0)"><use data-c="1D465" xlink:href="#MJX-293-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="\equiv" transform="translate(2332.4,0)"><use data-c="2261" xlink:href="#MJX-293-STX-N-2261"></use></g><g data-mml-node="mi" data-latex="\lambda" transform="translate(3330.2,0)"><use data-c="1D706" xlink:href="#MJX-293-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(3855.2,0)"><use data-c="1D465" xlink:href="#MJX-293-STX-I-1D465"></use></g><g data-mml-node="mo" data-latex="." transform="translate(4414.2,0)"><use data-c="2E" xlink:href="#MJX-293-STX-N-2E"></use></g><g data-mml-node="mo" data-latex="(" transform="translate(4825.9,0) translate(0 -20)"><use data-c="28" xlink:href="#MJX-293-STX-N-28"></use></g><g data-mml-node="mi" data-latex="\lambda" transform="translate(5182.9,0)"><use data-c="1D706" xlink:href="#MJX-293-STX-I-1D706"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(5707.9,0)"><use data-c="1D466" xlink:href="#MJX-293-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex="." transform="translate(6217.9,0)"><use data-c="2E" xlink:href="#MJX-293-STX-N-2E"></use></g><g data-mml-node="mi" data-latex="y" transform="translate(6629.6,0)"><use data-c="1D466" xlink:href="#MJX-293-STX-I-1D466"></use></g><g data-mml-node="mo" data-latex=")" transform="translate(7139.6,0) translate(0 -20)"><use data-c="29" xlink:href="#MJX-293-STX-N-29"></use></g><g data-mml-node="mtext" transform="translate(7496.6,0)"><use data-c="A0" xlink:href="#MJX-293-STX-N-A0"></use></g><g data-mml-node="mi" data-latex="x" transform="translate(7731.6,0)"><use data-c="1D465" xlink:href="#MJX-293-STX-I-1D465"></use></g></g></g></svg></mjx-container></div><p>We know that these expressions are equivalent informally because <em>no matter the argument we supply to each</em>, we'll get the same result. We might even have justified this to ourselves by mentally evaluating both sides with some symbolic value <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.019ex;" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.019ex" role="img" focusable="false" viewBox="0 -479 504 488" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-294-STX-I-1D463" d="M200 476L53 465L53 437C53 437 83 440 99 440C117 440 123 426 123 409C123 389 116 365 113 354L93 278C82 236 71 183 71 135C71 58 100-9 200-9C380-9 479 206 479 358C479 429 448 479 403 479C382 479 365 464 365 437C365 393 426 369 426 299C426 206 368 55 231 55C170 55 153 99 153 151C153 196 166 249 175 284L222 476Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="v"><g data-mml-node="mi" data-latex="v"><use data-c="1D463" xlink:href="#MJX-294-STX-I-1D463"></use></g></g></g></svg></mjx-container> and seeing that we get exactly <mjx-container class="MathJax" jax="SVG" overflow="overflow"><svg style="vertical-align: -0.019ex;" xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.019ex" role="img" focusable="false" viewBox="0 -479 504 488" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-295-STX-I-1D463" d="M200 476L53 465L53 437C53 437 83 440 99 440C117 440 123 426 123 409C123 389 116 365 113 354L93 278C82 236 71 183 71 135C71 58 100-9 200-9C380-9 479 206 479 358C479 429 448 479 403 479C382 479 365 464 365 437C365 393 426 369 426 299C426 206 368 55 231 55C170 55 153 99 153 151C153 196 166 249 175 284L222 476Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="v"><g data-mml-node="mi" data-latex="v"><use data-c="1D463" xlink:href="#MJX-295-STX-I-1D463"></use></g></g></g></svg></mjx-container> at the end.</p>
<p>In other words, if we only had some way to continue evaluating these expressions, we could easily tell that they were equivalent. The problem is that we can't do this, because they are already values - the big-step semantics has nothing more to say about them.</p>
<p>If only we had a way to describe hypothetical, future inputs to those programs...</p>
<p>Well, that's what contextual refinement offers. It quantifies over all contexts, so for all that don't get stuck and produce derivations, we are able to continue running these programs.
In other words, the context gives us a way to talk about how each lambda will eventually be used.</p>
<p>How would we actually prove this particular equivalence?
Direct induction over contexts is known to be <a href="https://dl.acm.org/doi/pdf/10.1145/3759427.3760374">&quot;notoriously difficult&quot;</a>.
The two tenable proof methods are
<a href="https://dl.acm.org/doi/pdf/10.1145/1889997.1890002">bisimulations</a> and <a href="https://cs.au.dk/~birke/papers/AnIntroductionToLogicalRelations.pdf">logical relations</a>.
I am more familiar with the latter, as it is much more commonly used in mechanised settings.</p>
<p>The idea there is to strengthen the definition of equivalence, so it more precisely says when two expressions are equivalent.
To cope with advanced language features, the definition will have to be inductive over the structure of types and/or the number of evaluation steps the program takes.</p>
<!-- A succinct set of slides describing the idea is [here](https://xavierleroy.org/CdF/2018-2019/8.pdf).
Amal Ahmed's [2015 OPLSS lectures](https://www.youtube.com/playlist?list=PLiHLLF-foEex7BOvMbrbUFC9XgU7fZW66) provide a great and more thorough introduction. -->
<p>It should also come as no surprise that the Proper instances we agonised over for so long are just simple corollaries of contextual equivalence.
Hence this relation can be used for rewriting.</p>
<!-- With that, we were finally able to formalise staged logic. -->
<p>With that, we seem to be finally able to formalise staged logic.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Discovering all this was a long and agonising journey, as the connections between these topics are typically discussed in very disparate settings.
I still don't know of any source which connects them like this, so I just wanted to put all this in words, so the next person who needs this connection not suffer a similar fate.</p>
<p>I'm grateful to the authors of a paper which pointed this out particularly clearly:
<a href="https://www.sciencedirect.com/science/article/pii/S2352220823000111">Program equivalence in an untyped, call-by-value functional language with uncurried functions</a>.
Moreover, it is for an untyped setting, which is a relatively interesting and unexplored one to apply logical relations in.</p>

</div>

		</main>

		<footer>
			
		</footer>

		<!-- This page `/drafts/entails-contextual-equivalence/` was built on 2025-10-29T09:40:23.873Z -->
		
	</body>
</html>
